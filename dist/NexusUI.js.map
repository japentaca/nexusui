{"version":3,"file":"NexusUI.js","sources":["../lib/util/math.js","../lib/util/svg.js","../lib/util/dom.js","../lib/util/util.js","../lib/util/touch.js","../lib/core/interface.js","../lib/models/step.js","../lib/models/toggle.js","../lib/util/interaction.js","../lib/interfaces/position.js","../lib/interfaces/slider.js","../lib/interfaces/toggle.js","../lib/components/buttontemplate.js","../lib/interfaces/button.js","../lib/interfaces/textbutton.js","../lib/interfaces/radiobutton.js","../lib/interfaces/number.js","../lib/interfaces/select.js","../lib/interfaces/dial.js","../lib/interfaces/piano.js","../lib/models/drunk.js","../lib/models/sequence.js","../lib/models/matrix.js","../lib/models/counter.js","../lib/time/interval.js","../lib/interfaces/sequencer.js","../lib/interfaces/pan2d.js","../lib/interfaces/tilt.js","../lib/interfaces/multislider.js","../lib/interfaces/pan.js","../lib/interfaces/envelope.js","../lib/interfaces/spectrogram.js","../lib/interfaces/meter.js","../lib/interfaces/oscilloscope.js","../lib/interfaces/index.js","../lib/util/transform.js","../lib/core/rack.js","../lib/tuning/tuning.js","../lib/models/radio.js","../lib/main.js"],"sourcesContent":["'use strict';\r\n\r\n/**\r\n * Limit a number to within a minimum and maximum\r\n * @param  {number} value Input value\r\n * @param  {number} min   Lower limit\r\n * @param  {number} max   Upper limit\r\n * @return {number}       The input value constrained within the lower and upper limits\r\n * @example\r\n * Nexus.clip(11,0,10)   // returns 10\r\n * Nexus.clip(-1,0,10)   // returns 0\r\n * Nexus.clip(5,0,10)    // returns 5\r\n */\r\n\r\nexport const clip = (value,min,max) => {\r\n  return Math.min(Math.max(value,min),max);\r\n};\r\n\r\nexport const normalize = (value,min,max) => {\r\n  return ( (value-min) / (max-min) );\r\n};\r\n\r\n/**\r\n * Scale a value from one range to another range.\r\n * @param  {number} inNum  Input value\r\n * @param  {number} inMin  Input range minimum\r\n * @param  {number} inMax  Input range maximum\r\n * @param  {number} outMin Output range minimum\r\n * @param  {number} outMax Output range maximum\r\n * @return {number}        The input value scaled to its new range\r\n * @example\r\n * Nexus.scale(0.5,0,1,0,10)   // returns 5\r\n * Nexus.scale(0.9,0,1,1,0)    // returns 0.1\r\n */\r\nexport const scale = (inNum, inMin, inMax, outMin, outMax) => {\r\n  if (inMin === inMax) {\r\n    return outMin;\r\n  }\r\n  return (((inNum - inMin) * (outMax - outMin)) / (inMax - inMin)) + outMin;\r\n};\r\n\r\nexport const toPolar = (x,y) => {\r\n  var r = Math.sqrt(x*x + y*y);\r\n\r\n  var theta = Math.atan2(y,x);\r\n  if (theta < 0) {\r\n    theta = theta + (2 * Math.PI);\r\n  }\r\n  return {radius: r, angle: theta};\r\n};\r\n\r\nexport const toCartesian = function(radius, angle){\r\n  var cos = Math.cos(angle);\r\n  var sin = Math.sin(angle);\r\n  return {x: radius*cos, y: radius*sin*-1};\r\n};\r\n/*\r\nexports.polarToCartesian(centerX, centerY, radius, angleInDegrees) {\r\n  var angleInRadians = (angleInDegrees-90) * Math.PI / 180.0;\r\n\r\n  return {\r\n    x: centerX + (radius * Math.cos(angleInRadians)),\r\n    y: centerY + (radius * Math.sin(angleInRadians))\r\n  };\r\n}  */\r\n\r\n\r\n\r\nexport const prune = function(data, scale) {\r\n  return parseFloat(data.toFixed(scale));\r\n};\r\n\r\nexport const invert = function (inNum) {\r\n  return scale(inNum, 1, 0, 0, 1);\r\n};\r\n\r\n/**\r\n * Convert a MIDi note number to a frequency value in equal temperament.\r\n * @param  {number} midi MIDI note value\r\n * @return {number}      Frequence value\r\n * @example\r\n * Nexus.mtof(60)  // returns the frequency number of Middle C\r\n */\r\nexport const mtof = function(midi) {\r\n  return Math.pow(2, ((midi-69)/12)) * 440;\r\n};\r\n\r\n/**\r\n * Interpolate between two numbers\r\n * @param  {number} loc Interpolation index (0-1)\r\n * @param  {number} min Lower value\r\n * @param  {number} max Upper value\r\n * @return {number}     Interpolated value\r\n * @example\r\n * Nexus.interp(0.5,2,4)   // returns 3\r\n * Nexus.interp(0.1,0,10)     // returns 1\r\n */\r\nexport const interp = function(loc,min,max) {\r\n  return loc * (max - min) + min;\r\n};\r\n\r\n/**\r\n * Return a random choice from a list of arguments\r\n * @return {various} One random argument\r\n * @example\r\n * Nexus.pick(1,2,3,4)   // returns 1, 2, 3, or 4\r\n * Nexus.pick(function1,function2)   // returns either function1 or function2\r\n */\r\nexport const pick = function() {\r\n  return arguments[~~(Math.random()*arguments.length)];\r\n};\r\n\r\n/**\r\n * Returns an octave multiplier for frequency values\r\n * @param  {number} num Relative octave number (e.g. -1 for one octave down, 1 for one octave up)\r\n * @return {number}     Octave multiplier\r\n * @example\r\n * Nexus.octave(-1)  // returns 0.5\r\n * Nexus.octave(0)   // returns 1\r\n * Nexus.octave(1)   // returns 2\r\n * Nexus.octave(2)   // returns 4\r\n */\r\nexport const octave = function(num) {\r\n  return Math.pow(2,num);\r\n};\r\n\r\n/**\r\n * Random integer generator. If no second argument is given, will return random integer from 0 to bound1.\r\n * @param  {number} bound1 Minimum random value\r\n * @param  {number} bound2 Maximum random value\r\n * @return {number}        Random integer between lower and upper boundary\r\n * @example\r\n * Nexus.ri(10)    // returns random int from 0 to 10\r\n * Nexus.ri(20,2000) // returns random int from 20 to 2000\r\n */\r\nexport const ri = function(bound1,bound2) {\r\n  if (!bound2) {\r\n    bound2 = bound1;\r\n    bound1 = 0;\r\n  }\r\n  var low = Math.min(bound1,bound2);\r\n  var high = Math.max(bound1,bound2);\r\n  return Math.floor(Math.random()*(high-low)+low);\r\n};\r\n\r\n/**\r\n * Random float number generator. If no second argument is given, will return random float from 0 to bound1.\r\n * @param  {number} bound1 Minimum random value\r\n * @param  {number} bound2 Maximum random value\r\n * @return {number}        Random float between lower and upper boundary\r\n * @example\r\n * Nexus.rf(1)    // returns random float from 0 to 1\r\n * Nexus.rf(1,2) // returns random float from 1 to 2\r\n */\r\nexport const rf = function(bound1,bound2) {\r\n  if (!bound2) {\r\n    bound2 = bound1;\r\n    bound1 = 0;\r\n  }\r\n  var low = Math.min(bound1,bound2);\r\n  var high = Math.max(bound1,bound2);\r\n  return Math.random()*(high-low)+low;\r\n};\r\n\r\n\r\nexport const cycle = function(input,min,max) {\r\n  input++;\r\n  if (input >= max) {\r\n    input = min;\r\n  }\r\n  return input;\r\n};\r\n\r\n/**\r\n * Average an array of numbers\r\n * @param  {Array} data Array of numbers to average\r\n * @return {number}      Average of the input data\r\n * @example\r\n * Nexus.average([0,2,4,6,8,10])   // returns 5\r\n */\r\nexport const average = function(data) {\r\n  let total = 0;\r\n  for (var i=0;i<data.length;i++) {\r\n    total += data[i];\r\n  }\r\n  return total / data.length;\r\n};\r\n\r\n/**\r\n * Get the distance from one (x,y) point to another (x,y) point\r\n * @param  {number} x1 x of first point\r\n * @param  {number} y1 y of first point\r\n * @param  {number} x2 x of second point\r\n * @param  {number} y2 y of second poiny\r\n * @return {number}    Distance\r\n * @example\r\n * Nexus.distance(0,0,3,4)   // returns 5\r\n */\r\nexport const distance = function(x1,y1,x2,y2) {\r\n  let a = x1 - x2;\r\n  let b = y1 - y2;\r\n  return Math.sqrt( a*a + b*b );\r\n};\r\n\r\nexport const gainToDB = function(gain) {\r\n  return 20 * Math.log10(gain);\r\n};\r\n\r\n/**\r\n * Flip a coin, returning either 0 or 1 according to a probability\r\n * @param  {number} [odds=0.5] Likelihood of returning 1\r\n * @return {number}            1 or 0\r\n * @example\r\n * Nexus.coin(0.1)   // returns 1 (10% of the time) or 0 (90% of the time)\r\n */\r\nexport const coin = function(odds=0.5) {\r\n  if (rf(0,1) < odds) {\r\n    return 1;\r\n  } else {\r\n    return 0;\r\n  }\r\n};\r\n\r\n// Export default para compatibilidad con import math from\r\nexport default {\r\n  clip,\r\n  normalize,\r\n  scale,\r\n  toPolar,\r\n  toCartesian,\r\n  prune,\r\n  invert,\r\n  mtof,\r\n  interp,\r\n  pick,\r\n  octave,\r\n  ri,\r\n  rf,\r\n  cycle,\r\n  average,\r\n  distance,\r\n  gainToDB,\r\n  coin\r\n};\r\n","'use strict';\r\n\r\nimport math from '../util/math.js';\r\n\r\nexport default {\r\n\r\n  create: (type) => {\r\n    return document.createElementNS('http://www.w3.org/2000/svg', type);\r\n  },\r\n\r\n  arc: (x, y, radius, startAngle, endAngle) => {\r\n\r\n    var start = math.toCartesian(radius, endAngle);\r\n    var end = math.toCartesian(radius, startAngle);\r\n\r\n    var largeArcFlag = endAngle - startAngle <= 180 ? '0' : '1';\r\n\r\n    var d = [\r\n        'M', start.x+x, start.y+y,\r\n        'A', radius, radius, 0, largeArcFlag, 0, end.x+x, end.y+y\r\n    ].join(' ');\r\n\r\n    return d;\r\n  },\r\n\r\n  radialGradient: (defs,numberOfStops) => {\r\n\r\n    let id = 'gradient' + math.ri(100000000000);\r\n    let stops = [];\r\n\r\n    let gradient = document.createElementNS('http://www.w3.org/2000/svg', 'radialGradient');\r\n    gradient.setAttribute('id', id);\r\n    gradient.setAttribute('cx', '50%');\r\n    gradient.setAttribute('cy', '50%');\r\n    gradient.setAttribute('r', '50%');\r\n\r\n    defs.appendChild(gradient);\r\n\r\n    for (let i=0;i<numberOfStops;i++) {\r\n      let stop = document.createElementNS('http://www.w3.org/2000/svg', 'stop');\r\n      stop.setAttribute('id', 'stop'+i);\r\n      //stop.setAttribute('offset', '70%');\r\n      //stop.setAttribute('stop-color', 'White');\r\n      gradient.appendChild(stop);\r\n      stops.push(stop);\r\n    }\r\n\r\n    return {\r\n      id: id,\r\n      stops: stops,\r\n      element: gradient\r\n    };\r\n\r\n  }\r\n\r\n};\r\n","'use strict';\r\n\r\nexport const findPosition = (el) => {\r\n  let viewportOffset = el.getBoundingClientRect();\r\n  let top = viewportOffset.top + window.scrollY;\r\n  let left = viewportOffset.left + window.scrollX;\r\n  return {top,left};\r\n};\r\n\r\nexport const parseElement = (parent) => {\r\n  if (typeof parent === 'string') {\r\n    parent = document.getElementById(parent.replace('#',''));\r\n  }\r\n\r\n  if (parent instanceof HTMLElement || parent instanceof SVGElement){\r\n    return parent;\r\n  } else {\r\n    return 'No valid parent argument';\r\n  }\r\n};\r\n\r\nexport const locateMouse = (e,offset) => {\r\n  return {\r\n    x: e.pageX - offset.left,\r\n    y: e.pageY - offset.top\r\n  };\r\n};\r\n\r\nexport const locateTouch = (e,offset) => {\r\n  return {\r\n    x: e.targetTouches.length ? e.targetTouches[0].pageX - offset.left : false,\r\n    y: e.targetTouches.length ? e.targetTouches[0].pageY - offset.top : false\r\n  };\r\n};\r\n\r\nexport const SmartCanvas = function(parent, fps) {\r\n\r\n  this.element = document.createElement('canvas');\r\n  this.context = this.element.getContext('2d');\r\n  this.scale = window.devicePixelRatio || 1;\r\n  this.lastRefreshTime = 0;  \r\n  parent.appendChild(this.element);\r\n\r\n  this.resize = (w,h) => {\r\n    this.element.width = w * this.scale;\r\n    this.element.height = h * this.scale;\r\n    this.element.style.width = w+'px';\r\n    this.element.style.height = h+'px';\r\n  };\r\n  \r\n  this.setFramerate = (newFramerate) => {\r\n\t  this.millisecondsPerFrame = newFramerate ? 1000/newFramerate : 0;\r\n  };\r\n  this.refreshIntervalReached = (currentTime) => {\r\n\t  if (!this.millisecondsPerFrame) {\r\n\t\t  return true;\r\n\t  } else if ((currentTime - this.lastRefreshTime) >= this.millisecondsPerFrame) {\r\n\t\t  this.lastRefreshTime = currentTime;\r\n\t\t  return true;\r\n\t  }\r\n  };\r\n  this.setFramerate(fps);\r\n\r\n};\r\n\r\n// Export default para compatibilidad con import dom from\r\nexport default {\r\n  findPosition,\r\n  parseElement,\r\n  locateMouse,\r\n  locateTouch,\r\n  SmartCanvas\r\n};\r\n","'use strict';\r\n\r\nexport const isObject = (obj) => {\r\n  if (typeof obj === 'object' && !Array.isArray(obj) && obj !== null && obj instanceof SVGElement === false && obj instanceof HTMLElement === false ) {\r\n    return true;\r\n  } else {\r\n    return false;\r\n  }\r\n};\r\n\r\n// Restricts input for the given textbox to the given inputFilter function\r\n// cf https://stackoverflow.com/a/469362\r\nexport const setInputFilter = (textbox, inputFilter) => {\r\n  [\"input\", \"keydown\", \"keyup\", \"mousedown\", \"mouseup\", \"select\", \"contextmenu\", \"drop\"].forEach(function(event) {\r\n    textbox.addEventListener(event, function() {\r\n      if (inputFilter(this.value)) {\r\n        this.oldValue = this.value;\r\n        this.oldSelectionStart = this.selectionStart;\r\n        this.oldSelectionEnd = this.selectionEnd;\r\n      } else if (this.hasOwnProperty(\"oldValue\")) {\r\n        this.value = this.oldValue;\r\n        this.setSelectionRange(this.oldSelectionStart, this.oldSelectionEnd);\r\n      } else {\r\n        this.value = \"\";\r\n      }\r\n    });\r\n  });\r\n};\r\n\r\n// Export default para compatibilidad\r\nexport default {\r\n  isObject,\r\n  setInputFilter\r\n};\r\n\r\n","'use strict';\r\n\r\nexport const exists = ('ontouchstart' in document.documentElement);\r\n\r\n// Export default para compatibilidad\r\nexport default {\r\n  exists\r\n};\r\n","'use strict';\r\n\r\nimport svg from '../util/svg.js';\r\nimport dom from '../util/dom.js';\r\nimport util from '../util/util.js';\r\nimport touch from '../util/touch.js';\r\n\r\n\r\nimport { colors } from '../main';\r\n\r\n/**\r\nInterface\r\n*/\r\nclass MiniEmitter {\r\n  constructor(){ this._events = new Map(); }\r\n  on(type, listener){\r\n    if (!this._events.has(type)) this._events.set(type, new Set());\r\n    this._events.get(type).add(listener);\r\n    return () => this.off(type, listener);\r\n  }\r\n  off(type, listener){\r\n    const set = this._events.get(type);\r\n    if (set) set.delete(listener);\r\n  }\r\n  emit(type, ...args){\r\n    const set = this._events.get(type);\r\n    if (set) for (const fn of set) try { fn(...args); } catch (e) { console.error(e); }\r\n  }\r\n  // Añadido para compatibilidad con el uso en destroy()\r\n  removeAllListeners(type){\r\n    if (typeof type === 'string') {\r\n      this._events.delete(type);\r\n    } else {\r\n      this._events.clear();\r\n    }\r\n  }\r\n  // Alias común en EventEmitter de Node\r\n  removeListener(type, listener){\r\n    this.off(type, listener);\r\n  }\r\n}\r\n\r\nexport default class Interface extends MiniEmitter {\r\n\r\n  constructor(args,options,defaults) {\r\n    super();\r\n    this.type = this.constructor.name;\r\n    this.settings = this.parseSettings(args,options,defaults);\r\n    this.mouse = {};\r\n    this.wait = false;\r\n    this.colors = {};\r\n    let defaultColors = colors(); // jshint ignore:line\r\n    this.colors.accent = defaultColors.accent;\r\n    this.colors.fill = defaultColors.fill;\r\n    this.colors.light = defaultColors.light;\r\n    this.colors.dark = defaultColors.dark;\r\n    this.colors.mediumLight = defaultColors.mediumLight;\r\n    this.colors.mediumDark = defaultColors.mediumDark;\r\n  }\r\n\r\n  parseSettings(args,options,defaults) {\r\n\r\n    options.unshift('target');\r\n    defaults.defaultSize = defaults.size.splice(0,2);\r\n    defaults.size = false;\r\n\r\n    let settings = {\r\n      'target': document.body,\r\n      'colors': {}, // should inherit from a colors module,\r\n      'snapWithParent': true,\r\n      'event': function() {},\r\n      'component': false\r\n    };\r\n\r\n    for (let key in defaults) {\r\n      settings[key] = defaults[key];\r\n    }\r\n\r\n    for (let i=0; i<args.length; i++) {\r\n      // grabs the next argument\r\n      let setting = args[i];\r\n      // if it's an object, it must be the settings object\r\n      if ( util.isObject(setting) ) {\r\n        for ( let key in setting ) {\r\n          settings[key] = setting[key];\r\n        }\r\n      // if it's a function, it must be the event setting\r\n      } else if (typeof setting === 'function') {\r\n        settings.event = setting;\r\n      // otherwise, consider it one of the widget's custom options\r\n      } else if (options.length>=1) {\r\n        // grab the first option -- i.e. 'target'\r\n        let key = options.splice(0,1)[0];\r\n        settings[key] = setting;\r\n      }\r\n    }\r\n\r\n    /*  handle common settings  */\r\n\r\n    // target\r\n    this.parent = dom.parseElement(settings.target);\r\n\r\n    // nexus-ui attribute\r\n    if (this.parent && this.parent instanceof HTMLElement && !settings.component) {\r\n      if (!this.parent.hasAttribute('nexus-ui')) {\r\n        this.parent.setAttribute('nexus-ui','');\r\n      }\r\n    }\r\n\r\n    // size\r\n\r\n    if (settings.size && Array.isArray(settings.size) && settings.snapWithParent) {\r\n      this.width = settings.size[0];\r\n      this.height = settings.size[1];\r\n      this.parent.style.width = this.width + 'px';\r\n      this.parent.style.height = this.height + 'px';\r\n    } else if (settings.snapWithParent && !settings.component) {\r\n\r\n      this.width = parseFloat(window.getComputedStyle(this.parent, null).getPropertyValue('width').replace('px',''));\r\n      this.height = parseFloat(window.getComputedStyle(this.parent, null).getPropertyValue('height').replace('px',''));\r\n\r\n      if (this.width==5000) {\r\n        this.width = settings.defaultSize[0];\r\n        this.parent.style.width = this.parent.width = this.width + 'px';\r\n      }\r\n      if (this.height==5000) {\r\n        this.height = settings.defaultSize[1];\r\n        this.parent.style.height = this.parent.height = this.height + 'px';\r\n      }\r\n\r\n    } else {\r\n      settings.size = settings.defaultSize;\r\n      this.width = settings.size[0];\r\n      this.height = settings.size[1];\r\n    }\r\n\r\n    // event\r\n    if (settings.event) {\r\n      this.event = this.on('change', settings.event);\r\n    } else {\r\n      this.event = false;\r\n    }\r\n\r\n    return settings;\r\n\r\n  }\r\n\r\n  init() {\r\n    this.buildFrame();\r\n    this.buildInterface();\r\n    this.sizeInterface();\r\n    this.attachListeners();\r\n    this.colorInterface();\r\n    this.finalTouches();\r\n  }\r\n\r\n  buildFrame() {\r\n    this.element = svg.create('svg');\r\n    this.element.setAttribute('width',this.width);\r\n    this.element.setAttribute('height',this.height);\r\n    this.parent.appendChild(this.element);\r\n  }\r\n\r\n  buildInterface() {}\r\n  sizeInterface() {}\r\n  colorInterface() {}\r\n\r\n  attachListeners() {\r\n\r\n    this.interactionTarget = this.interactionTarget || this.element;\r\n\r\n    // Setup interaction\r\n    if (touch.exists) {\r\n      this.interactionTarget.addEventListener('touchstart', evt => this.preTouch(evt));\r\n      this.interactionTarget.addEventListener('touchmove', evt => this.preTouchMove(evt));\r\n      this.interactionTarget.addEventListener('touchend', evt => this.preTouchRelease(evt));\r\n    }\r\n    this.boundPreMove = evt => this.preMove(evt);\r\n    this.boundPreRelease = evt => this.preRelease(evt);\r\n    this.interactionTarget.addEventListener('mousedown', evt => this.preClick(evt));\r\n  }\r\n\r\n  finalTouches() {\r\n    this.element.style.cursor = 'pointer';\r\n  }\r\n\r\n  preClick(e) {\r\n    // 10000 getComputedStyle calls takes 100 ms.\r\n    // .:. one takes about .01ms\r\n    if (this.element instanceof HTMLElement) {\r\n      this.width = window.getComputedStyle(this.element, null).getPropertyValue('width').replace('px','');\r\n    }\r\n    // 10000 getComputedStyle calls takes 40 ms.\r\n    // .:. one takes about .004ms\r\n    this.offset = dom.findPosition(this.element);\r\n    this.mouse = dom.locateMouse(e,this.offset);\r\n    this.clicked = true;\r\n    this.click();\r\n    this.moveEvent = document.addEventListener('mousemove', this.boundPreMove);\r\n    this.releaseEvent = document.addEventListener('mouseup', this.boundPreRelease);\r\n    this.emit('click');\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  }\r\n\r\n  preMove(e) {\r\n    if (!this.wait) {\r\n      this.mouse = dom.locateMouse(e,this.offset);\r\n      this.move();\r\n      this.wait = true;\r\n      setTimeout(() => { this.wait = false; },25);\r\n    }\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  }\r\n\r\n  preRelease(e) {\r\n    this.mouse = dom.locateMouse(e,this.offset);\r\n    this.clicked = false;\r\n    this.release();\r\n    this.emit('release');\r\n    document.removeEventListener('mousemove',this.boundPreMove);\r\n    document.removeEventListener('mouseup',this.boundPreRelease);\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  }\r\n\r\n  click() {\r\n\r\n  }\r\n\r\n  move() {\r\n\r\n  }\r\n\r\n  release() {\r\n\r\n  }\r\n\r\n\r\n  /* touch */\r\n\r\n  preTouch(e) {\r\n    if (this.element instanceof HTMLElement) {\r\n      this.width = window.getComputedStyle(this.element, null).getPropertyValue('width').replace('px','');\r\n    }\r\n    this.offset = dom.findPosition(this.element);\r\n    this.mouse = dom.locateTouch(e,this.offset);\r\n    this.clicked = true;\r\n    this.touch(e);\r\n    this.emit('click');\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  }\r\n\r\n  preTouchMove(e) {\r\n    if (this.clicked) {\r\n      this.mouse = dom.locateTouch(e,this.offset);\r\n      this.touchMove();\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    }\r\n  }\r\n\r\n  preTouchRelease(e) {\r\n    this.mouse = dom.locateTouch(e, this.offset);\r\n    this.clicked = false;\r\n    this.touchRelease();\r\n    this.emit('release');\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n  }\r\n\r\n  touch() {\r\n    this.click();\r\n  }\r\n\r\n  touchMove() {\r\n    this.move();\r\n  }\r\n\r\n  touchRelease() {\r\n    this.release();\r\n  }\r\n\r\n  /**\r\n  * Resize the interface\r\n  * @param width {number} New width in pixels\r\n  * @param height {number} New height in pixels\r\n  *\r\n  * @example\r\n  * button.resize(100,100);\r\n  */\r\n  resize(width,height) {\r\n    this.width = width;\r\n    this.height = height;\r\n    this.parent.style.width = this.width+'px';\r\n    this.parent.style.height = this.height+'px';\r\n    this.element.setAttribute('width',this.width);\r\n    this.element.setAttribute('height',this.height);\r\n    this.sizeInterface();\r\n  }\r\n\r\n  empty() {\r\n    while (this.element.lastChild) {\r\n      this.element.removeChild(this.element.lastChild);\r\n    }\r\n  }\r\n\r\n  /**\r\n  * Remove the interface from the page and cancel its event listener(s).\r\n  *\r\n  * @example\r\n  * button.destroy();\r\n  */\r\n  destroy() {\r\n    this.empty();\r\n    this.parent.removeChild(this.element);\r\n    this.removeAllListeners();\r\n    if (this.instrument) {\r\n      delete this.instrument[this.id];\r\n    }\r\n    this.customDestroy();\r\n  }\r\n\r\n  customDestroy() {\r\n\r\n  }\r\n\r\n  colorize(type,color) {\r\n    this.colors[type] = color;\r\n    this.colorInterface();\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport math from '../util/math.js';\r\n\r\n/**\r\n  Creates a steppable value with minimum, maximum, and step size. This is used in many interfaces to constrict their values to certain ranges.\r\n  @param {number} [min=0] minimum\r\n  @param {number} [max=1] maximum\r\n  @param {number} [step=0]\r\n  @param {number} [value=0] initial value\r\n  @returns {Object} Step\r\n*/\r\n\r\nexport default class Step {\r\n\r\n  constructor(min = 0,max = 1,step = 0,value = 0) {\r\n    //Object.assign(this,{min,max,step});\r\n    //Cannot use Object.assign because not supported in Safari.\r\n    //I would expect for Babel to take care of this but it is not.\r\n    this.min = min;\r\n    this.max = max;\r\n    this.step = step;\r\n    this.value = value;\r\n    this.changed = false;\r\n    this.oldValue = false;\r\n    this.update(this.value);\r\n  }\r\n\r\n  /**\r\n    Update with a new value. The value will be auto-adjusted to fit the min/max/step.\r\n    @param {number} value\r\n  */\r\n\r\n  update(value) {\r\n    if (this.step) {\r\n      // this.value = math.clip(Math.round(value / (this.step)) * this.step, this.min,this.max);\r\n      this.value = math.clip(Math.round((value-this.min) / (this.step)) * this.step + this.min, this.min,this.max);\r\n    } else {\r\n      this.value = math.clip(value,this.min,this.max);\r\n    }\r\n    if (this.oldValue !== this.value) {\r\n      this.oldValue = this.value;\r\n      this.changed = true;\r\n    } else {\r\n      this.changed = false;\r\n    }\r\n    return this.value;\r\n  }\r\n\r\n  /**\r\n    Update with a normalized value 0-1.\r\n    @param {number} value\r\n  */\r\n  updateNormal(value) {\r\n    this.value = math.scale(value,0,1,this.min,this.max);\r\n    return this.update(this.value);\r\n  }\r\n\r\n  /**\r\n    Get a normalized version of this.value . Not settable.\r\n  */\r\n  get normalized() {\r\n    return math.normalize(this.value,this.min,this.max);\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nexport default class Toggle {\r\n\r\n  constructor(state) {\r\n    this.state = state || false;\r\n  }\r\n\r\n  flip(state) {\r\n    if (state || state === false) {\r\n      this.state = state;\r\n    } else {\r\n      this.state = !this.state;\r\n    }\r\n  }\r\n\r\n  on() {\r\n    this.state = true;\r\n  }\r\n\r\n  off() {\r\n    this.state = false;\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport math from '../util/math';\r\nimport ToggleModel from '../models/toggle';\r\n\r\n\r\n/*\r\nhow to use :\r\n\r\ndial.interaction = new Handle('radial','relative',this.width,this.height);\r\n// dial.interaction.mode = 'relative'\r\n// dial.interaction.direction = 'radial'\r\n\r\non click:\r\ndial.interaction.anchor = this.mouse;\r\n\r\non move:\r\ndial.interaction.update(this.mouse);\r\n\r\nconsole.log( dial.interaction.value ); should be a normalized value.\r\n\r\n*/\r\n\r\n/*\r\n  absolute/relative are property: mode\r\n  radial/vertical/horizontal/2d are property: direction\r\n\r\n  plan :\r\n\r\n  if relative --\r\n  NO on click, get value offset between current value and click value.\r\n  NO on move, use click value - offset\r\n  INSTEAD\r\n  use delta -- bc vertical motion on dial is impossible otherwise\r\n  also allow to set sensitivity\r\n\r\n*/\r\n\r\nexport class Handle {\r\n\r\n  constructor(mode='absolute',direction='vertical',xbound=[0,100],ybound=[0,100]) {\r\n    this.mode = mode;\r\n    this.direction = direction;\r\n    this.previous = 0;\r\n    this.value = 0;\r\n    this.sensitivity = 1;\r\n    this.resize(xbound,ybound);\r\n  }\r\n\r\n  resize(xbound,ybound) {\r\n    this.boundary = {\r\n      min: {\r\n        x: xbound[0],\r\n        y: ybound[0]\r\n      },\r\n      max: {\r\n        x: xbound[1],\r\n        y: ybound[1]\r\n      },\r\n      center: {\r\n        x: (xbound[1] - xbound[0])/2 + xbound[0],\r\n        y: (ybound[1] - ybound[0])/2 + ybound[0]\r\n      }\r\n    };\r\n  }\r\n\r\n  set anchor(mouse) {\r\n    this._anchor = this.convertPositionToValue(mouse);\r\n  }\r\n\r\n  get anchor() {\r\n    return this._anchor;\r\n  }\r\n\r\n\r\n  update(mouse) {\r\n    if (this.mode==='relative') {\r\n\t  let rawIncrement = this.convertPositionToValue(mouse) - this.anchor;\r\n\t  let interpretedIncrement = ((Math.abs(rawIncrement) > 0.5) && (this.direction === \"radial\")) ? 0 : rawIncrement * this.sensitivity;\r\n\t  this.anchor = mouse;\r\n\t  this.value = this.value + interpretedIncrement;      \r\n    } else {\r\n      this.value = this.convertPositionToValue(mouse);\r\n    }\r\n    this.value = math.clip(this.value,0,1);\r\n  }\r\n\r\n  convertPositionToValue(current) {\r\n    switch(this.direction) {\r\n      case 'radial':\r\n        let position = math.toPolar(current.x - this.boundary.center.x, current.y - this.boundary.center.y);\r\n        position = position.angle / (Math.PI*2);\r\n        position = ((position - 0.25) + 1) % 1;\r\n        return position;\r\n      case 'vertical':\r\n        return math.scale(current.y,this.boundary.min.y,this.boundary.max.y,0,1);\r\n      case 'horizontal':\r\n        return math.scale(current.x,this.boundary.min.x,this.boundary.max.x,0,1);\r\n    }\r\n  }\r\n\r\n}\r\n\r\n\r\nexport class Button {\r\n\r\n  constructor(mode='button') {\r\n    this.mode = mode;\r\n    this.state = new ToggleModel();\r\n    this.paintbrush = false;\r\n  }\r\n\r\n  click() {\r\n    switch (this.mode) {\r\n      case 'impulse':\r\n        this.state.on();\r\n        if (this.timeout) {\r\n          clearTimeout(this.timeout);\r\n        }\r\n        this.timeout = setTimeout(this.state.off.bind(this),30);\r\n        this.emit('change',this.state);\r\n        break;\r\n      case 'button':\r\n        this.turnOn();\r\n        this.emit('change',this.state);\r\n        break;\r\n      case 'aftertouch':\r\n        this.position = {\r\n          x: math.clip(this.mouse.x / this.width,0,1),\r\n          y: math.clip(1 - this.mouse.y / this.height,0,1)\r\n        };\r\n        this.turnOn();\r\n        this.emit('change',{\r\n          state: this.state,\r\n          x: this.position.x,\r\n          y: this.position.y,\r\n        });\r\n        break;\r\n      case 'toggle':\r\n        this.flip();\r\n        this.emit('change',this.state);\r\n        break;\r\n    }\r\n\r\n  }\r\n\r\n  move() {\r\n    if (this.mode==='aftertouch') {\r\n      this.position = {\r\n        x: math.clip(this.mouse.x / this.width,0,1),\r\n        y: math.clip(1 - this.mouse.y / this.height,0,1)\r\n      };\r\n      this.emit('change',{\r\n        state: this.state,\r\n        x: this.position.x,\r\n        y: this.position.y,\r\n      });\r\n      this.render();\r\n    }\r\n  }\r\n\r\n  release() {\r\n    switch (this.mode) {\r\n      case 'button':\r\n        this.turnOff();\r\n        this.emit('change',this.state);\r\n        break;\r\n      case 'aftertouch':\r\n        this.turnOff();\r\n        this.position = {\r\n          x: this.mouse.x / this.width,\r\n          y: 1 - this.mouse.y / this.height\r\n        };\r\n        this.emit('change',{\r\n          state: this.state,\r\n          x: this.position.x,\r\n          y: this.position.y,\r\n        });\r\n        break;\r\n    }\r\n  }\r\n}\r\n","\r\n'use strict';\r\n\r\nimport svg from '../util/svg.js';\r\nimport Interface from '../core/interface.js';\r\nimport Step from '../models/step.js';\r\nimport * as Interaction from '../util/interaction';\r\n\r\n/**\r\n* Position\r\n*\r\n* @description Two-dimensional touch slider.\r\n*\r\n* @demo <span nexus-ui=\"position\"></span>\r\n*\r\n* @example\r\n* var position = new Nexus.Position('#target')\r\n*\r\n* @example\r\n* var position = new Nexus.Position('#target',{\r\n*   'size': [200,200],\r\n*   'mode': 'absolute',  // \"absolute\" or \"relative\"\r\n*   'x': 0.5,  // initial x value\r\n*   'minX': 0,\r\n*   'maxX': 1,\r\n*   'stepX': 0,\r\n*   'y': 0.5,  // initial y value\r\n*   'minY': 0,\r\n*   'maxY': 1,\r\n*   'stepY': 0\r\n* })\r\n*\r\n* @output\r\n* change\r\n* Fires any time the interface's value changes. <br>\r\n* The event data is an object with x and y properties containing the x and y values of the interface.\r\n*\r\n* @outputexample\r\n* position.on('change',function(v) {\r\n*   console.log(v);\r\n* })\r\n*\r\n*\r\n*/\r\n\r\nexport default class Position extends Interface {\r\n\r\n  constructor() {\r\n\r\n    let options = ['value'];\r\n\r\n    let defaults = {\r\n      'size': [200,200],\r\n      'mode': 'absolute',\r\n      'minX': 0,\r\n      'maxX': 1,\r\n      'stepX': 0,\r\n      'x': 0.5,\r\n      'minY': 0,\r\n      'maxY': 1,\r\n      'stepY': 0,\r\n      'y': 0.5\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n\r\n    this._x = new Step( this.settings.minX, this.settings.maxX, this.settings.stepX, this.settings.x );\r\n    this._y = new Step( this.settings.minY, this.settings.maxY, this.settings.stepY, this.settings.y );\r\n\r\n    this.position = {\r\n      x: new Interaction.Handle(this.settings.mode,'horizontal',[0,this.width],[this.height,0]),\r\n      y: new Interaction.Handle(this.settings.mode,'vertical',[0,this.width],[this.height,0])\r\n    };\r\n    this.position.x.value = this._x.normalized;\r\n    this.position.y.value = this._y.normalized;\r\n\r\n    this.init();\r\n    this.render();\r\n\r\n  }\r\n\r\n  buildInterface() {\r\n\r\n    this.knob = svg.create('circle');\r\n    this.element.appendChild(this.knob);\r\n    \r\n  }\r\n\r\n  sizeInterface() {\r\n\r\n      this.position.x.resize([0,this.width],[this.height,0]);\r\n      this.position.y.resize([0,this.width],[this.height,0]);\r\n\r\n      this._minDimension = Math.min(this.width,this.height);\r\n\r\n      this.knobRadius = {\r\n        off: ~~(this._minDimension/100) * 5 + 5,\r\n      };\r\n      this.knobRadius.on = this.knobRadius.off * 2;\r\n\r\n      this.knob.setAttribute('cx',this.width/2);\r\n      this.knob.setAttribute('cy',this.height/2);\r\n      this.knob.setAttribute('r',this.knobRadius.off);\r\n  }\r\n\r\n  colorInterface() {\r\n      this.element.style.backgroundColor = this.colors.fill;\r\n      this.knob.setAttribute('fill', this.colors.accent);\r\n  }\r\n\r\n  render() {\r\n    if (this.clicked) {\r\n    //  this.knobRadius = 30;\r\n      this.knob.setAttribute('r',this.knobRadius.on);\r\n    } else {\r\n    //  this.knobRadius = 15;\r\n      this.knob.setAttribute('r',this.knobRadius.off);\r\n    }\r\n\r\n    this.knobCoordinates = {\r\n      x: this._x.normalized * this.width,\r\n      y: this.height - this._y.normalized * this.height\r\n    };\r\n\r\n    this.knob.setAttribute('cx',this.knobCoordinates.x);\r\n    this.knob.setAttribute('cy',this.knobCoordinates.y);\r\n  }\r\n\r\n\r\n  click() {\r\n    this.position.x.anchor = this.mouse;\r\n    this.position.y.anchor = this.mouse;\r\n    this.move();\r\n  }\r\n\r\n  move() {\r\n    if (this.clicked) {\r\n      this.position.x.update(this.mouse);\r\n      this.position.y.update(this.mouse);\r\n      this._x.updateNormal( this.position.x.value );\r\n      this._y.updateNormal( this.position.y.value );\r\n      this.emit('change',{\r\n        x: this._x.value,\r\n        y: this._y.value\r\n      });\r\n      this.render();\r\n    }\r\n  }\r\n\r\n  release() {\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  * The interface's x value. When set, it will automatically adjust to fit min/max/step settings of the interface.\r\n  * @type {object}\r\n  * @example position.x = 0.5;\r\n  */\r\n\r\n  get x() {\r\n    return this._x.value;\r\n  }\r\n\r\n  set x(value) {\r\n    this._x.update(value);\r\n    this.emit('change',{\r\n      x: this._x.value,\r\n      y: this._y.value\r\n    });\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  * The interface's y values. When set, it will automatically adjust to fit min/max/step settings of the interface.\r\n  * @type {object}\r\n  * @example position.x = 0.5;\r\n  */\r\n\r\n  get y() {\r\n    return this._y.value;\r\n  }\r\n\r\n  set y(value) {\r\n    this._y.update(value);\r\n    this.emit('change',{\r\n      x: this._x.value,\r\n      y: this._y.value\r\n    });\r\n    this.render();\r\n  }\r\n\r\n\r\n\r\n  get normalized() {\r\n    return {\r\n      x: this._x.normalized,\r\n      y: this._y.normalized\r\n    };\r\n  }\r\n\r\n  /**\r\n  * The lower limit of value on the x axis\r\n  * @type {object}\r\n  */\r\n  get minX() {\r\n    return this._x.min;\r\n  }\r\n\r\n  set minX(v) {\r\n    this._x.min = v;\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  * The lower limit of value on the y axis\r\n  * @type {object}\r\n  */\r\n  get minY() {\r\n    return this._y.min;\r\n  }\r\n\r\n  set minY(v) {\r\n    this._y.min = v;\r\n    this.render();\r\n  }\r\n\r\n\r\n  /**\r\n  * The upper limit of value on the x axis\r\n  * @type {object}\r\n  */\r\n  get maxX() {\r\n    return this._x.max;\r\n  }\r\n\r\n  set maxX(v) {\r\n    this._x.max = v;\r\n    this.render();\r\n  }\r\n\r\n\r\n  /**\r\n  * The upper limit of value on the y axis\r\n  * @type {object}\r\n  */\r\n  get maxY() {\r\n    return this._y.max;\r\n  }\r\n\r\n  set maxY(v) {\r\n    this._y.max = v;\r\n    this.render();\r\n  }\r\n\r\n\r\n  /**\r\n  * The incremental step of values on the x axis\r\n  * @type {object}\r\n  */\r\n  get stepX() {\r\n    return this._x.step;\r\n  }\r\n\r\n  set stepX(v) {\r\n    this._x.step = v;\r\n    this.render();\r\n  }\r\n\r\n\r\n  /**\r\n  * The incremental step of values on the y axis\r\n  * @type {object}\r\n  */\r\n  get stepY() {\r\n    return this._y.step;\r\n  }\r\n\r\n  set stepY(v) {\r\n    this._y.step = v;\r\n    this.render();\r\n  }\r\n\r\n\r\n  /**\r\n  Absolute mode (position's value jumps to mouse click position) or relative mode (mouse drag changes value relative to its current position). Default: \"absolute\".\r\n  @type {string}\r\n  @example position.mode = \"relative\";\r\n  */\r\n  get mode() {\r\n    return this.position.x.mode;\r\n  }\r\n  set mode(v) {\r\n    this.position.x.mode = v;\r\n    this.position.y.mode = v;\r\n  }\r\n\r\n\r\n\r\n\r\n}\r\n","'use strict';\r\n\r\nimport svg from '../util/svg.js';\r\nimport Interface from '../core/interface.js';\r\nimport Step from '../models/step.js';\r\nimport * as Interaction from '../util/interaction';\r\n\r\n/**\r\n* Slider\r\n*\r\n* @description Horizontal or vertical slider with settable interaction modes.\r\n*\r\n* @demo <span nexus-ui=\"slider\" step=0.2></span>\r\n*\r\n* @example\r\n* var slider = new Nexus.Slider('#target')\r\n*\r\n* @example\r\n* var slider = new Nexus.Slider('#target',{\r\n*     'size': [120,20],\r\n*     'mode': 'relative',  // 'relative' or 'absolute'\r\n*     'min': 0,\r\n*     'max': 1,\r\n*     'step': 0,\r\n*     'value': 0\r\n* })\r\n*\r\n* @output\r\n* change\r\n* Fires when the interface's value changes. <br>\r\n* Event data: <i>number</i> The number value of the interface.\r\n*\r\n* @outputexample\r\n* slider.on('change',function(v) {\r\n*   console.log(v);\r\n* })\r\n*\r\n*\r\n*/\r\n\r\nexport default class Slider extends Interface {\r\n\r\n  constructor() {\r\n\r\n    let options = ['min','max','value'];\r\n\r\n    let defaults = {\r\n      'size': [120,20],\r\n      'mode': 'relative',  // 'relative' or 'absolute'\r\n      'min': 0,\r\n      'max': 1,\r\n      'step': 0,\r\n      'value': 0\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n    this.orientation = 'vertical'; // This will change automatically to 'horizontal'if the interface is wider than it is tall.\r\n\r\n    this._value = new Step(this.settings.min, this.settings.max, this.settings.step, this.settings.value);\r\n\r\n    this.position = new Interaction.Handle(this.settings.mode,this.orientation,[0,this.width],[this.height,0]);\r\n    this.position.value = this._value.normalized;\r\n\r\n    this.init();\r\n\r\n    this.position.direction = this.orientation;\r\n\r\n    this.emit('change',this.value);\r\n\r\n  }\r\n\r\n  buildInterface() {\r\n\r\n    this.bar = svg.create('rect');\r\n    this.fillbar = svg.create('rect');\r\n    this.knob = svg.create('circle');\r\n\r\n    this.element.appendChild(this.bar);\r\n    this.element.appendChild(this.fillbar);\r\n    this.element.appendChild(this.knob);\r\n\r\n  }\r\n\r\n  sizeInterface() {\r\n\r\n    if (this.width < this.height) {\r\n      this.orientation = 'vertical';\r\n      this.position.direction = 'vertical';\r\n    } else {\r\n      this.orientation = 'horizontal';\r\n      this.position.direction = 'horizontal';\r\n    }\r\n\r\n    if (this.position) {\r\n      this.position.resize([0,this.width],[this.height,0]);\r\n    }\r\n\r\n    let x, y, w, h, barOffset, cornerRadius;\r\n    this.knobData = {\r\n      level: 0,\r\n      r: 0\r\n    };\r\n\r\n    if (this.orientation === 'vertical') {\r\n      this.thickness = this.width / 2;\r\n    \tx = this.width/2;\r\n    \ty = 0;\r\n    \tw = this.thickness;\r\n    \th = this.height;\r\n      this.knobData.r = this.thickness * 0.8;\r\n    \tthis.knobData.level = h-this.knobData.r-this.normalized*(h-this.knobData.r*2);\r\n      barOffset = 'translate('+this.thickness*(-1)/2+',0)';\r\n      cornerRadius = w/2;\r\n    } else {\r\n      this.thickness = this.height / 2;\r\n    \tx = 0;\r\n    \ty = this.height/2;\r\n    \tw = this.width;\r\n    \th = this.thickness;\r\n      this.knobData.r = this.thickness * 0.8;\r\n    \tthis.knobData.level = this.normalized*(w-this.knobData.r*2)+this.knobData.r;\r\n      barOffset = 'translate(0,'+this.thickness*(-1)/2+')';\r\n      cornerRadius = h/2;\r\n    }\r\n\r\n    this.bar.setAttribute('x',x);\r\n    this.bar.setAttribute('y',y);\r\n    this.bar.setAttribute('transform',barOffset);\r\n    this.bar.setAttribute('rx',cornerRadius); // corner radius\r\n    this.bar.setAttribute('ry',cornerRadius);\r\n    this.bar.setAttribute('width',w);\r\n    this.bar.setAttribute('height',h);\r\n\r\n    if (this.orientation === 'vertical') {\r\n      this.fillbar.setAttribute('x',x);\r\n      this.fillbar.setAttribute('y',this.knobData.level);\r\n      this.fillbar.setAttribute('width',w);\r\n      this.fillbar.setAttribute('height',h-this.knobData.level);\r\n    } else {\r\n      this.fillbar.setAttribute('x',0);\r\n      this.fillbar.setAttribute('y',y);\r\n      this.fillbar.setAttribute('width',this.knobData.level);\r\n      this.fillbar.setAttribute('height',h);\r\n    }\r\n    this.fillbar.setAttribute('transform',barOffset);\r\n    this.fillbar.setAttribute('rx',cornerRadius);\r\n    this.fillbar.setAttribute('ry',cornerRadius);\r\n\r\n    if (this.orientation === 'vertical') {\r\n      this.knob.setAttribute('cx',x);\r\n      this.knob.setAttribute('cy',this.knobData.level);\r\n    } else {\r\n      this.knob.setAttribute('cx',this.knobData.level);\r\n      this.knob.setAttribute('cy',y);\r\n    }\r\n    this.knob.setAttribute('r',this.knobData.r);\r\n\r\n  }\r\n\r\n  colorInterface() {\r\n    this.bar.setAttribute('fill', this.colors.fill);\r\n    this.fillbar.setAttribute('fill', this.colors.accent);\r\n    this.knob.setAttribute('fill', this.colors.accent);\r\n  }\r\n\r\n\r\n  render() {\r\n    if (!this.clicked) {\r\n      this.knobData.r = this.thickness*0.75;\r\n    }\r\n    this.knob.setAttribute('r',this.knobData.r);\r\n\r\n    if (this.orientation === 'vertical') {\r\n  \t   this.knobData.level = this.knobData.r+this._value.normalized*(this.height-this.knobData.r*2);\r\n       this.knob.setAttribute('cy',this.height - this.knobData.level);\r\n       this.fillbar.setAttribute('y',this.height - this.knobData.level);\r\n       this.fillbar.setAttribute('height',this.knobData.level);\r\n    } else {\r\n  \t   this.knobData.level = this._value.normalized*(this.width-this.knobData.r*2)+this.knobData.r;\r\n       this.knob.setAttribute('cx',this.knobData.level);\r\n       this.fillbar.setAttribute('x',0);\r\n       this.fillbar.setAttribute('width',this.knobData.level);\r\n    }\r\n  }\r\n\r\n\r\n  click() {\r\n    this.knobData.r = this.thickness*0.9;\r\n    this.position.anchor = this.mouse;\r\n    this.move();\r\n  }\r\n\r\n  move() {\r\n    if (this.clicked) {\r\n      this.position.update(this.mouse);\r\n      this._value.updateNormal( this.position.value );\r\n      this.emit('change',this._value.value);\r\n      this.render();\r\n\r\n    }\r\n  }\r\n\r\n  release() {\r\n    this.render();\r\n  }\r\n\r\n  get normalized() {\r\n    return this._value.normalized;\r\n  }\r\n\r\n  /**\r\n  The slider's current value. If set manually, will update the interface and trigger the output event.\r\n  @type {number}\r\n  @example slider.value = 10;\r\n  */\r\n  get value() {\r\n    return this._value.value;\r\n  }\r\n  set value(v) {\r\n    this._value.update(v);\r\n    this.position.value = this._value.normalized;\r\n    this.emit('change',this._value.value);\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  Lower limit of the sliders's output range\r\n  @type {number}\r\n  @example slider.min = 1000;\r\n  */\r\n  get min() {\r\n    return this._value.min;\r\n  }\r\n  set min(v) {\r\n    this._value.min = v;\r\n  }\r\n\r\n  /**\r\n  Upper limit of the slider's output range\r\n  @type {number}\r\n  @example slider.max = 1000;\r\n  */\r\n  get max() {\r\n    return this._value.max;\r\n  }\r\n  set max(v) {\r\n    this._value.max = v;\r\n  }\r\n\r\n  /**\r\n  The increment that the slider's value changes by.\r\n  @type {number}\r\n  @example slider.step = 5;\r\n  */\r\n  get step() {\r\n    return this._value.step;\r\n  }\r\n  set step(v) {\r\n    this._value.step = v;\r\n  }\r\n\r\n  /**\r\n  Absolute mode (slider's value jumps to mouse click position) or relative mode (mouse drag changes value relative to its current position). Default: \"relative\".\r\n  @type {string}\r\n  @example slider.mode = \"relative\";\r\n  */\r\n  get mode() {\r\n    return this.position.mode;\r\n  }\r\n  set mode(v) {\r\n    this.position.mode = v;\r\n  }\r\n\r\n\r\n\r\n}\r\n","'use strict';\r\n\r\nimport svg from '../util/svg.js';\r\nimport ToggleModel from '../models/toggle.js';\r\nimport Interface from '../core/interface.js';\r\n\r\n/**\r\n* Toggle\r\n*\r\n* @description Binary switch\r\n*\r\n* @demo <span nexus-ui=\"toggle\"></span>\r\n*\r\n* @example\r\n* var toggle = new Nexus.Toggle('#target')\r\n*\r\n* @example\r\n* var toggle = new Nexus.Toggle('#target',{\r\n*     'size': [40,20],\r\n*     'state': false\r\n* })\r\n*\r\n* @output\r\n* change\r\n* Fires any time the interface's value changes. <br>\r\n* Parameter: The boolean state of the interface.\r\n*\r\n* @outputexample\r\n* toggle.on('change',function(v) {\r\n*   console.log(v);\r\n* })\r\n*\r\n*\r\n*/\r\nexport default class Toggle extends Interface {\r\n\r\n  constructor() {\r\n\r\n    let options = ['value'];\r\n\r\n    let defaults = {\r\n      'size': [40,20],\r\n      'target': false,\r\n      'state': false\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n    this._state = new ToggleModel(this.settings.state);\r\n\r\n    this.init();\r\n\r\n  }\r\n\r\n  buildInterface() {\r\n\r\n    this.bar = svg.create('rect');\r\n    this.knob = svg.create('circle');\r\n    this.element.appendChild(this.bar);\r\n    this.element.appendChild(this.knob);\r\n\r\n  }\r\n\r\n  sizeInterface() {\r\n\r\n    if (this.height < this.width/2) {\r\n      this.knobSize = this.height/2;\r\n    } else {\r\n      this.knobSize = this.width/4;\r\n    }\r\n\r\n    this.bar.setAttribute('x',this.width/2 - this.knobSize*1.5);\r\n    this.bar.setAttribute('y',this.height/2 - this.knobSize/2);\r\n    this.bar.setAttribute('rx',this.knobSize/2);\r\n    this.bar.setAttribute('ry',this.knobSize/2);\r\n    this.bar.setAttribute('width',this.knobSize*3);\r\n    this.bar.setAttribute('height',this.knobSize);\r\n\r\n    this.knob.setAttribute('cx',this.width/2 - this.knobSize);\r\n    this.knob.setAttribute('cy',this.height/2);\r\n    this.knob.setAttribute('r',this.knobSize);\r\n\r\n  }\r\n\r\n  colorInterface() {\r\n    this.knob.setAttribute('fill', this.colors.accent);\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    if (!this.state) {\r\n      this.knob.setAttribute('cx',this.width/2 - this.knobSize);\r\n      this.bar.setAttribute('fill', this.colors.fill);\r\n    } else {\r\n      this.knob.setAttribute('cx',this.width/2 + this.knobSize);\r\n      this.bar.setAttribute('fill', this.colors.accent);\r\n    }\r\n  }\r\n\r\n  click() {\r\n    this.flip();\r\n    this.render();\r\n    this.emit('change',this.state);\r\n  }\r\n\r\n  /**\r\n  Whether the toggle is currently on or off. Setting this property will update the toggle interface and trigger the output event.\r\n  @type {boolean}\r\n  @example toggle.state = false;\r\n  */\r\n  get state() {\r\n    return this._state.state;\r\n  }\r\n  set state(value) {\r\n    this._state.flip(value);\r\n    this.emit('change',this.state);\r\n    this.render();\r\n  }\r\n\r\n\r\n  /**\r\n  * Switch the toggle state to its opposite state\r\n  * @example\r\n  * toggle.flip();\r\n  */\r\n  flip() {\r\n    this._state.flip();\r\n    this.render();\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport svg from '../util/svg.js';\r\nimport math from '../util/math.js';\r\nimport ToggleModel from '../models/toggle.js';\r\nimport Interface from '../core/interface.js';\r\n\r\n/**\r\nButton Template\r\n*/\r\n\r\nexport default class ButtonTemplate extends Interface {\r\n\r\n  constructor(args,options,defaults) {\r\n\r\n    super(args,options,defaults);\r\n\r\n    this.mode = this.settings.mode || 'button';\r\n\r\n    this.position = {\r\n      x: 0,\r\n      y: 0\r\n    };\r\n\r\n    this._state = new ToggleModel(this.settings.state);\r\n\r\n  }\r\n\r\n  buildInterface() {\r\n    this.pad = svg.create('circle');\r\n    this.pad.setAttribute('fill', '#d18');\r\n    this.pad.setAttribute('stroke', '#d18');\r\n    this.pad.setAttribute('stroke-width', 4);\r\n\r\n    this.element.appendChild(this.pad);\r\n\r\n    this.interactionTarget = this.pad;\r\n\r\n    this.sizeInterface();\r\n  }\r\n\r\n  sizeInterface() {\r\n    this.pad.setAttribute('cx',this.width/2);\r\n    this.pad.setAttribute('cy',this.height/2);\r\n    this.pad.setAttribute('r', Math.min(this.width,this.height) / 2 - 2);\r\n  }\r\n\r\n  render() {\r\n    if (!this.state) {\r\n      this.pad.setAttribute('fill', this.colors.fill);\r\n      this.pad.setAttribute('stroke', this.colors.mediumLight);\r\n    } else {\r\n      this.pad.setAttribute('fill', this.colors.accent);\r\n      this.pad.setAttribute('stroke', this.colors.accent);\r\n    }\r\n  }\r\n\r\n  down(paintbrush) {\r\n    switch (this.mode) {\r\n      case 'impulse':\r\n        this.turnOn();\r\n        if (this.timeout) {\r\n          clearTimeout(this.timeout);\r\n        }\r\n        this.timeout = setTimeout(this.turnOff.bind(this),30);\r\n    //    this.emit('change',this.state);\r\n        break;\r\n      case 'button':\r\n        this.turnOn();\r\n    //    this.emit('change',this.state);\r\n        break;\r\n      case 'aftertouch':\r\n        this.position = {\r\n          x: math.clip(this.mouse.x / this.width,0,1),\r\n          y: math.clip(1-this.mouse.y / this.height,0,1)\r\n        };\r\n        this.turnOn();\r\n    //    this.emit('change',{\r\n    //      state: this.state,\r\n    //      x: this.position.x,\r\n    //      y: this.position.y,\r\n    //    });\r\n        break;\r\n      case 'toggle':\r\n        this.flip(paintbrush);\r\n    //    this.emit('change',this.state);\r\n        break;\r\n    }\r\n\r\n  }\r\n\r\n  bend(mouse) {\r\n    if (this.mode==='aftertouch') {\r\n      this.mouse = mouse || this.mouse;\r\n      this.position = {\r\n        x: math.clip(this.mouse.x / this.width,0,1),\r\n        y: math.clip(1 - this.mouse.y / this.height,0,1)\r\n      };\r\n      this.emit('change',{\r\n        state: this.state,\r\n        x: this.position.x,\r\n        y: this.position.y,\r\n      });\r\n      this.render();\r\n    }\r\n  }\r\n\r\n  up() {\r\n    switch (this.mode) {\r\n      case 'button':\r\n        this.turnOff();\r\n      //  this.emit('change',this.state);\r\n        break;\r\n      case 'aftertouch':\r\n        this.turnOff();\r\n        this.position = {\r\n          x: math.clip(this.mouse.x / this.width,0,1),\r\n          y: math.clip(1 - this.mouse.y / this.height,0,1)\r\n        };\r\n      //  this.emit('change',{\r\n      //    state: this.state,\r\n      //    x: this.position.x,\r\n      //    y: this.position.y,\r\n      //  });\r\n        break;\r\n    }\r\n  }\r\n\r\n  /* overwritable interaction handlers */\r\n\r\n  click() {\r\n    this.down();\r\n  }\r\n  move() {\r\n    this.bend();\r\n  }\r\n  release() {\r\n    this.up();\r\n  }\r\n\r\n  /**\r\n  Whether the button is on (pressed) or off (not pressed)\r\n  @type {boolean}\r\n  @example button.state = true;\r\n  */\r\n  get state() {\r\n    return this._state.state;\r\n  }\r\n  set state(value) {\r\n    this._state.flip(value);\r\n    if (this.mode==='aftertouch') {\r\n      this.emit('change',{\r\n        state: this.state,\r\n        x: this.position.x,\r\n        y: this.position.y,\r\n      });\r\n    } else {\r\n      this.emit('change',this.state);\r\n    }\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  Change the button to its alternate state (off=>on, on=>off), or flip it to a specified state.\r\n  @param value {boolean} (Optional) State to flip to.\r\n  @example button.flip();\r\n  */\r\n  flip(value) {\r\n    this._state.flip(value);\r\n    if (this.mode==='aftertouch') {\r\n      this.emit('change',{\r\n        state: this.state,\r\n        x: this.position.x,\r\n        y: this.position.y,\r\n      });\r\n    } else {\r\n      this.emit('change',this.state);\r\n    }\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  Turn the button's state to true.\r\n  @example button.turnOn();\r\n  */\r\n  turnOn(emitting) {\r\n    this._state.on();\r\n    if (emitting!==false) {\r\n      if (this.mode==='aftertouch') {\r\n        this.emit('change',{\r\n          state: this.state,\r\n          x: this.position.x,\r\n          y: this.position.y,\r\n        });\r\n      } else {\r\n        this.emit('change',this.state);\r\n      }\r\n    }\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  Turn the button's state to false.\r\n  @example button.turnOff();\r\n  */\r\n  turnOff(emitting) {\r\n    this._state.off();\r\n    if (emitting!==false) {\r\n      if (this.mode==='aftertouch') {\r\n        this.emit('change',{\r\n          state: this.state,\r\n          x: this.position.x,\r\n          y: this.position.y,\r\n        });\r\n      } else {\r\n        this.emit('change',this.state);\r\n      }\r\n    }\r\n    this.render();\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport svg from '../util/svg.js';\r\nimport ButtonTemplate from '../components/buttontemplate.js';\r\n\r\n/**\r\n* Button\r\n*\r\n* @description Circular button with optional aftertouch.\r\n*\r\n* @demo <span nexus-ui=\"button\"></span>\r\n*\r\n* @example\r\n* var button = new Nexus.Button('#target')\r\n*\r\n* @example\r\n* var button = new Nexus.Button('#target',{\r\n*   'size': [80,80],\r\n*   'mode': 'aftertouch',\r\n*   'state': false\r\n* })\r\n*\r\n* @output\r\n* change\r\n* Fires any time the interface's value changes. <br>\r\n* In <b>button mode</b>, <b>toggle mode</b>, and <b>impulse mode</b>, the output data is a boolean describing the state of the button.<br>\r\n* In <b>aftertouch mode</b>, the output data is an object containing x (0-1) and y (0-1) positions of aftertouch.\r\n*\r\n* @outputexample\r\n* button.on('change',function(v) {\r\n*   // v is the value of the button\r\n*   console.log(v);\r\n* })\r\n*\r\n*/\r\n\r\nexport default class Button extends ButtonTemplate {\r\n\r\n  constructor() {\r\n\r\n    let options = ['mode'];\r\n\r\n\r\n    let defaults = {\r\n      'size': [80,80],\r\n      'mode': 'aftertouch', // button, aftertouch, impulse, toggle\r\n      'state': false\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n\r\n    /**\r\n    * Interaction mode: supports \"button\", \"aftertouch\", \"impulse\", or \"toggle\"\r\n    * @type {string}\r\n    * @example button.mode = 'toggle';\r\n    */\r\n    this.mode = this.settings.mode;\r\n\r\n    this.init();\r\n    this.render();\r\n\r\n  }\r\n\r\n  buildInterface() {\r\n    this.pad = svg.create('circle');\r\n    this.element.appendChild(this.pad);\r\n\r\n    this.interactionTarget = this.pad;\r\n\r\n    // only used if in 'aftertouch' mode\r\n    this.defs = svg.create('defs');\r\n    this.element.appendChild(this.defs);\r\n\r\n    this.gradient = svg.radialGradient(this.defs,2);\r\n\r\n    this.gradient.stops[0].setAttribute('offset', '30%');\r\n\r\n    this.gradient.stops[1].setAttribute('offset', '100%');\r\n\r\n  }\r\n\r\n  sizeInterface() {\r\n\r\n    this.pad.setAttribute('cx',this.width/2);\r\n    this.pad.setAttribute('cy',this.height/2);\r\n    this.pad.setAttribute('r', Math.min(this.width,this.height) / 2 - this.width/40);\r\n    this.pad.setAttribute('stroke-width', this.width/20);\r\n  }\r\n\r\n  colorInterface() {\r\n\r\n    this.gradient.stops[0].setAttribute('stop-color', this.colors.accent);\r\n    this.gradient.stops[1].setAttribute('stop-color', this.colors.fill);\r\n    this.render();\r\n  }\r\n\r\n  /*\r\n  * Update the visual interface using its current state\r\n  *\r\n  * @example\r\n  * button.render();\r\n  */\r\n  render() {\r\n    if (!this.state) {\r\n      this.pad.setAttribute('fill', this.colors.fill);\r\n      this.pad.setAttribute('stroke', this.colors.mediumLight);\r\n    } else {\r\n      if (this.mode==='aftertouch') {\r\n        this.pad.setAttribute('stroke', 'url(#'+this.gradient.id+')');\r\n        this.gradient.element.setAttribute('cx', (this.position.x*100)+'%');\r\n        this.gradient.element.setAttribute('cy', ((1-this.position.y)*100)+'%');\r\n      } else {\r\n        this.pad.setAttribute('stroke', this.colors.accent);\r\n      }\r\n      this.pad.setAttribute('fill', this.colors.accent);\r\n    }\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport ButtonTemplate from '../components/buttontemplate.js';\r\n\r\n/**\r\n* TextButton\r\n*\r\n* @description Text button\r\n*\r\n* @demo <span nexus-ui=\"textButton\"></span>\r\n*\r\n* @example\r\n* var textbutton = new Nexus.TextButton('#target')\r\n*\r\n* @example\r\n* var textbutton = new Nexus.TextButton('#target',{\r\n*     'size': [150,50],\r\n*     'state': false,\r\n*     'text': 'Play',\r\n*     'alternateText': 'Stop'\r\n* })\r\n*\r\n* @output\r\n* change\r\n* Fires any time the interface's value changes. <br>\r\n* The event data is a <i>string</i> of the text on the button at the moment it was clicked.\r\n*\r\n* @outputexample\r\n* textbutton.on('change',function(v) {\r\n*   console.log(v);\r\n* })\r\n*\r\n*/\r\n\r\nexport default class TextButton extends ButtonTemplate {\r\n\r\n  constructor() {\r\n\r\n    let options = ['value'];\r\n\r\n    let defaults = {\r\n      'size': [150,50],\r\n      'state': false,\r\n      'text': 'Play'\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n    this._text = this.settings.text;\r\n\r\n    if(this.settings.alternate){ //TODO: Remove this conditional in a breaking-changes release\r\n      this.settings.alternateText = this.settings.alternate;\r\n      console.warn(\"'alternate' initiator is deprecated. Use 'alternateText' instead.\");\r\n    }\r\n    this._alternateText = this.settings.alternateText;\r\n    this.mode = (this.settings.alternateText) ? 'toggle' : 'button';\r\n    this.init();\r\n    this.render();\r\n\r\n    this.state = this.settings.state;\r\n\r\n  }\r\n\r\n  buildFrame() {\r\n\r\n    this.element = document.createElement('div');\r\n    this.parent.appendChild(this.element);\r\n\r\n    this.textElement = document.createElement('div');\r\n    this.textElement.innerHTML = this._text;\r\n    this.element.appendChild(this.textElement);\r\n  }\r\n\r\n  buildInterface() {\r\n\r\n  }\r\n\r\n  colorInterface() {\r\n    this.element.style.color = this.colors.dark;\r\n    this.render();\r\n  }\r\n\r\n  sizeInterface() {\r\n      let textsize = this.height/3;\r\n      let textsize2 = (this.width / (this._text.length + 2) );\r\n      textsize = Math.min(textsize,textsize2);\r\n      if (this.alternateText) {\r\n        let textsize3 = (this.width / (this.alternateText.length + 2) );\r\n        textsize = Math.min(textsize,textsize3);\r\n      }\r\n      let styles = 'width: ' + this.width + 'px;';\r\n      styles += 'height: ' + this.height + 'px;';\r\n      styles += 'padding: '+(this.height-textsize)/2+'px 0px;';\r\n      styles += 'box-sizing: border-box;';\r\n      styles += 'text-align: center;';\r\n      styles += 'font-family: inherit;';\r\n      styles += 'font-weight: 700;';\r\n      styles += 'opacity: 1;';\r\n      styles += 'font-size:' + textsize + 'px;';\r\n      this.textElement.style.cssText = styles;\r\n      this.render();\r\n  }\r\n\r\n  render() {\r\n    if (!this.state) {\r\n      this.element.style.backgroundColor = this.colors.fill;\r\n      this.textElement.style.color = this.colors.dark;\r\n      this.textElement.innerHTML = this._text;\r\n    } else {\r\n      this.element.style.backgroundColor = this.colors.accent;\r\n      this.textElement.style.color = this.colors.fill;\r\n      if (this.alternateText) {\r\n        this.textElement.innerHTML = this._alternateText;\r\n      } else {\r\n        this.textElement.innerHTML = this._text;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n  The text to display when the button is in its \"on\" state. If set, this puts the button in \"toggle\" mode.\r\n  @type {String}\r\n  */\r\n  get alternateText() {\r\n    return this._alternateText;\r\n  }\r\n\r\n  set alternateText(text) {\r\n    if (text) {\r\n      this.mode = 'toggle';\r\n    } else {\r\n      this.mode = 'button';\r\n    }\r\n    this._alternateText = text;\r\n    this.render();\r\n  }\r\n\r\n\r\n  /**\r\n  The text to display. (If .alternateText exists, then this .text will only be displayed when the button is in its \"off\" state.)\r\n  @type {String}\r\n  */\r\n  get text() {\r\n    return this._text;\r\n  }\r\n\r\n  set text(text) {\r\n    this._text = text;\r\n    this.sizeInterface();\r\n    this.render();\r\n  }\r\n\r\n\r\n}\r\n","'use strict';\r\n\r\n//import svg from '../util/svg.js';\r\nimport Interface from '../core/interface.js';\r\nimport Button from '../interfaces/button.js';\r\n\r\n/**\r\n * RadioButton\r\n *\r\n * @description An array of buttons. By default, selecting one button will deselect all other buttons, but this can be customized using the API below.\r\n *\r\n * @demo <div nexus-ui=\"RadioButton\"></div>\r\n *\r\n * @example\r\n * var radiobutton = new Nexus.RadioButton('#target')\r\n *\r\n * @example\r\n * var radiobutton = new Nexus.RadioButton('#target',{\r\n *   'size': [120,25],\r\n *   'numberOfButtons': 4,\r\n *   'active': -1\r\n * })\r\n *\r\n * @output\r\n * change\r\n * Fires any time the interface's value changes. <br>\r\n * The event data an <i>integer</i>, the index of the button that is currently on. If no button is selected, the value will be -1.\r\n *\r\n * @outputexample\r\n * radiobutton.on('change',function(v) {\r\n *   console.log(v);\r\n * })\r\n *\r\n */\r\n\r\nexport default class RadioButton extends Interface {\r\n  constructor() {\r\n    let options = ['value'];\r\n\r\n    let defaults = {\r\n      size: [120, 25],\r\n      numberOfButtons: 4,\r\n      active: -1\r\n    };\r\n\r\n    super(arguments, options, defaults);\r\n\r\n    this.buttons = [];\r\n    this._numberOfButtons = this.settings.numberOfButtons;\r\n    this.active = this.settings.active;\r\n\r\n    this.init();\r\n    this.render();\r\n  }\r\n\r\n  buildFrame() {\r\n    this.element = document.createElement('div');\r\n    this.parent.appendChild(this.element);\r\n  }\r\n\r\n  buildInterface() {\r\n    for (let i = 0; i < this._numberOfButtons; i++) {\r\n      let container = document.createElement('span');\r\n\r\n      let button = new Button(\r\n        container,\r\n        {\r\n          mode: 'toggle',\r\n          component: true\r\n        },\r\n        this.update.bind(this, i)\r\n      );\r\n\r\n      this.buttons.push(button);\r\n      this.element.appendChild(container);\r\n    }\r\n  }\r\n\r\n  sizeInterface() {\r\n    let orientation;\r\n    if (this.width > this.height) {\r\n      orientation = 'horizontal';\r\n    } else {\r\n      orientation = 'vertical';\r\n    }\r\n\r\n    let buttonWidth =\r\n      this.width / (orientation === 'vertical' ? 1 : this._numberOfButtons);\r\n    let buttonHeight =\r\n      this.height / (orientation === 'vertical' ? this._numberOfButtons : 1);\r\n\r\n    for (let i = 0; i < this._numberOfButtons; i++) {\r\n      this.buttons[i].resize(buttonWidth, buttonHeight);\r\n    }\r\n  }\r\n\r\n  colorInterface() {\r\n    for (let i = 0; i < this._numberOfButtons; i++) {\r\n      this.buttons[i].colors = this.colors;\r\n      this.buttons[i].render();\r\n    }\r\n  }\r\n\r\n  update(index) {\r\n    if (this.buttons[index].state) {\r\n      this.select(index);\r\n    } else {\r\n      this.deselect();\r\n    }\r\n    //  this.render();\r\n  }\r\n\r\n  render() {\r\n    for (let i = 0; i < this.buttons.length; i++) {\r\n      if (i === this.active) {\r\n        this.buttons[i].turnOn(false);\r\n      } else {\r\n        this.buttons[i].turnOff(false);\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n  Select one button and deselect all other buttons.\r\n  @param index {number} The index of the button to select\r\n  */\r\n  select(index) {\r\n    if (index >= 0 && index < this.buttons.length) {\r\n      this.active = index;\r\n      this.emit('change', this.active);\r\n      this.render();\r\n    }\r\n  }\r\n\r\n  /**\r\n  Deselect all buttons.\r\n  */\r\n  deselect() {\r\n    this.active = -1;\r\n    this.emit('change', this.active);\r\n    this.render();\r\n  }\r\n\r\n  get numberOfButtons() {\r\n    return this._numberOfButtons;\r\n  }\r\n\r\n  /**\r\n   * Update how many buttons are in the interface\r\n   * @param  {number} buttons How many buttons are in the interface\r\n   */\r\n  set numberOfButtons(buttons) {\r\n    this._numberOfButtons = buttons;\r\n    for (let i = 0; i < this.buttons.length; i++) {\r\n      this.buttons[i].destroy();\r\n    }\r\n    this.buttons = [];\r\n    //  for (let i=0;i<this.buttons.length;i++) {\r\n    //    this.buttons[i].destroy();\r\n    //  }\r\n    this.empty();\r\n    this.buildInterface();\r\n  }\r\n}\r\n","'use strict';\r\n\r\nimport Interface from '../core/interface.js';\r\nimport Step from '../models/step.js';\r\nimport math from '../util/math.js';\r\nimport util from '../util/util.js';\r\n\r\n/**\r\n* Number\r\n*\r\n* @description Number interface which is controllable by dragging or typing.\r\n*\r\n* @demo <span nexus-ui=\"number\"></span>\r\n*\r\n* @example\r\n* var number = new Nexus.Number('#target')\r\n*\r\n* @example\r\n* var number = new Nexus.Number('#target',{\r\n*   'size': [60,30],\r\n*   'value': 0,\r\n*   'min': 0,\r\n*   'max': 20000,\r\n*   'step': 1\r\n* })\r\n*\r\n* @output\r\n* change\r\n* Fires any time the interface's value changes. <br>\r\n* The event data is the number value of the interface.\r\n*\r\n* @outputexample\r\n* number.on('change',function(v) {\r\n*   console.log(v);\r\n* })\r\n*\r\n*\r\n*/\r\n\r\n\r\nexport default class Number extends Interface {\r\n\r\n  constructor() {\r\n\r\n    let options = ['value'];\r\n\r\n    let defaults = {\r\n      'size': [60,30],\r\n      'value': 0,\r\n      'min': 0,\r\n      'max': 20000,\r\n      'step': 1\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n    this._value = new Step(this.settings.min,this.settings.max,this.settings.step,this.settings.value);\r\n\r\n    /*\r\n    Default: 2. How many decimal places to clip the number's visual rendering to. This does not affect number's actual value output -- for that, set the step property to .01, .1, or 1.\r\n    @type {number}\r\n    @example number.decimalPlaces = 2;\r\n    */\r\n    this.decimalPlaces = 2;\r\n    this.actual = 0;\r\n\r\n    this.max = this._value.max;\r\n\r\n    this.min = this._value.min;\r\n\r\n    this.step = this._value.step;\r\n\r\n    this.init();\r\n    this.render();\r\n\r\n  }\r\n\r\n  buildFrame() {\r\n    this.element = document.createElement('input');\r\n    this.element.type = 'text';\r\n\r\n    this.element.addEventListener('blur', function () {\r\n      this.element.style.backgroundColor = this.colors.fill;\r\n      this.element.style.color = this.colors.dark;\r\n      if (this.element.value !== this.value) {\r\n        this.value = parseFloat(this.element.value);\r\n        this.render();\r\n      }\r\n    }.bind(this));\r\n\r\n    util.setInputFilter(this.element, function(value) {\r\n      return /^-?\\d*\\.?\\d*$/.test(value); });\r\n\r\n    this.element.addEventListener('keydown', function (e) {\r\n      if (e.which===13) {\r\n        this.element.blur();\r\n        this.value = this.element.value;\r\n        this.emit('change',this.value);\r\n        this.render();\r\n      }\r\n    }.bind(this), true);\r\n\r\n    this.parent.appendChild(this.element);\r\n\r\n  }\r\n\r\n  sizeInterface() {\r\n\r\n    this._minDimension = Math.min(this.width,this.height);\r\n\r\n    let styles = 'width: ' + this.width + 'px;';\r\n    styles += 'height: ' + this.height + 'px;';\r\n    styles += 'background-color: #e7e7e7;';\r\n    styles += 'color: #333;';\r\n    styles += 'font-family: arial;';\r\n    styles += 'font-weight: 500;';\r\n    styles += 'font-size:' + this._minDimension/2 + 'px;';\r\n  //  styles += 'highlight: #d18;';\r\n    styles += 'border: none;';\r\n    styles += 'outline: none;';\r\n    styles += 'padding: '+this._minDimension/4+'px '+this._minDimension/4+'px;';\r\n    styles += 'box-sizing: border-box;';\r\n    styles += 'userSelect: text;';\r\n    styles += 'mozUserSelect: text;';\r\n    styles += 'webkitUserSelect: text;';\r\n    this.element.style.cssText += styles;\r\n\r\n    // to add eventually\r\n    // var css = '#'+this.elementID+'::selection{ background-color: transparent }';\r\n\r\n    this.element.value = this.value;\r\n\r\n  }\r\n\r\n  colorInterface() {\r\n      this.element.style.backgroundColor = this.colors.fill;\r\n      this.element.style.color = this.colors.dark;\r\n  }\r\n\r\n  render() {\r\n\r\n    this.element.value = math.prune(this.value,this.decimalPlaces);\r\n\r\n  }\r\n\r\n  click() {\r\n    this.hasMoved = false;\r\n    this.element.readOnly = true;\r\n\t  this.actual = this.value;\r\n    this.initial = { y: this.mouse.y };\r\n    this.changeFactor = math.invert( this.mouse.x / this.width );\r\n  }\r\n\r\n  move() {\r\n    this.hasMoved = true;\r\n    if (this.clicked) {\r\n\r\n      let newvalue = this.actual - (this.mouse.y - this.initial.y) * ( math.clip( this.max-this.min, 0, 1000 ) / 200 ) * Math.pow(this.changeFactor,2);\r\n      this.value = newvalue;\r\n\r\n  \t\tthis.render();\r\n      if (this._value.changed) {\r\n        this.emit('change',this.value);\r\n      }\r\n\r\n  \t}\r\n  }\r\n\r\n  release() {\r\n    if (!this.hasMoved) {\r\n      this.element.readOnly = false;\r\n  \t\tthis.element.focus();\r\n  \t\tthis.element.setSelectionRange(0, this.element.value.length);\r\n  \t\tthis.element.style.backgroundColor = this.colors.accent;\r\n  \t\tthis.element.style.color = this.colors.light;\r\n    } else {\r\n      document.body.focus();\r\n    }\r\n  }\r\n\r\n  /**\r\n  Connect this number interface to a dial or slider\r\n  @param {Interface} element Element to connect to.\r\n  @example number.link(slider)\r\n  */\r\n  link(destination) {\r\n    this.min = destination.min;\r\n    this.max = destination.max;\r\n    this.step = destination.step;\r\n    destination.on('change',(v) => {\r\n      this.passiveUpdate(v);\r\n    });\r\n    this.on('change',(v) => {\r\n      destination.value = v;\r\n    });\r\n    this.value = destination.value;\r\n  /*  return {\r\n      listener1: listener1,\r\n      listener2: listener2,\r\n      destroy: () => {\r\n        listener1.remove() (or similar)\r\n        listener2.remove() (or similar)\r\n      }\r\n    } */\r\n  }\r\n\r\n  passiveUpdate(v) {\r\n    this._value.update(v);\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  The interface's current value. If set manually, will update the interface and trigger the output event.\r\n  @type {number}\r\n  @example number.value = 10;\r\n  */\r\n  get value() {\r\n    return this._value.value;\r\n  }\r\n  set value(v) {\r\n    this._value.update(v);\r\n    this.emit('change',this.value);\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  Lower limit of the number's output range\r\n  @type {number}\r\n  @example number.min = 1000;\r\n  */\r\n  get min() {\r\n    return this._value.min;\r\n  }\r\n  set min(v) {\r\n    this._value.min = v;\r\n  }\r\n\r\n  /**\r\n  Upper limit of the number's output range\r\n  @type {number}\r\n  @example number.max = 1000;\r\n  */\r\n  get max() {\r\n    return this._value.max;\r\n  }\r\n  set max(v) {\r\n    this._value.max = v;\r\n  }\r\n\r\n  /**\r\n  The increment that the number's value changes by.\r\n  @type {number}\r\n  @example number.step = 5;\r\n  */\r\n  get step() {\r\n    return this._value.step;\r\n  }\r\n  set step(v) {\r\n    this._value.step = v;\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport Interface from '../core/interface.js';\r\n\r\n/**\r\n* Select\r\n*\r\n* @description Dropdown menu\r\n*\r\n* @demo <span nexus-ui=\"select\"></span>\r\n*\r\n* @example\r\n* var select = new Nexus.Select('#target')\r\n*\r\n* @example\r\n* var select = new Nexus.Select('#target',{\r\n*   'size': [100,30],\r\n*   'options': ['default','options']\r\n* })\r\n*\r\n* @output\r\n* change\r\n* Fires any time the interface's value changes. <br>\r\n* The event data is an object containing the text value of the selected option, as well as the numeric index of the selection.\r\n*\r\n* @outputexample\r\n* select.on('change',function(v) {\r\n*   console.log(v);\r\n* })\r\n*\r\n*\r\n*/\r\n\r\n\r\nexport default class Select extends Interface {\r\n\r\n  constructor() {\r\n\r\n    let options = ['value'];\r\n\r\n    let defaults = {\r\n       'size': [100,30],\r\n       'options': ['default','options']\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n    this._selectedIndex = -1;\r\n    this._value = false;\r\n\r\n    this._options = this.settings.options;\r\n\r\n    this.init();\r\n    this.render();\r\n\r\n  }\r\n\r\n  buildFrame() {\r\n    this.element = document.createElement('select');\r\n    this.element.style.fontSize = this.height/2+'px';\r\n    this.element.style.outline = 'none';\r\n    this.element.style.highlight = 'none';\r\n    this.element.style.width = this.width+'px';\r\n    this.element.style.height = this.height+'px';\r\n\r\n    this.boundRender = this.render.bind(this);\r\n\r\n    this.element.addEventListener('change', this.boundRender);\r\n\r\n    this.parent.appendChild(this.element);\r\n\r\n  }\r\n\r\n  attachListeners() {\r\n\r\n  }\r\n\r\n  buildInterface() {\r\n\r\n    this.defineOptions();\r\n\r\n  }\r\n\r\n  colorInterface() {\r\n    this.element.style.backgroundColor = this.colors.fill;\r\n    this.element.style.color = this.colors.dark;\r\n    this.element.style.border = 'solid 0px '+this.colors.mediumLight;\r\n  }\r\n\r\n  render() {\r\n\r\n    this._value = this.element.options[this.element.selectedIndex].text;\r\n    this._selectedIndex = this.element.selectedIndex;\r\n    this.emit('change',{\r\n      value: this._value,\r\n      index: this._selectedIndex\r\n    });\r\n\r\n  }\r\n\r\n  click() {\r\n\r\n  }\r\n\r\n  move() {\r\n\r\n  }\r\n\r\n  release() {\r\n\r\n  }\r\n\r\n  /**\r\n   * Update the list of options. This removes all existing options and creates a new list of options.\r\n   * @param  {array} options New array of options\r\n   */\r\n\r\n  defineOptions(options) {\r\n\r\n  /*  function removeOptions(selectbox)\r\n    {\r\n        var i;\r\n        for(i = selectbox.options.length - 1 ; i >= 0 ; i--)\r\n        {\r\n            selectbox.remove(i);\r\n        }\r\n    }\r\n    //using the function:\r\n    removeOptions(document.getElementById(\"mySelectObject\")); */\r\n\r\n\r\n    if (options) {\r\n      this._options = options;\r\n    }\r\n\r\n    for(let i=this.element.options.length-1; i >= 0; i--) {\r\n      this.element.remove(i);\r\n    }\r\n\r\n    for(let i=0;i<this._options.length;i++) {\r\n      this.element.options.add(new Option(this._options[i], i));\r\n    }\r\n\r\n  }\r\n\r\n\r\n  /**\r\n  The text of the option that is currently selected. If set, will update the interface and trigger the output event.\r\n  @type {String}\r\n  @example select.value = \"sawtooth\";\r\n  */\r\n  get value() {\r\n    return this._value;\r\n  }\r\n  set value(v) {\r\n    this._value = v;\r\n    for(let i=0;i<this.element.options.length;i++) {\r\n      if (v === this.element.options[i].text) {\r\n        this.selectedIndex = i;\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n\r\n  /**\r\n  The numeric index of the option that is currently selected. If set, will update the interface and trigger the output event.\r\n  @type {number}\r\n  @example select.selectedIndex = 2;\r\n  */\r\n  get selectedIndex() {\r\n    return this._selectedIndex;\r\n  }\r\n  set selectedIndex(v) {\r\n    this._selectedIndex = v;\r\n    this.element.selectedIndex = v;\r\n    this.render();\r\n  }\r\n\r\n  customDestroy() {\r\n    this.element.removeEventListener('change', this.boundRender);\r\n  }\r\n\r\n\r\n}\r\n","'use strict';\r\n\r\nimport svg from '../util/svg.js';\r\nimport math from '../util/math.js';\r\nimport Interface from '../core/interface.js';\r\nimport Step from '../models/step.js';\r\nimport * as Interaction from '../util/interaction';\r\n\r\n/**\r\n* Dial\r\n*\r\n*\r\n* @description Dial with radial or linear interaction.\r\n*\r\n* @demo <span nexus-ui=\"dial\"></span>\r\n*\r\n* @example\r\n* var dial = new Nexus.Dial('#target')\r\n*\r\n* @example\r\n* var dial = new Nexus.Dial('#target',{\r\n*   'size': [75,75],\r\n*   'interaction': 'radial', // \"radial\", \"vertical\", or \"horizontal\"\r\n*   'mode': 'relative', // \"absolute\" or \"relative\"\r\n*   'min': 0,\r\n*   'max': 1,\r\n*   'step': 0,\r\n*   'value': 0\r\n* })\r\n*\r\n* @output\r\n* change\r\n* Fires any time the interface's value changes. <br>\r\n* The event data is the number value of the interface.\r\n*\r\n* @outputexample\r\n* dial.on('change',function(v) {\r\n*   console.log(v);\r\n* })\r\n*\r\n* @tutorial\r\n* Dial\r\n* ygGMxq\r\n*\r\n*/\r\n\r\nexport default class Dial extends Interface {\r\n\r\n  constructor() {\r\n\r\n    let options = ['min','max','value'];\r\n\r\n    let defaults = {\r\n      'size': [75,75],\r\n      'interaction': 'radial', // radial, vertical, horizontal\r\n      'mode': 'relative', // absolute, relative\r\n      'min': 0,\r\n      'max': 1,\r\n      'step': 0,\r\n      'value': 0\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n    this.interaction = this.settings.interaction;\r\n\r\n    this._value = new Step(this.settings.min, this.settings.max, this.settings.step, this.settings.value);\r\n\r\n    this.position = new Interaction.Handle(this.settings.mode,this.interaction,[0,this.width],[this.height,0]);\r\n\r\n    this.init();\r\n\r\n    this.value = this._value.value;\r\n\r\n    this.position.value = this._value.normalized;\r\n\r\n    this.previousAngle = false;\r\n\r\n    this.emit('change',this.value);\r\n\r\n  }\r\n\r\n  buildInterface() {\r\n\r\n    this.background = svg.create('circle');\r\n    this.screw = svg.create('circle');\r\n    this.handle = svg.create('path');\r\n    this.handle2 = svg.create('path');\r\n    this.handleFill = svg.create('path');\r\n    this.handle2Fill = svg.create('path');\r\n    this.handleLine = svg.create('path');\r\n\r\n    this.element.appendChild(this.background);\r\n    this.element.appendChild(this.handle);\r\n    this.element.appendChild(this.handle2);\r\n    this.element.appendChild(this.handleFill);\r\n    this.element.appendChild(this.handle2Fill);\r\n    this.element.appendChild(this.handleLine);\r\n    this.element.appendChild(this.screw);\r\n\r\n  }\r\n\r\n\r\n  sizeInterface() {\r\n\r\n    this.position.resize([0,this.width],[this.height,0]);\r\n\r\n    let center = {\r\n      x: this.width/2,\r\n      y: this.height/2\r\n    };\r\n\r\n    let diameter = Math.min(this.width,this.height);\r\n\r\n    this.background.setAttribute('cx', center.x);\r\n    this.background.setAttribute('cy', center.y);\r\n    this.background.setAttribute('r', diameter/2-diameter/40);\r\n\r\n    this.screw.setAttribute('cx', center.x);\r\n    this.screw.setAttribute('cy', center.y);\r\n    this.screw.setAttribute('r', diameter/12);\r\n\r\n    let value = this.value;\r\n\r\n    let handlePoints = {\r\n      start: Math.PI*1.5,\r\n      end: math.clip( math.scale(value,0,0.5,Math.PI*1.5,Math.PI*0.5) , Math.PI*0.5, Math.PI*1.5 )\r\n    };\r\n    let handle2Points = {\r\n      start: Math.PI*2.5,\r\n      end: math.clip( math.scale(value,0.5,1,Math.PI*2.5,Math.PI*1.5) , Math.PI*1.5, Math.PI*2.5 )\r\n    };\r\n\r\n    let handlePath = svg.arc(center.x, center.y, diameter/2-diameter/40, handlePoints.start, handlePoints.end);\r\n    let handle2Path = svg.arc(center.x, center.y, diameter/2-diameter/40, handle2Points.start, handle2Points.end);\r\n\r\n    this.handle.setAttribute('d',handlePath);\r\n    this.handle.setAttribute('stroke-width', diameter/20);\r\n    this.handle.setAttribute('fill', 'none');\r\n\r\n    this.handle2.setAttribute('d',handle2Path);\r\n    this.handle2.setAttribute('stroke-width', diameter/20);\r\n    this.handle2.setAttribute('fill', 'none');\r\n\r\n    handlePath += ' L '+center.x+' '+center.y;\r\n\r\n    this.handleFill.setAttribute('d',handlePath);\r\n    this.handleFill.setAttribute('fill-opacity', '0.3');\r\n\r\n    handle2Path += ' L '+center.x+' '+center.y;\r\n\r\n    this.handle2Fill.setAttribute('d',handle2Path);\r\n    this.handle2Fill.setAttribute('fill-opacity', '0.3');\r\n\r\n    let arcEndingA;\r\n    if (value < 0.5) {\r\n      arcEndingA = handlePoints.end;\r\n    } else {\r\n      arcEndingA = handle2Points.end;\r\n    }\r\n\r\n    let arcEndingX = center.x + Math.cos(arcEndingA) * (diameter/2);\r\n    let arcEndingY = center.y + Math.sin(arcEndingA) * (diameter/2) * -1;\r\n\r\n    this.handleLine.setAttribute('d','M '+center.x+' '+center.y+' L '+arcEndingX+' '+arcEndingY);\r\n    this.handleLine.setAttribute('stroke-width', diameter/20);\r\n\r\n  }\r\n\r\n  colorInterface() {\r\n    this.background.setAttribute('fill', this.colors.fill);\r\n    this.screw.setAttribute('fill', this.colors.accent);\r\n    this.handle.setAttribute('stroke', this.colors.accent);\r\n    this.handle2.setAttribute('stroke', this.colors.accent);\r\n    this.handleFill.setAttribute('fill', this.colors.accent);\r\n    this.handle2Fill.setAttribute('fill', this.colors.accent);\r\n    this.handleLine.setAttribute('stroke', this.colors.accent);\r\n\r\n  }\r\n\r\n  render() {\r\n    let value = this._value.normalized;\r\n\r\n    let center = {\r\n      x: this.width/2,\r\n      y: this.height/2\r\n    };\r\n\r\n    let diameter = Math.min(this.width,this.height);\r\n\r\n    let handlePoints = {\r\n      start: Math.PI*1.5,\r\n      end: math.clip( math.scale(value,0,0.5,Math.PI*1.5,Math.PI*0.5) , Math.PI*0.5, Math.PI*1.5 )\r\n    };\r\n    let handle2Points = {\r\n      start: Math.PI *2.5,\r\n      end: math.clip( math.scale(value,0.5,1,Math.PI*2.5,Math.PI*1.5) , Math.PI*1.5, Math.PI*2.5 )\r\n    };\r\n\r\n    let handlePath = svg.arc(center.x, center.y, diameter/2-diameter/40, handlePoints.start, handlePoints.end);\r\n    let handle2Path = svg.arc(center.x, center.y, diameter/2-diameter/40, handle2Points.start, handle2Points.end);\r\n\r\n    this.handle.setAttribute('d',handlePath);\r\n    this.handle2.setAttribute('d',handle2Path);\r\n\r\n\r\n    handlePath += ' L '+center.x+' '+center.y;\r\n\r\n    this.handleFill.setAttribute('d',handlePath);\r\n\r\n    handle2Path += ' L '+center.x+' '+center.y;\r\n\r\n    this.handle2Fill.setAttribute('d',handle2Path);\r\n\r\n    let arcEndingA;\r\n    if (value <= 0.5) {\r\n      arcEndingA = handlePoints.end;\r\n    } else {\r\n      arcEndingA = handle2Points.end;\r\n    }\r\n\r\n    let arcEndingX = center.x + Math.cos(arcEndingA) * (diameter/2);\r\n    let arcEndingY = center.y + Math.sin(arcEndingA) * (diameter/2) * -1;\r\n\r\n    this.handleLine.setAttribute('d','M '+center.x+' '+center.y+' L '+arcEndingX+' '+arcEndingY);\r\n\r\n  }\r\n\r\n\r\n  click() {\r\n    if (this.mode==='relative') {\r\n      this.previousAngle = false;\r\n    }\r\n    this.position.anchor = this.mouse;\r\n    this.position.value = this._value.normalized;\r\n    this.move();\r\n   }\r\n\r\n  move() {\r\n    if (this.clicked) {\r\n\r\n      this.position.update(this.mouse);\r\n\r\n      let angle = this.position.value*Math.PI*2;\r\n\r\n      if (angle < 0 ) { angle += (Math.PI*2); }\r\n\r\n      if ((this.mode === \"relative\") && (this.position.direction === \"radial\")) {\r\n        if (this.previousAngle !== false && Math.abs(this.previousAngle - angle) > 2) {\r\n          if (this.previousAngle > 3) {\r\n            angle = Math.PI*2;\r\n          } else {\r\n            angle = 0;\r\n          }\r\n        }\r\n      } /* else {\r\n        if (this.previousAngle !== false && Math.abs(this.previousAngle - angle) > 2) {\r\n          if (this.previousAngle > 3) {\r\n            angle = Math.PI*2;\r\n          } else {\r\n            angle = 0;\r\n          }\r\n        }\r\n      } */\r\n      this.previousAngle = angle;\r\n\r\n      let realValue = angle / (Math.PI*2);\r\n\r\n      this.value = this._value.updateNormal( realValue );\r\n\r\n      if (this.mode === 'relative') {\r\n        this.position.value = realValue;\r\n      }\r\n\r\n      this.emit('change',this._value.value);\r\n\r\n      this.render();\r\n\r\n    }\r\n  }\r\n\r\n  release() {\r\n  }\r\n\r\n  /*\r\n  Dial's value. When set, it will automatically be adjust to fit min/max/step settings of the interface.\r\n  @type {number}\r\n  @example dial.value = 10;\r\n\r\n  get value() {\r\n    return this._value.value;\r\n  }\r\n\r\n  set value(value) {\r\n    this._value.update(value);\r\n    this.emit('change',this.value);\r\n    this.render();\r\n  }\r\n*/\r\n\r\n    /**\r\n    Dial's value. When set, it will automatically be adjust to fit min/max/step settings of the interface.\r\n    @type {number}\r\n    @example dial.value = 10;\r\n    */\r\n    get value() {\r\n      return this._value.value;\r\n    }\r\n    set value(v) {\r\n      this._value.update(v);\r\n      this.position.value = this._value.normalized;\r\n      this.emit('change',this._value.value);\r\n      this.render();\r\n    }\r\n\r\n    /**\r\n    Lower limit of the dial's output range\r\n    @type {number}\r\n    @example dial.min = 1000;\r\n    */\r\n    get min() {\r\n      return this._value.min;\r\n    }\r\n    set min(v) {\r\n      this._value.min = v;\r\n    }\r\n\r\n    /**\r\n    Upper limit of the dial's output range\r\n    @type {number}\r\n    @example dial.max = 1000;\r\n    */\r\n    get max() {\r\n      return this._value.max;\r\n    }\r\n    set max(v) {\r\n      this._value.max = v;\r\n    }\r\n\r\n    /**\r\n    The increment that the dial's value changes by.\r\n    @type {number}\r\n    @example dial.step = 5;\r\n    */\r\n    get step() {\r\n      return this._value.step;\r\n    }\r\n    set step(v) {\r\n      this._value.step = v;\r\n    }\r\n\r\n    /**\r\n    Absolute mode (dial's value jumps to mouse click position) or relative mode (mouse drag changes value relative to its current position). Default: \"relative\".\r\n    @type {string}\r\n    @example dial.mode = \"relative\";\r\n    */\r\n    get mode() {\r\n      return this.position.mode;\r\n    }\r\n    set mode(v) {\r\n      this.position.mode = v;\r\n    }\r\n\r\n\r\n  /**\r\n  Normalized value of the dial.\r\n  @type {number}\r\n  @example dial.normalized = 0.5;\r\n  */\r\n  get normalized() {\r\n    return this._value.normalized;\r\n  }\r\n\r\n  set normalized(v) {\r\n    this._value.updateNormal(v);\r\n    this.emit('change',this.value);\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport svg from '../util/svg.js';\r\nimport Interface from '../core/interface.js';\r\nimport ButtonTemplate from '../components/buttontemplate.js';\r\nimport touch from '../util/touch.js';\r\n\r\nclass PianoKey extends ButtonTemplate {\r\n\r\n  constructor() {\r\n\r\n    let options = ['value','note','color'];\r\n\r\n    let defaults = {\r\n      'size': [80,80],\r\n      'target': false,\r\n      'mode': 'button',\r\n      'value': 0\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n    this.note = this.settings.note;\r\n    this.color = this.settings.color;\r\n\r\n    this.colors = {\r\n      'w': '#fff',\r\n      'b': '#666',\r\n    };\r\n\r\n    this.init();\r\n    this.render();\r\n\r\n  }\r\n\r\n  buildFrame() {\r\n    this.element = svg.create('svg');\r\n    this.element.setAttribute('width',this.width);\r\n    this.element.setAttribute('height',this.height);\r\n    this.parent.appendChild(this.element);\r\n  }\r\n\r\n  buildInterface() {\r\n\r\n    this.pad = svg.create('rect');\r\n\r\n    this.element.appendChild(this.pad);\r\n\r\n    this.interactionTarget = this.pad;\r\n\r\n    /* events */\r\n\r\n    if (!touch.exists) {\r\n\r\n      this.click = () => {\r\n      //  console.log('click');\r\n        this.piano.interacting = true;\r\n        this.piano.paintbrush = !this.state;\r\n        this.down(this.piano.paintbrush);\r\n      };\r\n\r\n      this.pad.addEventListener('mouseover', () => {\r\n        if (this.piano.interacting) {\r\n      //    console.log('mouseover');\r\n          this.down(this.piano.paintbrush);\r\n        }\r\n      });\r\n\r\n\r\n      this.move = () => {\r\n        if (this.piano.interacting) {\r\n        //  console.log('move');\r\n          this.bend();\r\n        }\r\n      };\r\n\r\n\r\n      this.release = () => {\r\n        this.piano.interacting = false;\r\n      //  console.log('release');\r\n      //  this.up();\r\n      };\r\n      this.pad.addEventListener('mouseup', () => {\r\n        if (this.piano.interacting) {\r\n        //  console.log('mouseup');\r\n          this.up();\r\n        }\r\n      });\r\n      this.pad.addEventListener('mouseout', () => {\r\n        if (this.piano.interacting) {\r\n        //  console.log('mouseout');\r\n          this.up();\r\n        }\r\n      });\r\n\r\n    }\r\n\r\n  }\r\n\r\n  sizeInterface() {\r\n\r\n        //let radius = Math.min(this.width,this.height) / 5;\r\n        let radius = 0;\r\n\r\n        this.pad.setAttribute('x',0.5);\r\n        this.pad.setAttribute('y',0.5);\r\n        if (this.width > 2) {\r\n          this.pad.setAttribute('width', this.width - 1);\r\n        } else {\r\n          this.pad.setAttribute('width', this.width);\r\n        }\r\n        if (this.height > 2) {\r\n          this.pad.setAttribute('height', this.height);\r\n        } else {\r\n          this.pad.setAttribute('height', this.height);\r\n        }\r\n        this.pad.setAttribute('rx', radius);\r\n        this.pad.setAttribute('ry', radius);\r\n\r\n  }\r\n\r\n  render() {\r\n    if (!this.state) {\r\n      this.pad.setAttribute('fill', this.colors[this.color]);\r\n    } else {\r\n      this.pad.setAttribute('fill', this.colors.accent);\r\n    }\r\n  }\r\n\r\n}\r\n\r\n/**\r\n* Piano\r\n*\r\n* @description Piano keyboard interface\r\n*\r\n* @demo <div nexus-ui=\"piano\"></div>\r\n*\r\n* @example\r\n* var piano = new Nexus.Piano('#target')\r\n*\r\n* @example\r\n* var piano = new Nexus.Piano('#target',{\r\n*     'size': [500,125],\r\n*     'mode': 'button',  // 'button', 'toggle', or 'impulse'\r\n*     'lowNote': 24,\r\n*     'highNote': 60\r\n* })\r\n*\r\n* @output\r\n* change\r\n* Fires any time a new key is pressed or released <br>\r\n* The event data is an object containing <i>note</i> and <i>state</i> properties.\r\n*\r\n* @outputexample\r\n* piano.on('change',function(v) {\r\n*   console.log(v);\r\n* })\r\n*\r\n*/\r\n\r\nexport default class Piano extends Interface {\r\n\r\n  constructor() {\r\n\r\n    let options = ['value'];\r\n\r\n    let defaults = {\r\n      'size': [500,125],\r\n      'lowNote': 24,\r\n      'highNote': 60,\r\n      'mode': 'button'\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n    this.keyPattern = ['w','b','w','b','w','w','b','w','b','w','b','w'];\r\n\r\n    this.paintbrush = false;\r\n\r\n    this.mode = this.settings.mode;\r\n\r\n    this.range = {\r\n      low: this.settings.lowNote,\r\n      high: this.settings.highNote\r\n    };\r\n\r\n    this.range.size = this.range.high - this.range.low + 1;\r\n\r\n    this.keys = [];\r\n\r\n    this.toggleTo = false;\r\n\r\n    this.init();\r\n    this.render();\r\n\r\n  }\r\n\r\n  buildFrame() {\r\n    this.element = document.createElement('div');\r\n    this.element.style.position = 'relative';\r\n    this.element.style.borderRadius = '0px';\r\n    this.element.style.display = 'block';\r\n    this.element.style.width = '100%';\r\n    this.element.style.height = '100%';\r\n    this.parent.appendChild(this.element);\r\n  }\r\n\r\n  buildInterface() {\r\n\r\n    this.keys = [];\r\n\r\n    for (let i=0;i<this.range.size;i++) {\r\n\r\n      let container = document.createElement('span');\r\n      let scaleIndex = (i+this.range.low) % this.keyPattern.length;\r\n\r\n      let key = new PianoKey(container, {\r\n          component: true,\r\n          note: i+this.range.low,\r\n          color: this.keyPattern[scaleIndex],\r\n          mode: this.mode\r\n        }, this.keyChange.bind(this,i+this.range.low));\r\n\r\n      key.piano = this;\r\n\r\n      if (touch.exists) {\r\n        key.pad.index = i;\r\n        key.preClick = key.preMove = key.preRelease = () => {};\r\n        key.click = key.move = key.release = () => {};\r\n        key.preTouch = key.preTouchMove = key.preTouchRelease = () => {};\r\n        key.touch = key.touchMove = key.touchRelease = () => {};\r\n      }\r\n\r\n      this.keys.push(key);\r\n      this.element.appendChild(container);\r\n\r\n    }\r\n    if (touch.exists) {\r\n      this.addTouchListeners();\r\n    }\r\n\r\n  }\r\n\r\n  sizeInterface() {\r\n\r\n    let keyX = 0;\r\n\r\n    let keyPositions = [];\r\n\r\n    for (let i=0;i<this.range.size;i++) {\r\n\r\n      keyPositions.push(keyX);\r\n\r\n      let scaleIndex = (i+this.range.low) % this.keyPattern.length;\r\n      let nextScaleIndex = (i+1+this.range.low) % this.keyPattern.length;\r\n      if (i+1+this.range.low >= this.range.high) {\r\n        keyX += 1;\r\n      } else if (this.keyPattern[scaleIndex] === 'w' && this.keyPattern[nextScaleIndex] === 'w') {\r\n        keyX += 1;\r\n      } else {\r\n        keyX += 0.5;\r\n      }\r\n    }\r\n    let keysWide = keyX;\r\n\r\n\r\n  //  let padding = this.width / 120;\r\n    let padding = 1;\r\n    let buttonWidth = (this.width-padding*2) / keysWide;\r\n    let buttonHeight = (this.height-padding*2) / 2;\r\n\r\n    for (let i=0;i<this.keys.length;i++) {\r\n\r\n      let container = this.keys[i].parent;\r\n      container.style.position = 'absolute';\r\n      container.style.left = (keyPositions[i]*buttonWidth+padding) + 'px';\r\n      if (this.keys[i].color === 'w') {\r\n        container.style.top = (padding) + 'px';\r\n        this.keys[i].resize(buttonWidth, buttonHeight*2);\r\n      } else {\r\n        container.style.zIndex = 1;\r\n        container.style.top = padding+'px';\r\n        this.keys[i].resize(buttonWidth, buttonHeight*1.1);\r\n      }\r\n\r\n    }\r\n\r\n  }\r\n\r\n  colorInterface() {\r\n\r\n    // Piano keys don't actually have a stroke border\r\n    // They have space between them, which shows the Piano bg color\r\n    this.element.style.backgroundColor = this.colors.mediumLight;\r\n\r\n    for (let i=0;i<this.keys.length;i++) {\r\n      this.keys[i].colors = {\r\n        'w': this.colors.light,\r\n        'b': this.colors.dark,\r\n        'accent': this.colors.accent,\r\n        'border': this.colors.mediumLight\r\n      };\r\n      this.keys[i].colorInterface();\r\n      this.keys[i].render();\r\n    }\r\n\r\n\r\n  }\r\n\r\n  keyChange(note,on) {\r\n    // emit data for any key turning on/off\r\n    // \"note\" is the note value\r\n    // \"on\" is a boolean whether it is on or off\r\n    // in aftertouch mode, \"on: is an object with state/x/y properties\r\n    var data = {\r\n      note: note\r\n    };\r\n    if (typeof on === 'object') {\r\n      data.state = on.state;\r\n    //  data.x = on.x\r\n    //  data.y = on.y\r\n    } else {\r\n      data.state = on;\r\n    }\r\n    this.emit('change',data);\r\n  }\r\n\r\n  /* drag(note,on) {\r\n    this.emit('change',{\r\n      note: note,\r\n      state: on\r\n    });\r\n  } */\r\n\r\n  render() {\r\n    // loop through and render the keys?\r\n  }\r\n\r\n  addTouchListeners() {\r\n    this.preClick = this.preMove = this.preRelease = () => {};\r\n    this.click = this.move = this.release = () => {};\r\n    this.preTouch = this.preTouchMove = this.preTouchRelease = () => {};\r\n    this.touch = this.touchMove = this.touchRelease = () => {};\r\n\r\n    const allActiveTouches = {};\r\n    const keys = this.keys;\r\n\r\n    function cloneTouch(touch) {\r\n      return { identifier: touch.identifier, clientX: touch.clientX, clientY: touch.clientY };\r\n    }\r\n\r\n    function updateKeyState() {\r\n      const allActiveKeys = {};\r\n\r\n      // Check/set \"key-down\" status for all keys that are currently touched.\r\n      Object.keys(allActiveTouches).forEach(id => {\r\n        const touch = allActiveTouches[id];\r\n        const el = document.elementFromPoint(touch.clientX, touch.clientY);\r\n        let key = el ? keys[el.index] : null;\r\n        if (key) {\r\n          allActiveKeys[el.index] = id;\r\n          if (!key.state) {\r\n            key.down();\r\n          }\r\n        } else {\r\n          delete allActiveTouches[id];\r\n        }\r\n      });\r\n\r\n      // Set \"key-up\" status for all keys that are untouched.\r\n      keys.forEach(key => {\r\n        if (key.state && !allActiveKeys[key.pad.index]) {\r\n          key.up();\r\n        }\r\n      });\r\n    }\r\n\r\n    function handleTouchStartAndMove(e) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      for (let i = 0; i < e.changedTouches.length; i++){\r\n        const touch = e.changedTouches[i];\r\n        allActiveTouches[touch.identifier] = cloneTouch(touch);\r\n      }\r\n      updateKeyState();\r\n    }\r\n\r\n    function handleTouchEnd(e) {\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      for (let i = 0; i < e.changedTouches.length; i++){\r\n        const touch = e.changedTouches[i];\r\n        delete allActiveTouches[touch.identifier];\r\n      }\r\n      updateKeyState();\r\n    }\r\n\r\n    this.element.addEventListener('touchstart', handleTouchStartAndMove);\r\n    this.element.addEventListener('touchmove', handleTouchStartAndMove);\r\n    this.element.addEventListener('touchend', handleTouchEnd);\r\n  }\r\n\r\n  /**\r\n  Define the pitch range (lowest and highest note) of the piano keyboard.\r\n  @param low {number} MIDI note value of the lowest note on the keyboard\r\n  @param high {number} MIDI note value of the highest note on the keyboard\r\n  */\r\n  setRange(low,high) {\r\n    this.range.low = low;\r\n    this.range.high = high;\r\n    this.empty();\r\n    this.buildInterface();\r\n  }\r\n\r\n  /**\r\n  Turn a key on or off using its MIDI note value;\r\n  @param note {number} MIDI note value of the key to change\r\n  @param on {boolean} Whether the note should turn on or off\r\n  */\r\n  toggleKey(note, on) {\r\n    this.keys[note-this.range.low].flip(on);\r\n  }\r\n\r\n  /**\r\n  Turn a key on or off using its key index on the piano interface.\r\n  @param index {number} Index of the key to change\r\n  @param on {boolean} Whether the note should turn on or off\r\n  */\r\n  toggleIndex(index, on) {\r\n    this.keys[index].flip(on);\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport math from '../util/math';\r\n\r\nexport default class Drunk {\r\n\r\n    constructor(min=0, max=9, value=0, increment=1, loop=false) {\r\n        this.min = min;\r\n        this.max = max;\r\n        this.value = value;\r\n        this.increment = increment;\r\n        this.loop = loop;\r\n    }\r\n\r\n    next() {\r\n        this.value += math.pick(-1 * this.increment, this.increment);\r\n        if (this.value > this.max) {\r\n            if (this.loop) {\r\n                this.value = this.min;\r\n            } else {\r\n                this.value = this.max - this.increment;\r\n            }\r\n        }\r\n\r\n        if (this.value < this.min) {\r\n            if (this.loop) {\r\n                this.value = this.max;\r\n            } else {\r\n                this.value = this.min + this.increment;\r\n            }\r\n        }\r\n        return this.value;\r\n    }\r\n}\r\n","'use strict';\r\n\r\nimport math from '../util/math';\r\nimport Drunk from './drunk';\r\n\r\nexport default class Sequence {\r\n\r\n    constructor(sequence = [0,10,20,30], mode='up', position=false) {\r\n        this.values = sequence;\r\n        if (!Array.isArray(this.values)) {\r\n          this.values = [this.values];\r\n        }\r\n        this._mode = mode;\r\n        this.position = position;\r\n\r\n        this.drunkWalk = new Drunk(0, this.values.length - 1);\r\n\r\n        this.startValues = {\r\n          'up': 0,\r\n          'down': this.values.length - 1,\r\n          'drunk': ~~(this.values.length/2),\r\n          'random': math.ri(this.values.length)\r\n        };\r\n\r\n        if (this.position!==false) {\r\n          this.next = this[this._mode];\r\n        } else {\r\n          this.next = this.first;\r\n        }\r\n\r\n\r\n    }\r\n\r\n    get mode() {\r\n      return this._mode;\r\n    }\r\n\r\n    set mode(mode) {\r\n        if (!(mode === 'up' || mode === 'down' || mode === 'random' || mode === 'drunk')) {\r\n            console.error('The only modes currently allowed are: up, down, random, drunk');\r\n            return;\r\n        }\r\n        this._mode = mode;\r\n        if (this.position) {\r\n          this.next = this[this._mode];\r\n        }\r\n    }\r\n\r\n    get value() {\r\n      return this.values[this.position];\r\n    }\r\n\r\n    set value(v) {\r\n      this.position = this.values.indexOf(v);\r\n    }\r\n\r\n    first() {\r\n      if (this.position!==false) {\r\n        this.next = this[this._mode];\r\n        return this.next();\r\n      }\r\n      this.position = this.startValues[this._mode];\r\n      this.next = this[this._mode];\r\n      return this.value;\r\n    }\r\n\r\n    up() {\r\n      this.position++;\r\n      this.position %= this.values.length;\r\n      return this.value;\r\n    }\r\n\r\n    down() {\r\n      this.position--;\r\n      if (this.position < 0) {\r\n        this.position = (this.position + this.values.length) % this.values.length;\r\n      }\r\n      return this.value;\r\n    }\r\n\r\n    random() {\r\n      this.position = math.ri(0, this.values.length);\r\n      return this.value;\r\n    }\r\n\r\n    drunk() {\r\n      this.drunkWalk.max = this.values.length;\r\n      this.drunkWalk.value = this.position;\r\n      this.position = this.drunkWalk.next();\r\n      return this.value;\r\n    }\r\n\r\n    /* future methods\r\n    .group(start,stop) -- outputs a group of n items from the list, with wrapping\r\n    .loop(start,stop) -- confines sequencing to a subset of the values\r\n        (could even have a distinction between .originalValues and the array of values being used)\r\n    */\r\n}\r\n","'use strict';\r\n\r\nimport math from '../util/math';\r\nimport Sequence from '../models/sequence';\r\n\r\n// For the tutorial, looking at\r\n\r\n//Pattern section:\r\n// .create(), .rows, .columns,\r\n// .pattern, .length, .formatAsText(), .log(),\r\n// .locate(i), .indexOf(c,r)\r\n// row(), column() (returns contents of row or colum)\r\n\r\n//Control section:\r\n// toggle x3\r\n// set x4\r\n// rotate x3\r\n// populate x3\r\n// erase x3\r\n\r\n\r\n// should some version of this have a float value for each cell?\r\n// could be like a mirror .pattern that has values. by default, everything is 1, but could be set...\r\n// not a good way to do that on interface, but as a model it would be nice...\r\n// for .formatAsText(), could multiply by 100 and floor, so each cell is an int from 0 to 9\r\n\r\nexport default class Matrix {\r\n\r\n  constructor(rows,columns) {\r\n    // should also have ability to create using an existing matrix (2d array)\r\n    this.pattern = [];\r\n    this.create(rows,columns);\r\n\r\n    this.toggle = {\r\n      cell: (column, row) => {\r\n        this.pattern[row][column] = !this.pattern[row][column]; // math.invert(this.pattern[row][column]);\r\n        if (this.ui) { this.ui.update(); }\r\n        return this.pattern[row][column];\r\n      },\r\n      all: () => {\r\n        this.iterate((r,c) => { this.toggle.cell(c,r); });\r\n        if (this.ui) { this.ui.update(); }\r\n      },\r\n      row: (row) => {\r\n        for (let i=0; i<this.columns; i++) {\r\n          this.toggle.cell(i,row);\r\n        }\r\n        if (this.ui) { this.ui.update(); }\r\n      },\r\n      column: (column) => {\r\n        for (let i=0; i<this.rows; i++) {\r\n          this.toggle.cell(column,i);\r\n        }\r\n        if (this.ui) { this.ui.update(); }\r\n      }\r\n    };\r\n\r\n    this.set = {\r\n      cell: (column, row, value) => {\r\n        this.pattern[row][column] = value;\r\n        if (this.ui) { this.ui.update(); }\r\n      },\r\n      all: (values) => {\r\n        // set the whole matrix using a 2d array as input\r\n        // this should also resize the array?\r\n        this.pattern = values;\r\n        if (this.ui) { this.ui.update(); }\r\n      },\r\n      row: (row,values) => {\r\n        // set a row using an array as input\r\n        this.pattern[row] = values;\r\n        if (this.ui) { this.ui.update(); }\r\n      },\r\n      column: (column,values) => {\r\n        // set a column using an array as input\r\n        this.pattern.forEach((row,i) => {\r\n          this.pattern[i][column] = values[i];\r\n        });\r\n        if (this.ui) { this.ui.update(); }\r\n      }\r\n    };\r\n\r\n    this.rotate = {\r\n      //should eventually do (amountX, amountY) here\r\n      // could just use a loop and this.rotate.row(i,amountX);\r\n      all: (amount) => {\r\n        if (!amount && amount!==0) {\r\n          amount = 1;\r\n        }\r\n        amount %= this.pattern[0].length;\r\n        if (amount < 0) {\r\n          amount = this.pattern[0].length + amount;\r\n        }\r\n        for (let i=0; i<this.rows; i++) {\r\n          let cut = this.pattern[i].splice( this.pattern[i].length - amount, amount );\r\n          this.pattern[i] = cut.concat( this.pattern[i] );\r\n        }\r\n        if (this.ui) { this.ui.update(); }\r\n      },\r\n      row: (row,amount) => {\r\n        if (!amount && amount!==0) {\r\n          amount = 1;\r\n        }\r\n        amount %= this.pattern[0].length;\r\n        if (amount < 0) {\r\n          amount = this.pattern[0].length + amount;\r\n        }\r\n        let cut = this.pattern[row].splice( this.pattern[row].length - amount, amount );\r\n        this.pattern[row] = cut.concat( this.pattern[row] );\r\n        if (this.ui) { this.ui.update(); }\r\n      },\r\n      column: (column, amount) => {\r\n        if (!amount && amount!==0) {\r\n          amount = 1;\r\n        }\r\n        amount %= this.pattern.length;\r\n        if (amount < 0) {\r\n          amount = this.pattern.length + amount;\r\n        }\r\n        let proxy = [];\r\n        this.pattern.forEach((row) => {\r\n          proxy.push( row[column] );\r\n        });\r\n        let cut = proxy.splice( proxy.length - amount, amount );\r\n        proxy = cut.concat( proxy );\r\n        this.pattern.forEach((row,i) => {\r\n          row[column] = proxy[i];\r\n        });\r\n        if (this.ui) { this.ui.update(); }\r\n      }\r\n    };\r\n\r\n    // the idea behind populate is to be able to set a whole row or column to 0 or 1\r\n    // IF the value is a float, such as 0.7, then it would become a probability\r\n    // so populate(0.7) would give each cell a 70% chance of being 1\r\n    this.populate = {\r\n      all: (odds) => {\r\n        let oddsSequence = new Sequence(odds);\r\n        this.iterate((r,c) => {\r\n          this.pattern[r][c] = math.coin(oddsSequence.next());\r\n        });\r\n        // This could be used so that each row has same odds pattern, even if row length is not divisibly by sequence length.\r\n        //,() => {\r\n        //  odds.pos = -1;\r\n        // }\r\n        if (this.ui) { this.ui.update(); }\r\n      },\r\n      row: (row=0,odds=1) => {\r\n        let oddsSequence = new Sequence(odds);\r\n        this.pattern[row].forEach((cell,i) => {\r\n          this.pattern[row][i] = math.coin(oddsSequence.next());\r\n        });\r\n        if (this.ui) { this.ui.update(); }\r\n      },\r\n      column: (column=0,odds=1) => {\r\n        let oddsSequence = new Sequence(odds);\r\n        this.pattern.forEach((row,i) => {\r\n          this.pattern[i][column] = math.coin(oddsSequence.next());\r\n        });\r\n        if (this.ui) { this.ui.update(); }\r\n      }\r\n    };\r\n\r\n    // essentiall populate(0) so i'm not sure if this is necessary but is nice\r\n    this.erase = {\r\n      all: () => {\r\n        this.set.all(0);\r\n      },\r\n      row: (row) => {\r\n        this.set.row(row,0);\r\n      },\r\n      column: (column) => {\r\n        this.set.column(column,0);\r\n      }\r\n    };\r\n\r\n  // end constructor\r\n  }\r\n\r\n\r\n  create(rows,columns) {\r\n    this.pattern = [];\r\n    for ( let row=0; row < rows; row++ ) {\r\n      let arr = new Array(columns);\r\n      this.pattern.push(arr);\r\n    }\r\n    this.iterate((r,c) => { this.pattern[r][c] = false; });\r\n  }\r\n\r\n  iterate(f, f2) {\r\n    let i = 0;\r\n    for ( let row=0; row < this.rows; row++ ) {\r\n      if (f2) { f2(row); }\r\n      for ( let column=0; column < this.columns; column++ ) {\r\n        f(row,column,i);\r\n        i++;\r\n      }\r\n    }\r\n  }\r\n\r\n  formatAsText() {\r\n    let patternString = '';\r\n    this.iterate(\r\n      (r,c) => { patternString += (this.pattern[r][c] ? 1 : 0) + ' '; },\r\n      () => { patternString += '\\n'; }\r\n    );\r\n    return patternString;\r\n  }\r\n\r\n  log() {\r\n    console.log(this.formatAsText());\r\n  }\r\n\r\n  update(pattern) {\r\n    this.pattern = pattern || this.pattern;\r\n  }\r\n\r\n  get length() {\r\n    return this.rows*this.columns;\r\n  }\r\n\r\n  locate(index) {\r\n    // returns row and column of cell by index\r\n    return {\r\n      row: ~~( index / this.columns ),\r\n      column: index % this.columns\r\n    };\r\n  }\r\n\r\n  indexOf(row,column) {\r\n    return column + row * this.columns;\r\n    // returns index of cell by row and column\r\n  }\r\n\r\n  row(row) {\r\n    let data = [];\r\n    for (let i=0; i<this.columns; i++) {\r\n      data.push(this.pattern[row] ? 1 : 0);\r\n    }\r\n    return data;\r\n  }\r\n\r\n  column(column) {\r\n    let data = [];\r\n    for (let i=0; i<this.rows; i++) {\r\n      data.push(this.pattern[i][column] ? 1 : 0);\r\n    }\r\n    return data;\r\n  }\r\n\r\n  get rows() {\r\n    return this.pattern.length;\r\n  }\r\n  set rows(v) {\r\n    let previous = this.pattern.slice(0);\r\n    this.create(v,this.columns);\r\n    this.iterate((r,c) => {\r\n      if (previous[r] && previous[r][c]) {\r\n        this.pattern[r][c] = previous[r][c];\r\n      }\r\n    });\r\n  }\r\n\r\n  get columns() {\r\n    return this.pattern[0].length;\r\n  }\r\n  set columns(v) {\r\n    let previous = this.pattern.slice(0);\r\n    this.create(this.rows,v);\r\n    this.iterate((r,c) => {\r\n      if (previous[r] && previous[r][c]) {\r\n        this.pattern[r][c] = previous[r][c];\r\n      }\r\n    });\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport math from '../util/math';\r\nimport Drunk from './drunk';\r\n\r\nexport default class Counter {\r\n\r\n    constructor(min=0, max=10, mode='up', value=false) {\r\n        this.min = min;\r\n        this.max = max;\r\n        this.value = value;\r\n        this.mode = mode;\r\n        this.drunkWalk = new Drunk(this.min, this.max);\r\n        if (this.value!==false) {\r\n          this.next = this[this._mode];\r\n        } else {\r\n          this.next = this.first;\r\n        }\r\n    }\r\n\r\n    set mode(mode) {\r\n        if (!(mode === 'up' || mode === 'down' || mode === 'random' || mode === 'drunk')) {\r\n            console.error('The only modes currently allowed are: up, down, random, drunk');\r\n            return;\r\n        }\r\n        this._mode = mode;\r\n        if (this.value) {\r\n          this.next = this[this._mode];\r\n        }\r\n    }\r\n\r\n    get mode() {\r\n        return this._mode;\r\n    }\r\n\r\n    first() {\r\n      if (this.value!==false) {\r\n        this.next = this[this._mode];\r\n        return this.next();\r\n      }\r\n      this.startValues = {\r\n        'up': this.min,\r\n        'down': this.max,\r\n        'drunk': ~~math.average(this.min,this.max),\r\n        'random': math.ri(this.min,this.max)\r\n      };\r\n      this.value = this.startValues[this._mode];\r\n      this.next = this[this._mode];\r\n      return this.value;\r\n    }\r\n\r\n    up() {\r\n        this.value++;\r\n        if (this.value >= this.max) {\r\n            this.value = this.min;\r\n        }\r\n        return this.value;\r\n    }\r\n\r\n    down() {\r\n        this.value--;\r\n        if (this.value < this.min) {\r\n            this.value = this.max;\r\n        }\r\n        return this.value;\r\n    }\r\n\r\n    random() {\r\n        this.value = math.ri(this.min, this.max);\r\n        return this.value;\r\n    }\r\n\r\n    drunk() {\r\n        this.drunkWalk.min = this.min;\r\n        this.drunkWalk.max = this.max;\r\n        this.drunkWalk.value = this.value;\r\n        this.value = this.drunkWalk.next();\r\n        return this.value;\r\n    }\r\n}\r\n","'use strict';\r\n\r\nimport { clock } from '../main';\r\n\r\nexport default class Interval {\r\n\r\n  constructor(rate,func,on) {\r\n\r\n    this.rate = rate;\r\n    this.on = on;\r\n    this.clock = clock(); // jshint ignore:line\r\n\r\n    this.pattern = [1];\r\n    this.index = 0;\r\n\r\n    this.event = func ? func : function() { };\r\n\r\n    if (this.on) {\r\n      this.start();\r\n    }\r\n\r\n  }\r\n\r\n  _event(e) {\r\n  //  if (this.pattern[this.index%this.pattern.length]) {\r\n      this.event(e);\r\n  //  }\r\n    this.index++;\r\n  }\r\n\r\n  stop() {\r\n    this.on = false;\r\n    this.interval.clear();\r\n  }\r\n\r\n  start() {\r\n    this.on = true;\r\n    this.interval = this.clock.callbackAtTime(this._event.bind(this), this.clock.context.currentTime).repeat(this.rate/1000).tolerance({early: 0.1, late:1});\r\n  }\r\n\r\n  ms(newrate) {\r\n    if (this.on) {\r\n      var ratio = newrate/this.rate;\r\n      this.rate = newrate;\r\n      this.clock.timeStretch(this.clock.context.currentTime, [this.interval], ratio);\r\n    } else {\r\n      this.rate = newrate;\r\n    }\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport svg from '../util/svg.js';\r\nimport dom from '../util/dom.js';\r\nimport Interface from '../core/interface.js';\r\nimport ButtonTemplate from '../components/buttontemplate.js';\r\nimport MatrixModel from '../models/matrix.js';\r\nimport CounterModel from '../models/counter.js';\r\nimport Interval from '../time/interval.js';\r\nimport touch from '../util/touch.js';\r\n\r\nclass MatrixCell extends ButtonTemplate {\r\n  constructor() {\r\n    let options = ['value'];\r\n\r\n    let defaults = {\r\n      size: [80, 80],\r\n      target: false,\r\n      mode: 'toggle',\r\n      value: 0,\r\n      paddingRow: 2,\r\n      paddingColumn: 2\r\n    };\r\n\r\n    super(arguments, options, defaults);\r\n\r\n    this.index = this.settings.index;\r\n    this.row = this.settings.row;\r\n    this.column = this.settings.column;\r\n\r\n    this.matrix = this.settings.matrix;\r\n\r\n    /**\r\n     *  Amount of row padding\r\n     *  @type {number}\r\n     */\r\n    this.paddingRow = this.settings.paddingRow || defaults.paddingRow;\r\n\r\n    /**\r\n     *  Amount of column padding\r\n     *  @type {number}\r\n     */\r\n    this.paddingColumn = this.settings.paddingColumn || defaults.paddingColumn;\r\n\r\n    this.interacting = false;\r\n    this.paintbrush = false;\r\n\r\n    this.init();\r\n    this.render();\r\n  }\r\n\r\n  buildFrame() {\r\n    this.element = svg.create('svg');\r\n    this.element.setAttribute('width', this.width);\r\n    this.element.setAttribute('height', this.height);\r\n    this.element.style.top = '0px';\r\n    this.element.style.left = '0px';\r\n    this.element.style.position = 'absolute';\r\n    this.parent.appendChild(this.element);\r\n  }\r\n\r\n  buildInterface() {\r\n    this.pad = svg.create('rect');\r\n    this.element.appendChild(this.pad);\r\n\r\n    this.interactionTarget = this.pad;\r\n\r\n    /* events */\r\n\r\n    if (!touch.exists) {\r\n      this.click = () => {\r\n        this.matrix.interacting = true;\r\n        this.matrix.paintbrush = !this.state;\r\n        this.down(this.matrix.paintbrush);\r\n      };\r\n      this.pad.addEventListener('mouseover', () => {\r\n        if (this.matrix.interacting) {\r\n          this.down(this.matrix.paintbrush);\r\n        }\r\n      });\r\n\r\n      this.move = () => {};\r\n      this.pad.addEventListener('mousemove', e => {\r\n        if (this.matrix.interacting) {\r\n          if (!this.offset) {\r\n            this.offset = dom.findPosition(this.element);\r\n          }\r\n          this.mouse = dom.locateMouse(e, this.offset);\r\n          this.bend();\r\n        }\r\n      });\r\n\r\n      this.release = () => {\r\n        this.matrix.interacting = false;\r\n      };\r\n      this.pad.addEventListener('mouseup', () => {\r\n        if (this.matrix.interacting) {\r\n          this.up();\r\n        }\r\n      });\r\n      this.pad.addEventListener('mouseout', () => {\r\n        if (this.matrix.interacting) {\r\n          this.up();\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  sizeInterface() {\r\n    this.pad.setAttribute('x', this.paddingColumn / 2);\r\n    this.pad.setAttribute('y', this.paddingRow / 2);\r\n    if (this.width > 2) {\r\n      this.pad.setAttribute('width', this.width - this.paddingColumn);\r\n    } else {\r\n      this.pad.setAttribute('width', this.width);\r\n    }\r\n    if (this.height > 2) {\r\n      this.pad.setAttribute('height', this.height - this.paddingRow);\r\n    } else {\r\n      this.pad.setAttribute('height', this.height);\r\n    }\r\n    this.pad.setAttribute('fill', this.matrix.colors.fill);\r\n  }\r\n\r\n  render() {\r\n    if (!this.state) {\r\n      this.pad.setAttribute('fill', this.matrix.colors.fill);\r\n    } else {\r\n      this.pad.setAttribute('fill', this.matrix.colors.accent);\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Sequencer\r\n *\r\n * @description Grid of buttons with built-in step sequencer.\r\n *\r\n * @demo <div nexus-ui=\"sequencer\" style=\"width:400px;height:200px;\"></div>\r\n *\r\n * @example\r\n * var sequencer = new Nexus.Sequencer('#target')\r\n *\r\n * @example\r\n * var sequencer = new Nexus.Sequencer('#target',{\r\n *  'size': [400,200],\r\n *  'mode': 'toggle',\r\n *  'rows': 5,\r\n *  'columns': 10,\r\n *  'paddingRow': 10,\r\n *  'paddingColumn': 20\r\n *})\r\n *\r\n * @output\r\n * change\r\n * Fires whenever a value is received. For example, when clicking a cell from off to on. <br>\r\n * The event data is an object containing <i>row</i> (number), <i>column</i> (number), and <i>state</i> (boolean) properties.\r\n *\r\n * @outputexample\r\n * sequencer.on('change',function(v) {\r\n *   console.log(v);\r\n * })\r\n *\r\n * @output\r\n * step\r\n * Fires any time the sequencer steps to the next column, in sequece mode. <br>\r\n * The event data is an <i>array</i> containing all values in the column, <i>bottom row first</i>.\r\n *\r\n * @outputexample\r\n * sequencer.on('step',function(v) {\r\n *   console.log(v);\r\n * })\r\n */\r\n\r\nexport default class Sequencer extends Interface {\r\n  constructor() {\r\n    let options = ['value'];\r\n\r\n    let defaults = {\r\n      size: [400, 200],\r\n      mode: 'toggle',\r\n      rows: 5,\r\n      columns: 10\r\n    };\r\n\r\n    super(arguments, options, defaults);\r\n\r\n    this.active = -1;\r\n\r\n    /**\r\n     * Button interaction mode: see Button\r\n     * @type {string}\r\n     * @example button.mode = 'toggle';\r\n     */\r\n    this.mode = this.settings.mode;\r\n\r\n    /**\r\n     * The interval object which controls timing and sequence scheduling.\r\n     * @type {interval}\r\n     */\r\n    this.interval = new Interval(200, function() {}, false); // jshint ignore:line\r\n\r\n    /**\r\n     * A Matrix model containing methods for manipulating the sequencer's array of values. To learn how to manipulate the matrix, read about the matrix model.\r\n     * @type {matrix}\r\n     */\r\n    this.matrix = new MatrixModel(this.settings.rows, this.settings.columns);\r\n    this.matrix.ui = this;\r\n\r\n    /**\r\n     * A Counter model which the sequencer steps through. For example, you could use this model to step through the sequencer in reverse, randomly, or in a drunk walk.\r\n     * @type {counter}\r\n     */\r\n    this.stepper = new CounterModel(0, this.columns);\r\n\r\n    this.paddingRow = this.settings.paddingRow;\r\n    this.paddingColumn = this.settings.paddingColumn;\r\n\r\n    this.init();\r\n  }\r\n\r\n  buildFrame() {\r\n    this.element = document.createElement('div');\r\n    this.element.style.position = 'relative';\r\n    this.element.style.display = 'block';\r\n    this.element.style.width = '100%';\r\n    this.element.style.height = '100%';\r\n    this.parent.appendChild(this.element);\r\n    if (touch.exists) {\r\n      this.addTouchListeners();\r\n    }\r\n  }\r\n\r\n  buildInterface() {\r\n    this.cells = [];\r\n    for (let i = 0; i < this.matrix.length; i++) {\r\n      let location = this.matrix.locate(i);\r\n      // returns {row,col}\r\n\r\n      let container = document.createElement('span');\r\n      container.style.position = 'absolute';\r\n\r\n      let cell = new MatrixCell(\r\n        container,\r\n        {\r\n          component: true,\r\n          index: i,\r\n          row: location.row,\r\n          column: location.column,\r\n          mode: this.mode,\r\n          matrix: this,\r\n          paddingRow: this.paddingRow,\r\n          paddingColumn: this.paddingColumn\r\n        },\r\n        this.keyChange.bind(this, i)\r\n      );\r\n\r\n      //  cell.matrix = this;\r\n      if (touch.exists) {\r\n        cell.pad.index = i;\r\n        cell.preClick = cell.preMove = cell.preRelease = () => {};\r\n        cell.click = cell.move = cell.release = () => {};\r\n        cell.preTouch = cell.preTouchMove = cell.preTouchRelease = () => {};\r\n        cell.touch = cell.touchMove = cell.touchRelease = () => {};\r\n      }\r\n\r\n      this.cells.push(cell);\r\n      this.element.appendChild(container);\r\n    }\r\n    this.sizeInterface();\r\n  }\r\n\r\n  sizeInterface() {\r\n    let cellWidth = this.width / this.columns;\r\n    let cellHeight = this.height / this.rows;\r\n\r\n    for (let i = 0; i < this.cells.length; i++) {\r\n      let container = this.cells[i].parent;\r\n      container.style.left = this.cells[i].column * cellWidth + 'px';\r\n      container.style.top = this.cells[i].row * cellHeight + 'px';\r\n      this.cells[i].resize(cellWidth, cellHeight);\r\n    }\r\n  }\r\n\r\n  colorInterface() {\r\n    for (var i = 0; i < this.cells.length; i++) {\r\n      this.cells[i].render();\r\n    }\r\n  }\r\n\r\n  update() {\r\n    //  console.log(\"updating...\")\r\n    //on = on || false;\r\n    this.matrix.iterate((r, c, i) => {\r\n      //  console.log(this.matrix.pattern[r][c], this.cells[i].state);\r\n      if (this.matrix.pattern[r][c] !== this.cells[i].state) {\r\n        if (this.matrix.pattern[r][c] > 0) {\r\n          this.cells[i].turnOn();\r\n        } else {\r\n          this.cells[i].turnOff();\r\n        }\r\n      }\r\n    });\r\n  }\r\n\r\n  // update => cell.turnOn => cell.emit => keyChange (seq.emit) => matrix.set.cell => update\r\n  //\r\n  // interaction => keyChange => matrix.set.cell => update => cell.turnOn\r\n  //                                             => emit\r\n  //\r\n  // set.cell => update => needs to emit.\r\n\r\n  keyChange(note, on) {\r\n    // emit data for any key turning on/off\r\n    // i is the note index\r\n    // v is whether it is on or off\r\n    let cell = this.matrix.locate(note);\r\n    //  this.matrix.set.cell(cell.column,cell.row,on);\r\n    this.matrix.pattern[cell.row][cell.column] = on;\r\n    var data = {\r\n      row: cell.row,\r\n      column: cell.column,\r\n      state: on\r\n    };\r\n    this.emit('change', data);\r\n  }\r\n\r\n  render() {\r\n    if (this.stepper.value >= 0) {\r\n      this.matrix.iterate((r, c, i) => {\r\n        if (c === this.stepper.value) {\r\n          this.cells[i].pad.setAttribute('stroke', this.colors.mediumLight);\r\n          this.cells[i].pad.setAttribute('stroke-width', '1');\r\n          this.cells[i].pad.setAttribute('stroke-opacity', '1');\r\n        } else {\r\n          this.cells[i].pad.setAttribute('stroke', 'none');\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Start sequencing\r\n   * @param  {number} ms Beat tempo in milliseconds\r\n   */\r\n  start(ms) {\r\n    this.interval.event = this.next.bind(this);\r\n    if (ms) {\r\n      this.interval.ms(ms);\r\n    }\r\n    this.interval.start();\r\n  }\r\n\r\n  /**\r\n  Stop sequencing\r\n  */\r\n  stop() {\r\n    this.interval.stop();\r\n  }\r\n\r\n  /**\r\n  Manually jump to the next column and trigger the 'change' event. The \"next\" column is determined by your mode of sequencing.\r\n  */\r\n  next() {\r\n    this.stepper.next();\r\n    this.emit('step', this.matrix.column(this.stepper.value).reverse());\r\n    this.render();\r\n  }\r\n\r\n  addTouchListeners() {\r\n    this.preClick = this.preMove = this.preRelease = () => {};\r\n    this.click = this.move = this.release = () => {};\r\n    this.preTouch = this.preTouchMove = this.preTouchRelease = () => {};\r\n    this.touch = this.touchMove = this.touchRelease = () => {};\r\n\r\n    this.currentElement = false;\r\n\r\n    this.element.addEventListener('touchstart', e => {\r\n      let element = document.elementFromPoint(\r\n        e.targetTouches[0].clientX,\r\n        e.targetTouches[0].clientY\r\n      );\r\n      let cell = this.cells[element.index];\r\n      this.paintbrush = !cell.state;\r\n      cell.down(this.paintbrush);\r\n      this.currentElement = element.index;\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    });\r\n\r\n    this.element.addEventListener('touchmove', e => {\r\n      let element = document.elementFromPoint(\r\n        e.targetTouches[0].clientX,\r\n        e.targetTouches[0].clientY\r\n      );\r\n      let cell = this.cells[element.index];\r\n      if (element.index !== this.currentElement) {\r\n        if (this.currentElement >= 0) {\r\n          let pastCell = this.cells[this.currentElement];\r\n          pastCell.up();\r\n        }\r\n        cell.down(this.paintbrush);\r\n      } else {\r\n        cell.bend();\r\n      }\r\n      this.currentElement = element.index;\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    });\r\n\r\n    this.element.addEventListener('touchend', e => {\r\n      // no touches to calculate because none remaining\r\n      let cell = this.cells[this.currentElement];\r\n      cell.up();\r\n      this.interacting = false;\r\n      this.currentElement = false;\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n    });\r\n  }\r\n\r\n  /**\r\n  Number of rows in the sequencer\r\n  @type {number}\r\n  */\r\n  get rows() {\r\n    return this.matrix.rows;\r\n  }\r\n\r\n  set rows(v) {\r\n    this.matrix.rows = v;\r\n    this.empty();\r\n    this.buildInterface();\r\n    this.update();\r\n  }\r\n\r\n  /**\r\n  Number of columns in the sequencer\r\n  @type {number}\r\n  */\r\n  get columns() {\r\n    return this.matrix.columns;\r\n  }\r\n\r\n  set columns(v) {\r\n    this.matrix.columns = v;\r\n    this.stepper.max = v;\r\n    this.empty();\r\n    this.buildInterface();\r\n    this.update();\r\n  }\r\n}\r\n","'use strict';\r\n\r\nimport svg from '../util/svg.js';\r\nimport math from '../util/math.js';\r\nimport Interface from '../core/interface.js';\r\nimport Step from '../models/step.js';\r\nimport * as Interaction from '../util/interaction';\r\n\r\n/**\r\n* Pan2D\r\n*\r\n* @description Interface for moving a sound around an array of speakers. Speaker locations can be customized. The interface calculates the closeness of the sound source to each speaker and returns that distance as a numeric value.\r\n*\r\n* @demo <span nexus-ui=\"pan2D\"></span>\r\n*\r\n* @example\r\n* var pan2d = new Nexus.Pan2d('#target')\r\n*\r\n* @example\r\n* var pan2d = new Nexus.Pan2D('#target',{\r\n*   'size': [200,200],\r\n*   'range': 0.5,  // detection radius of each speaker\r\n*   'mode': 'absolute',   // 'absolute' or 'relative' sound movement\r\n*   'speakers': [  // the speaker [x,y] positions\r\n*       [0.5,0.2],\r\n*       [0.75,0.25],\r\n*       [0.8,0.5],\r\n*       [0.75,0.75],\r\n*       [0.5,0.8],\r\n*       [0.25,0.75]\r\n*       [0.2,0.5],\r\n*       [0.25,0.25]\r\n*   ]\r\n* })\r\n*\r\n* @output\r\n* change\r\n* Fires any time the \"source\" node's position changes. <br>\r\n* The event data is an array of the amplitudes (0-1), representing the level of each speaker (as calculated by its distance to the audio source).\r\n*\r\n* @outputexample\r\n* pan2d.on('change',function(v) {\r\n*   console.log(v);\r\n* })\r\n*\r\n*/\r\n\r\nexport default class Pan2D extends Interface {\r\n\r\n  constructor() {\r\n\r\n    let options = ['range'];\r\n\r\n    let defaults = {\r\n      'size': [200,200],\r\n      'range': 0.5,\r\n      'mode': 'absolute',\r\n      'speakers': [\r\n        [0.5,0.2],\r\n        [0.75,0.25],\r\n        [0.8,0.5],\r\n        [0.75,0.75],\r\n        [0.5,0.8],\r\n        [0.25,0.75],\r\n        [0.2,0.5],\r\n        [0.25,0.25]\r\n      ]\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n    this.value = {\r\n      x: new Step(0,1,0,0.5),\r\n      y: new Step(0,1,0,0.5)\r\n    };\r\n\r\n    /**\r\n    Absolute or relative mouse interaction. In \"absolute\" mode, the source node will jump to your mouse position on mouse click. In \"relative\" mode, it does not.\r\n    */\r\n    this.mode = this.settings.mode;\r\n\r\n    this.position = {\r\n      x: new Interaction.Handle(this.mode,'horizontal',[0,this.width],[this.height,0]),\r\n      y: new Interaction.Handle(this.mode,'vertical',[0,this.width],[this.height,0])\r\n    };\r\n    this.position.x.value = this.value.x.normalized;\r\n    this.position.y.value = this.value.y.normalized;\r\n\r\n    /**\r\n    An array of speaker locations. Update this with .moveSpeaker() or .moveAllSpeakers()\r\n    */\r\n    this.speakers = this.settings.speakers;\r\n\r\n    /**\r\n    Rewrite: The maximum distance from a speaker that the source node can be for it to be heard from that speaker. A low range (0.1) will result in speakers only playing when the sound is very close it. Default is 0.5 (half of the interface).\r\n    */\r\n    this.range = this.settings.range;\r\n\r\n    /**\r\n    The current levels for each speaker. This is calculated when a source node or speaker node is moved through interaction or programatically.\r\n    */\r\n    this.levels = [];\r\n\r\n    this.init();\r\n\r\n    this.calculateLevels();\r\n    this.render();\r\n\r\n  }\r\n\r\n  buildInterface() {\r\n\r\n    this.knob = svg.create('circle');\r\n\r\n\r\n    this.element.appendChild(this.knob);\r\n\r\n\r\n    // add speakers\r\n    this.speakerElements = [];\r\n\r\n    for (let i=0;i<this.speakers.length;i++) {\r\n      let speakerElement = svg.create('circle');\r\n\r\n      this.element.appendChild(speakerElement);\r\n\r\n      this.speakerElements.push(speakerElement);\r\n    }\r\n\r\n  }\r\n\r\n  sizeInterface() {\r\n\r\n        this._minDimension = Math.min(this.width,this.height);\r\n\r\n        this.knobRadius = {\r\n          off: ~~(this._minDimension/100) * 3 + 5,\r\n        };\r\n        this.knobRadius.on = this.knobRadius.off * 2;\r\n\r\n        this.knob.setAttribute('cx',this.width/2);\r\n        this.knob.setAttribute('cy',this.height/2);\r\n        this.knob.setAttribute('r',this.knobRadius.off);\r\n\r\n        for (let i=0;i<this.speakers.length;i++) {\r\n          let speakerElement = this.speakerElements[i];\r\n          let speaker = this.speakers[i];\r\n          speakerElement.setAttribute('cx',speaker[0]*this.width);\r\n          speakerElement.setAttribute('cy',speaker[1]*this.height);\r\n          speakerElement.setAttribute('r',this._minDimension/20 + 5);\r\n          speakerElement.setAttribute('fill-opacity', '0');\r\n        }\r\n\r\n      this.position.x.resize([0,this.width],[this.height,0]);\r\n      this.position.y.resize([0,this.width],[this.height,0]);\r\n\r\n        // next, need to\r\n        // resize positions\r\n        // calculate speaker distances\r\n      this.calculateLevels();\r\n      this.render();\r\n\r\n  }\r\n\r\n  colorInterface() {\r\n\r\n    this.element.style.backgroundColor = this.colors.fill;\r\n    this.knob.setAttribute('fill', this.colors.mediumLight);\r\n\r\n    for (let i=0;i<this.speakers.length;i++) {\r\n      let speakerElement = this.speakerElements[i];\r\n      speakerElement.setAttribute('fill', this.colors.accent);\r\n      speakerElement.setAttribute('stroke', this.colors.accent);\r\n    }\r\n\r\n  }\r\n\r\n  render() {\r\n    this.knobCoordinates = {\r\n      x: this.value.x.normalized * this.width,\r\n      y: this.height - this.value.y.normalized * this.height\r\n    };\r\n\r\n    this.knob.setAttribute('cx',this.knobCoordinates.x);\r\n    this.knob.setAttribute('cy',this.knobCoordinates.y);\r\n  }\r\n\r\n\r\n  click() {\r\n    this.position.x.anchor = this.mouse;\r\n    this.position.y.anchor = this.mouse;\r\n    this.move();\r\n  }\r\n\r\n  move() {\r\n    if (this.clicked) {\r\n      this.position.x.update(this.mouse);\r\n      this.position.y.update(this.mouse);\r\n      // position.x and position.y are normalized\r\n      // so are the levels\r\n      // likely don't need this.value at all -- only used for drawing\r\n      // not going to be a 'step' or 'min' and 'max' in this one.\r\n      this.calculateLevels();\r\n      this.emit('change',this.levels);\r\n      this.render();\r\n    }\r\n  }\r\n\r\n  release() {\r\n    this.render();\r\n  }\r\n\r\n  get normalized() {\r\n    return {\r\n      x: this.value.x.normalized,\r\n      y: this.value.y.normalized\r\n    };\r\n  }\r\n\r\n  calculateLevels() {\r\n    this.value.x.updateNormal( this.position.x.value );\r\n    this.value.y.updateNormal( this.position.y.value );\r\n    this.levels = [];\r\n    this.speakers.forEach((s,i) => {\r\n      let distance = math.distance(s[0]*this.width,s[1]*this.height,this.position.x.value*this.width,(1-this.position.y.value)*this.height);\r\n      let level = math.clip(1-distance/(this.range*this.width),0,1);\r\n      this.levels.push(level);\r\n      this.speakerElements[i].setAttribute('fill-opacity', level);\r\n    });\r\n  }\r\n\r\n  /**\r\n  Move the audio source node and trigger the output event.\r\n  @param x {number} New x location, normalized 0-1\r\n  @param y {number} New y location, normalized 0-1\r\n  */\r\n  moveSource(x,y) {\r\n    let location = {\r\n      x: x*this.width,\r\n      y: y*this.height\r\n    };\r\n    this.position.x.update(location);\r\n    this.position.y.update(location);\r\n    this.calculateLevels();\r\n    this.emit('change',this.levels);\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  Move a speaker node and trigger the output event.\r\n  @param index {number} Index of the speaker to move\r\n  @param x {number} New x location, normalized 0-1\r\n  @param y {number} New y location, normalized 0-1\r\n  */\r\n  moveSpeaker(index,x,y) {\r\n\r\n    this.speakers[index] = [x,y];\r\n    this.speakerElements[index].setAttribute('cx', x*this.width);\r\n    this.speakerElements[index].setAttribute('cy', y*this.height);\r\n    this.calculateLevels();\r\n    this.emit('change',this.levels);\r\n    this.render();\r\n\r\n  }\r\n\r\n  /**\r\n  Set all speaker locations\r\n  @param locations {Array} Array of speaker locations. Each item in the array should be an array of normalized x and y coordinates.\r\n\r\n  setSpeakers(locations) {\r\n\r\n  }\r\n  */\r\n\r\n}\r\n","'use strict';\r\n\r\nimport math from '../util/math.js';\r\nimport svg from '../util/svg.js';\r\nimport Interface from '../core/interface.js';\r\n\r\n/**\r\n* Tilt\r\n*\r\n* @description Device tilt sensor with 2 or 3 axes (depending on your device and browser).\r\n*\r\n* @demo <span nexus-ui='tilt'></span>\r\n*\r\n* @example\r\n* var tilt = new Nexus.Tilt('#target')\r\n*\r\n* @output\r\n* change\r\n* Fires at a regular interval, as long as this interface is active (see the interface's <i>.active</i> property)<br>\r\n* The event data is an <i>object</i> containing x (number) and y (number) (and, potentially, z (number)) properties which represent the current tilt state of the device.\r\n*\r\n* @outputexample\r\n* tilt.on('change',function(v) {\r\n*   console.log(v);\r\n* })\r\n*\r\n*\r\n*/\r\n\r\nexport default class Tilt extends Interface {\r\n\r\n  constructor() {\r\n\r\n    let options = ['value'];\r\n\r\n    let defaults = {\r\n      'size': [80,80]\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n    this._active = true;\r\n\r\n    this.init();\r\n\r\n    // add event listener for device orientation\r\n\r\n  \tthis.boundUpdate = this.update.bind(this);\r\n  //\tthis.boundMozTilt = this.mozTilt.bind(this)\r\n\r\n  \tif (window.DeviceOrientationEvent) {\r\n  \t\tthis.orientationListener = window.addEventListener('deviceorientation', this.boundUpdate, false);\r\n  \t} else {\r\n      this._active = false;\r\n      this.colorInterface();\r\n    }\r\n\r\n\r\n\r\n      /*else if (window.OrientationEvent) {\r\n  //\t  \twindow.addEventListener('MozOrientation', this.boundMozTilt, false);\r\n  \t} else {\r\n  \t  \tconsole.log('Not supported on your device or browser.');\r\n  \t} */\r\n\r\n\r\n  }\r\n\r\n\r\n  buildInterface() {\r\n\r\n    this.title = svg.create('text');\r\n    this.circleX = svg.create('circle');\r\n    this.circleY = svg.create('circle');\r\n    this.circleZ = svg.create('circle');\r\n\r\n    this.barX = svg.create('path');\r\n    this.barY = svg.create('path');\r\n    this.barZ = svg.create('path');\r\n\r\n    this.barX2 = svg.create('path');\r\n    this.barY2 = svg.create('path');\r\n    this.barZ2 = svg.create('path');\r\n\r\n    this.barX.setAttribute('opacity','0.8');\r\n    this.barY.setAttribute('opacity','0.8');\r\n    this.barZ.setAttribute('opacity','0.8');\r\n    this.barX2.setAttribute('opacity','0.8');\r\n    this.barY2.setAttribute('opacity','0.8');\r\n    this.barZ2.setAttribute('opacity','0.8');\r\n\r\n    this.circleX.setAttribute('cx',this.width*3/12);\r\n    this.circleX.setAttribute('cy',this.height*3/4);\r\n    this.circleX.setAttribute('r',this.height/10);\r\n    this.circleX.setAttribute('opacity','0.4');\r\n\r\n    this.circleY.setAttribute('cx',this.width*6/12);\r\n    this.circleY.setAttribute('cy',this.height*3/4);\r\n    this.circleY.setAttribute('r',this.height/10);\r\n    this.circleY.setAttribute('opacity','0.4');\r\n\r\n    this.circleZ.setAttribute('cx',this.width*9/12);\r\n    this.circleZ.setAttribute('cy',this.height*3/4);\r\n    this.circleZ.setAttribute('r',this.height/10);\r\n    this.circleZ.setAttribute('opacity','0.4');\r\n\r\n\r\n    this.barX.setAttribute('stroke-width',Math.round(this.height/30));\r\n    this.barY.setAttribute('stroke-width',Math.round(this.height/30));\r\n    this.barZ.setAttribute('stroke-width',Math.round(this.height/30));\r\n\r\n    this.barX.setAttribute('fill', 'none');\r\n    this.barY.setAttribute('fill', 'none');\r\n    this.barZ.setAttribute('fill', 'none');\r\n\r\n    this.barX2.setAttribute('stroke-width',Math.round(this.height/30));\r\n    this.barY2.setAttribute('stroke-width',Math.round(this.height/30));\r\n    this.barZ2.setAttribute('stroke-width',Math.round(this.height/30));\r\n\r\n    this.barX2.setAttribute('fill', 'none');\r\n    this.barY2.setAttribute('fill', 'none');\r\n    this.barZ2.setAttribute('fill', 'none');\r\n\r\n\r\n    this.title.setAttribute('x',this.width/2);\r\n    this.title.setAttribute('y',this.height/3+7);\r\n    this.title.setAttribute('font-size','15px');\r\n    this.title.setAttribute('font-weight','bold');\r\n    this.title.setAttribute('letter-spacing','2px');\r\n    this.title.setAttribute('opacity','0.7');\r\n    this.title.setAttribute('text-anchor','middle');\r\n    this.title.textContent = 'TILT';\r\n\r\n\r\n    this.element.appendChild(this.circleX);\r\n    this.element.appendChild(this.circleY);\r\n    this.element.appendChild(this.circleZ);\r\n\r\n    this.element.appendChild(this.barX);\r\n    this.element.appendChild(this.barY);\r\n    this.element.appendChild(this.barZ);\r\n\r\n    this.element.appendChild(this.barX2);\r\n    this.element.appendChild(this.barY2);\r\n    this.element.appendChild(this.barZ2);\r\n\r\n    this.element.appendChild(this.title);\r\n\r\n  }\r\n\r\n  colorInterface() {\r\n\r\n    if (this._active) {\r\n      this.element.style.backgroundColor = this.colors.accent;\r\n      this.circleX.setAttribute('fill',this.colors.light);\r\n      this.circleY.setAttribute('fill',this.colors.light);\r\n      this.circleZ.setAttribute('fill',this.colors.light);\r\n      this.circleX.setAttribute('stroke',this.colors.light);\r\n      this.circleY.setAttribute('stroke',this.colors.light);\r\n      this.circleZ.setAttribute('stroke',this.colors.light);\r\n      this.barX.setAttribute('stroke',this.colors.light);\r\n      this.barY.setAttribute('stroke',this.colors.light);\r\n      this.barZ.setAttribute('stroke',this.colors.light);\r\n      this.barX2.setAttribute('stroke',this.colors.light);\r\n      this.barY2.setAttribute('stroke',this.colors.light);\r\n      this.barZ2.setAttribute('stroke',this.colors.light);\r\n      this.title.setAttribute('fill',this.colors.light);\r\n    } else {\r\n      this.element.style.backgroundColor = this.colors.fill;\r\n      this.circleX.setAttribute('fill',this.colors.mediumLight);\r\n      this.circleY.setAttribute('fill',this.colors.mediumLight);\r\n      this.circleZ.setAttribute('fill',this.colors.mediumLight);\r\n      this.circleX.setAttribute('stroke',this.colors.mediumLight);\r\n      this.circleY.setAttribute('stroke',this.colors.mediumLight);\r\n      this.circleZ.setAttribute('stroke',this.colors.mediumLight);\r\n      this.barX.setAttribute('stroke',this.colors.mediumLight);\r\n      this.barY.setAttribute('stroke',this.colors.mediumLight);\r\n      this.barZ.setAttribute('stroke',this.colors.mediumLight);\r\n      this.barX2.setAttribute('stroke',this.colors.mediumLight);\r\n      this.barY2.setAttribute('stroke',this.colors.mediumLight);\r\n      this.barZ2.setAttribute('stroke',this.colors.mediumLight);\r\n      this.title.setAttribute('fill',this.colors.mediumLight);\r\n    }\r\n\r\n  }\r\n\r\n  update(v) {\r\n    if (this._active){\r\n\r\n      let y = v.beta;\r\n      let x = v.gamma;\r\n      let z = v.alpha;\r\n\r\n      // take the original -90 to 90 scale and normalize it 0-1\r\n      x = math.scale(x,-90,90,0,1);\r\n      y = math.scale(y,-90,90,0,1);\r\n      z = math.scale(z,0,360,0,1);\r\n\r\n\r\n      let handlePoints = {\r\n        start: Math.PI*1.5,\r\n        end: math.clip( math.scale(x,0,0.5,Math.PI*1.5,Math.PI*0.5) , Math.PI*0.5, Math.PI*1.5 )\r\n      };\r\n      let handle2Points = {\r\n        start: Math.PI*2.5,\r\n        end: math.clip( math.scale(x,0.5,1,Math.PI*2.5,Math.PI*1.5) , Math.PI*1.5, Math.PI*2.5 )\r\n      };\r\n\r\n      let handlePath = svg.arc(this.circleX.cx.baseVal.value, this.circleX.cy.baseVal.value, this.circleX.r.baseVal.value, handlePoints.start, handlePoints.end);\r\n      let handle2Path = svg.arc(this.circleX.cx.baseVal.value, this.circleX.cy.baseVal.value, this.circleX.r.baseVal.value, handle2Points.start, handle2Points.end);\r\n\r\n      this.barX.setAttribute('d', handlePath);\r\n      this.barX2.setAttribute('d', handle2Path);\r\n\r\n\r\n\r\n\r\n\r\n      handlePoints = {\r\n        start: Math.PI*1.5,\r\n        end: math.clip( math.scale(y,0,0.5,Math.PI*1.5,Math.PI*0.5) , Math.PI*0.5, Math.PI*1.5 )\r\n      };\r\n      handle2Points = {\r\n        start: Math.PI*2.5,\r\n        end: math.clip( math.scale(y,0.5,1,Math.PI*2.5,Math.PI*1.5) , Math.PI*1.5, Math.PI*2.5 )\r\n      };\r\n\r\n      handlePath = svg.arc(this.circleY.cx.baseVal.value, this.circleY.cy.baseVal.value, this.circleY.r.baseVal.value, handlePoints.start, handlePoints.end);\r\n      handle2Path = svg.arc(this.circleY.cx.baseVal.value, this.circleY.cy.baseVal.value, this.circleY.r.baseVal.value, handle2Points.start, handle2Points.end);\r\n\r\n      this.barY.setAttribute('d', handlePath);\r\n      this.barY2.setAttribute('d', handle2Path);\r\n\r\n\r\n\r\n\r\n\r\n\r\n      handlePoints = {\r\n        start: Math.PI*1.5,\r\n        end: math.clip( math.scale(z,0,0.5,Math.PI*1.5,Math.PI*0.5) , Math.PI*0.5, Math.PI*1.5 )\r\n      };\r\n      handle2Points = {\r\n        start: Math.PI*2.5,\r\n        end: math.clip( math.scale(z,0.5,1,Math.PI*2.5,Math.PI*1.5) , Math.PI*1.5, Math.PI*2.5 )\r\n      };\r\n\r\n      handlePath = svg.arc(this.circleZ.cx.baseVal.value, this.circleZ.cy.baseVal.value, this.circleZ.r.baseVal.value, handlePoints.start, handlePoints.end);\r\n      handle2Path = svg.arc(this.circleZ.cx.baseVal.value, this.circleZ.cy.baseVal.value, this.circleZ.r.baseVal.value, handle2Points.start, handle2Points.end);\r\n\r\n      this.barZ.setAttribute('d', handlePath);\r\n      this.barZ2.setAttribute('d', handle2Path);\r\n\r\n\r\n      /*\r\n\r\n      let pointsX = {\r\n        start: 0,\r\n        end: math.scale( x, 0, 1, 0, Math.PI*2 )\r\n      };\r\n\r\n    //  console.log(this.circleX.cx.baseVal.value);\r\n\r\n      let pathX = svg.arc(this.circleX.cx.baseVal.value, this.circleX.cy.baseVal.value, this.circleX.r.baseVal.value*2, pointsX.start, pointsX.end);\r\n\r\n      this.barX.setAttribute('d',pathX); */\r\n\r\n      //this.textH.textContent = math.prune(x,2);\r\n      //this.textV.textContent = math.prune(y,2);\r\n      //\r\n    //  this.circleX.setAttribute('opacity',x);\r\n    //  this.circleY.setAttribute('opacity',y);\r\n    //  this.circleZ.setAttribute('opacity',z);\r\n\r\n      this.emit('change', {\r\n        x: x,\r\n        y: y,\r\n        z: z\r\n      });\r\n\r\n    }\r\n\r\n  }\r\n\r\n  click() {\r\n    if (window.DeviceOrientationEvent) {\r\n      this.active = !this.active;\r\n    }\r\n  }\r\n\r\n  /**\r\n  Whether the interface is on (emitting values) or off (paused & not emitting values). Setting this property will update it.\r\n  @type {boolean}\r\n  */\r\n\r\n  get active() {\r\n    return this._active;\r\n  }\r\n\r\n  set active(on) {\r\n    this._active = on;\r\n    this.colorInterface();\r\n  }\r\n\r\n  customDestroy() {\r\n    window.removeEventListener('deviceorientation', this.boundUpdate, false);\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport math from '../util/math.js';\r\nimport svg from '../util/svg.js';\r\nimport Interface from '../core/interface.js';\r\n\r\n/**\r\n * Multislider\r\n *\r\n * @description Multislider\r\n *\r\n * @demo <span nexus-ui=\"multislider\"></span>\r\n *\r\n * @example\r\n * var multislider = new Nexus.Multislider('#target')\r\n *\r\n * @example\r\n * var multislider = new Nexus.Multislider('#target',{\r\n *  'size': [200,100],\r\n *  'numberOfSliders': 5,\r\n *  'min': 0,\r\n *  'max': 1,\r\n *  'step': 0,\r\n *  'candycane': 3,\r\n *  'values': [0.9,0.8,0.7,0.6,0.5,0.4,0.3,0.2,0.1],\r\n *  'smoothing': 0,\r\n *  'mode': 'bar'  // 'bar' or 'line'\r\n *})\r\n *\r\n * @output\r\n * change\r\n * Fires any time the interface's value changes. <br>\r\n * The event data is an object containing <i>index</i> and <i>value</i> properties\r\n *\r\n * @outputexample\r\n * multislider.on('change',function(v) {\r\n *   console.log(v);\r\n * })\r\n *\r\n */\r\n\r\nexport default class Multislider extends Interface {\r\n  constructor() {\r\n    let options = ['value'];\r\n\r\n    let defaults = {\r\n      size: [200, 100],\r\n      numberOfSliders: 5,\r\n      min: 0,\r\n      max: 1,\r\n      step: 0,\r\n      candycane: 3,\r\n      values: [0.9, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.1],\r\n      smoothing: 0,\r\n      mode: 'bar' // 'bar', 'line'\r\n    };\r\n\r\n    super(arguments, options, defaults);\r\n\r\n    this._numberOfSliders = this.settings.numberOfSliders;\r\n    this._min = this.settings.min;\r\n    this._max = this.settings.max;\r\n    this._step = this.settings.step;\r\n\r\n    this._mode = this.settings.mode;\r\n\r\n    /**\r\n    The current values of the slider. NOTE: Use this only to get the current values. Setting this array will not update the multislider. To set the multislider's values, use setSlider() or setAllSliders()\r\n    @type {Array}\r\n    */\r\n    const vs = this.settings.values;\r\n    this.values = vs.length > this._numberOfSliders ? vs.slice(0, this._numberOfSliders) : vs.concat(Array(this._numberOfSliders - vs.length).fill(0));\r\n\r\n    this.candycane = this.settings.candycane;\r\n\r\n    this.sliderWidth = this.width / this.values.length;\r\n\r\n    /**\r\n    Applies a simple low-pass filter to the multislider as it is interacted with. A smoothing of 0 will be no smoothing. A smoothing of 1 will smooth 1 slider on each side of the interaction. A smoothing of 2 will smooth 2 sliders on each side, and so on.\r\n    @type {Number}\r\n    */\r\n    this.smoothing = this.settings.smoothing;\r\n\r\n    this.init();\r\n    this.render();\r\n  }\r\n\r\n  buildInterface() {\r\n    if (this._mode == 'line') {\r\n      this.line = svg.create('polyline');\r\n      this.line.setAttribute('stroke-width', 2);\r\n      this.line.setAttribute('fill', 'none');\r\n\r\n      this.element.appendChild(this.line);\r\n\r\n      this.fill = svg.create('polyline');\r\n      this.fill.setAttribute('fill-opacity', '0.2');\r\n\r\n      this.element.appendChild(this.fill);\r\n\r\n      this.nodes = [];\r\n\r\n      this.values.forEach(\r\n        function(value, index) {\r\n          let node = svg.create('circle');\r\n\r\n          node.setAttribute('cx', this.getX(index));\r\n          node.setAttribute('cy', this.getY(value));\r\n\r\n          this.element.appendChild(node);\r\n          this.nodes.push(node);\r\n        }.bind(this)\r\n      );\r\n    } else {\r\n      this.bars = [];\r\n      this.caps = [];\r\n\r\n      this.values.forEach(\r\n        function(value, index) {\r\n          let bar = svg.create('rect');\r\n\r\n          let x = this.getBarX(index);\r\n          let y = this.getY(value);\r\n\r\n          bar.setAttribute('x', x - 0.1);\r\n          bar.setAttribute('y', y);\r\n          bar.setAttribute('width', this.sliderWidth + 0.2);\r\n          bar.setAttribute('height', this.height);\r\n          bar.setAttribute(\r\n            'opacity',\r\n            1 - ((index % this.candycane) + 1) / (this.candycane + 1)\r\n          );\r\n\r\n          this.element.appendChild(bar);\r\n          this.bars.push(bar);\r\n\r\n          let cap = svg.create('rect');\r\n\r\n          cap.setAttribute('x', x - 0.1);\r\n          cap.setAttribute('y', y);\r\n          cap.setAttribute('width', this.sliderWidth + 0.2);\r\n          cap.setAttribute('height', 5);\r\n\r\n          this.element.appendChild(cap);\r\n          this.caps.push(cap);\r\n        }.bind(this)\r\n      );\r\n    }\r\n  }\r\n\r\n  getBarX(index) {\r\n    return this.getX(index) - this.sliderWidth / 2;\r\n  }\r\n\r\n  getX(index) {\r\n    //return Math.floor( index * this.sliderWidth + this.sliderWidth/2 );\r\n    return index * this.sliderWidth + this.sliderWidth / 2;\r\n  }\r\n\r\n  getY(value) {\r\n    return math.scale(value, this._min, this._max, this.height, 0); //(1 - value) * this.height;\r\n  }\r\n\r\n  getValueFromY(y) {\r\n    let scaleAdjusted = math.scale(y, this.height, 0, this._min, this._max);\r\n    return this.adjustValueToStep(scaleAdjusted);\r\n  }\r\n\r\n  getIndexFromX(x) {\r\n    return math.clip(\r\n      Math.floor((x / this.width) * this.values.length),\r\n      0,\r\n      this.values.length - 1\r\n    );\r\n  }\r\n\r\n  adjustValueToStep(value) {\r\n    if (!this._step) {\r\n      return value;\r\n    }\r\n    let offset = value % this._step;\r\n    value = value - (value % this._step);\r\n    if (offset > this._step / 2) {\r\n      value += this._step;\r\n    }\r\n    return value;\r\n  }\r\n\r\n  adjustAllValues() {\r\n    this.values.forEach(\r\n      function(value, index) {\r\n        value = this.adjustValueToStep(value);\r\n        this.values[index] = math.clip(value, this._min, this._max);\r\n      }.bind(this)\r\n    );\r\n  }\r\n\r\n  getNormalizedValues() {\r\n    this.normalizedValues = [];\r\n    this.values.forEach(\r\n      function(value) {\r\n        this.normalizedValues.push(\r\n          math.scale(value, this._min, this._max, 0, 1)\r\n        );\r\n      }.bind(this)\r\n    );\r\n  }\r\n\r\n  colorInterface() {\r\n    this.element.style.backgroundColor = this.colors.fill;\r\n\r\n    if (this._mode == 'line') {\r\n      this.line.setAttribute('stroke', this.colors.accent);\r\n      this.fill.setAttribute('fill', this.colors.accent);\r\n      this.nodes.forEach(node => {\r\n        node.setAttribute('fill', this.colors.accent);\r\n      });\r\n    } else {\r\n      this.bars.forEach(bar => {\r\n        bar.setAttribute('fill', this.colors.accent);\r\n      });\r\n      this.caps.forEach(cap => {\r\n        cap.setAttribute('fill', this.colors.accent);\r\n      });\r\n    }\r\n  }\r\n\r\n  sizeInterface() {\r\n    this.sliderWidth = this.width / this.values.length;\r\n\r\n    if (this._mode == 'line') {\r\n      this.nodes.forEach(\r\n        function(node) {\r\n          let r = ~~(Math.min(this.width, this.height) / 50) + 2;\r\n          r = Math.min(this.sliderWidth, r);\r\n          node.setAttribute('r', r);\r\n        }.bind(this)\r\n      );\r\n    }\r\n\r\n    this.render();\r\n  }\r\n\r\n  render() {\r\n    if (this._mode == 'line') {\r\n      let data = '0 ' + this.getY(this.values[0]) + ', ';\r\n\r\n      this.values.forEach((value, index) => {\r\n        let x = this.getX(index);\r\n        let y = this.getY(value);\r\n        data += x + ' ' + y + ', ';\r\n        this.nodes[index].setAttribute('cx', this.getX(index));\r\n        this.nodes[index].setAttribute('cy', this.getY(value));\r\n      });\r\n\r\n      data += this.width + ' ' + this.getY(this.values[this.values.length - 1]);\r\n\r\n      this.line.setAttribute('points', data);\r\n\r\n      // fill data\r\n      // add bottom corners\r\n\r\n      data += ', ' + this.width + ' ' + this.height + ', ';\r\n      data += '0 ' + this.height;\r\n\r\n      this.fill.setAttribute('points', data);\r\n    } else {\r\n      this.values.forEach((value, index) => {\r\n        this.bars[index].setAttribute('y', this.getY(value));\r\n        this.caps[index].setAttribute('y', this.getY(value));\r\n      });\r\n    }\r\n  }\r\n\r\n  click() {\r\n    this.hasMoved = false;\r\n    this.previousSlider = false;\r\n    this.move();\r\n  }\r\n\r\n  move() {\r\n    if (this.clicked) {\r\n      this.mouse.x = math.clip(this.mouse.x, 0, this.width);\r\n      this.mouse.y = math.clip(this.mouse.y, 0, this.height);\r\n      this.hasMoved = true;\r\n\r\n      this.selectedSlider = this.getIndexFromX(this.mouse.x);\r\n\r\n      this.values[this.selectedSlider] = this.getValueFromY(this.mouse.y);\r\n\r\n      /* handle interpolation for in-between sliders */\r\n\r\n      if (this.previousSlider !== false) {\r\n        let distance = Math.abs(this.previousSlider - this.selectedSlider);\r\n        if (distance > 1) {\r\n          let low = Math.min(this.previousSlider, this.selectedSlider);\r\n          let high = Math.max(this.previousSlider, this.selectedSlider);\r\n          let lowValue = this.values[low];\r\n          let highValue = this.values[high];\r\n          for (let i = low; i < high; i++) {\r\n            this.values[i] = math.interp(\r\n              (i - low) / distance,\r\n              lowValue,\r\n              highValue\r\n            );\r\n            this.values[i] = this.adjustValueToStep(this.values[i]);\r\n          }\r\n        }\r\n      }\r\n\r\n      if (this.smoothing > 0) {\r\n        for (var i = 1; i <= this.smoothing; i++) {\r\n          let downCenter = this.selectedSlider - i;\r\n          let upCenter = this.selectedSlider + i;\r\n\r\n          if (downCenter >= 1) {\r\n            let downLowerNeighbor = downCenter - 1 >= 0 ? downCenter - 1 : 0;\r\n            let downUpperNeighbor = downCenter + 1;\r\n            this.values[downCenter] =\r\n              (this.values[downLowerNeighbor] +\r\n                this.values[downUpperNeighbor]) /\r\n              2;\r\n            this.values[downCenter] = this.adjustValueToStep(\r\n              this.values[downCenter]\r\n            );\r\n          }\r\n\r\n          if (upCenter < this.values.length - 1) {\r\n            let upLowerNeighbor = upCenter - 1;\r\n            let upUpperNeighbor = upCenter + 1 < this.values.length ? upCenter + 1 : this.values.length - 1;\r\n            this.values[upCenter] =\r\n              (this.values[upLowerNeighbor] + this.values[upUpperNeighbor]) / 2;\r\n            this.values[upCenter] = this.adjustValueToStep(\r\n              this.values[upCenter]\r\n            );\r\n          }\r\n        }\r\n      }\r\n\r\n      this.previousSlider = this.selectedSlider;\r\n\r\n      this.emit('change', this.values);\r\n      this.render();\r\n    }\r\n  }\r\n\r\n  // would be a cool API call to have for later...\r\n  scan() {}\r\n\r\n  update(index, value) {\r\n    this.values[index] = this.adjustValueToStep(value);\r\n    this.emit('change', {\r\n      index: index,\r\n      value: value\r\n    });\r\n  }\r\n\r\n  /**\r\n  Get the number of sliders\r\n  @type {Number}\r\n  */\r\n  get numberOfSliders() {\r\n    return this.values.length;\r\n  }\r\n\r\n  /**\r\n  Lower limit of the multislider's output range\r\n  @type {number}\r\n  @example multislider.min = 1000;\r\n  */\r\n  get min() {\r\n    return this._min;\r\n  }\r\n  set min(v) {\r\n    this._min = v;\r\n    this.adjustAllValues();\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  Upper limit of the multislider's output range\r\n  @type {number}\r\n  @example multislider.max = 1000;\r\n  */\r\n  get max() {\r\n    return this._max;\r\n  }\r\n  set max(v) {\r\n    this._max = v;\r\n    this.adjustAllValues();\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  The increment that the multislider's value changes by.\r\n  @type {number}\r\n  @example multislider.step = 5;\r\n  */\r\n  get step() {\r\n    return this._step;\r\n  }\r\n  set step(v) {\r\n    this._step = v;\r\n    this.adjustAllValues();\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  Set the value of an individual slider\r\n  @param index {number} Slider index\r\n  @param value {number} New slider value\r\n  @example\r\n  // Set the first slider to value 0.5\r\n  multislider.setSlider(0,0.5)\r\n  */\r\n  setSlider(index, value) {\r\n    this.values[index] = this.adjustValueToStep(value);\r\n    this.values[index] = math.clip(this.values[index], this._min, this._max);\r\n    this.emit('change', {\r\n      index: index,\r\n      value: value\r\n    });\r\n  }\r\n\r\n  /**\r\n  Set the value of all sliders at once. If the size of the input array does not match the current number of sliders, the value array will repeat until all sliders have been set. I.e. an input array of length 1 will set all sliders to that value.\r\n  @param values {Array} All slider values\r\n  @example\r\n  multislider.setAllSliders([0.2,0.3,0.4,0.5,0.6])\r\n  */\r\n  setAllSliders(values) {\r\n    let previousLength = this.values.length;\r\n    let newLength = values.length;\r\n    this.values = values;\r\n    this.adjustAllValues();\r\n    if (previousLength != newLength) {\r\n      this.empty();\r\n      this.buildInterface();\r\n      this.colorInterface();\r\n    }\r\n    this.sizeInterface();\r\n  }\r\n}\r\n","'use strict';\r\n\r\nimport svg from '../util/svg.js';\r\nimport math from '../util/math.js';\r\nimport Interface from '../core/interface.js';\r\nimport Step from '../models/step.js';\r\nimport * as Interaction from '../util/interaction';\r\n\r\n/**\r\n* Pan\r\n*\r\n* @description Stereo crossfader.\r\n*\r\n* @demo <span nexus-ui=\"pan\"></span>\r\n*\r\n* @example\r\n* var pan = new Nexus.Pan('#target')\r\n*\r\n* @output\r\n* change\r\n* Fires any time the interface's value changes. <br>\r\n* The event data is an object containing the interface's <i>value</i> (-1 to 1), as well as <i>L</i> and <i>R</i> amplitude values (0-1) for left and right speakers, calculated by a square-root crossfade algorithm.\r\n*\r\n* @outputexample\r\n* pan.on('change',function(v) {\r\n*   console.log(v);\r\n* })\r\n*\r\n*\r\n*/\r\n\r\nexport default class Pan extends Interface {\r\n\r\n  constructor() {\r\n\r\n    let options = ['scale','value'];\r\n\r\n    let defaults = {\r\n      'size': [120,20],\r\n      'orientation': 'horizontal',\r\n      'mode': 'relative',\r\n      'scale': [-1,1],\r\n      'step': 0,\r\n      'value': 0,\r\n      'hasKnob': true\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n    this.orientation = this.settings.orientation;\r\n\r\n    this.mode = this.settings.mode;\r\n\r\n    this.hasKnob = this.settings.hasKnob;\r\n\r\n    // this.step should eventually be get/set\r\n    // updating it will update the _value step model\r\n    this.step = this.settings.step; // float\r\n\r\n    this._value = new Step(this.settings.scale[0], this.settings.scale[1], this.settings.step, this.settings.value);\r\n\r\n    this.init();\r\n\r\n    this.position = new Interaction.Handle(this.mode,this.orientation,[0,this.width],[this.height,0]);\r\n    this.position.value = this._value.normalized;\r\n\r\n    this.value = this._value.value;\r\n\r\n    this.emit('change',this.value);\r\n\r\n  }\r\n\r\n  buildInterface() {\r\n\r\n    this.bar = svg.create('rect');\r\n    this.knob = svg.create('circle');\r\n\r\n    this.element.appendChild(this.bar);\r\n    this.element.appendChild(this.knob);\r\n\r\n  }\r\n\r\n  sizeInterface() {\r\n\r\n    if (this.position) {\r\n      this.position.resize([0,this.width],[this.height,0]);\r\n    }\r\n\r\n    if (this.width < this.height) {\r\n      this.orientation = 'vertical';\r\n    } else {\r\n      this.orientation = 'horizontal';\r\n    }\r\n\r\n    let x, y, w, h, barOffset, cornerRadius;\r\n    this.knobData = {\r\n      level: 0,\r\n      r: 0\r\n    };\r\n\r\n    if (this.orientation === 'vertical') {\r\n      this.thickness = this.width / 2;\r\n    \tx = this.width/2;\r\n    \ty = 0;\r\n    \tw = this.thickness;\r\n    \th = this.height;\r\n      this.knobData.r = this.thickness * 0.8;\r\n    \tthis.knobData.level = h-this.knobData.r-this.normalized*(h-this.knobData.r*2);\r\n      barOffset = 'translate('+this.thickness*(-1)/2+',0)';\r\n      cornerRadius = w/2;\r\n    } else {\r\n      this.thickness = this.height / 2;\r\n    \tx = 0;\r\n    \ty = this.height/2;\r\n    \tw = this.width;\r\n    \th = this.thickness;\r\n      this.knobData.r = this.thickness * 0.8;\r\n    \tthis.knobData.level = this.normalized*(w-this.knobData.r*2)+this.knobData.r;\r\n      barOffset = 'translate(0,'+this.thickness*(-1)/2+')';\r\n      cornerRadius = h/2;\r\n    }\r\n\r\n    this.bar.setAttribute('x',x);\r\n    this.bar.setAttribute('y',y);\r\n    this.bar.setAttribute('transform',barOffset);\r\n    this.bar.setAttribute('rx',cornerRadius); // corner radius\r\n    this.bar.setAttribute('ry',cornerRadius);\r\n    this.bar.setAttribute('width',w);\r\n    this.bar.setAttribute('height',h);\r\n\r\n    if (this.orientation === 'vertical') {\r\n      this.knob.setAttribute('cx',x);\r\n      this.knob.setAttribute('cy',this.knobData.level);\r\n    } else {\r\n      this.knob.setAttribute('cx',this.knobData.level);\r\n      this.knob.setAttribute('cy',y);\r\n    }\r\n    this.knob.setAttribute('r',this.knobData.r);\r\n\r\n  }\r\n\r\n  colorInterface() {\r\n\r\n    this.bar.setAttribute('fill', this.colors.fill);\r\n    this.knob.setAttribute('fill', this.colors.accent);\r\n\r\n    if (!this.hasKnob) {\r\n      this.knob.setAttribute('fill','transparent');\r\n    }\r\n\r\n  }\r\n\r\n  render() {\r\n    if (!this.clicked) {\r\n      this.knobData.r = this.thickness*0.75;\r\n    }\r\n    this.knob.setAttribute('r',this.knobData.r);\r\n\r\n    if (this.orientation === 'vertical') {\r\n  \t   this.knobData.level = this.knobData.r+this._value.normalized*(this.height-this.knobData.r*2);\r\n       this.knob.setAttribute('cy',this.height - this.knobData.level);\r\n    } else {\r\n  \t   this.knobData.level = this._value.normalized*(this.width-this.knobData.r*2)+this.knobData.r;\r\n       this.knob.setAttribute('cx',this.knobData.level);\r\n    }\r\n  }\r\n\r\n\r\n  click() {\r\n    this.knobData.r = this.thickness*0.9;\r\n    this.position.anchor = this.mouse;\r\n    this.move();\r\n  }\r\n\r\n  move() {\r\n    if (this.clicked) {\r\n      this.position.update(this.mouse);\r\n\r\n      this.value = this._value.updateNormal( this.position.value );\r\n\r\n      this.emit('change',{\r\n        value: this.value,\r\n        L: Math.pow( math.scale(this.value,-1,1,1,0), 2),\r\n        R: Math.pow( math.scale(this.value,-1,1,0,1), 2)\r\n      });\r\n\r\n    }\r\n  }\r\n\r\n  release() {\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  The position of crossfader, from -1 (left) to 1 (right). Setting this value updates the interface and triggers the output event.\r\n  @type {number}\r\n  */\r\n  get value() {\r\n    return this._value.value;\r\n  }\r\n\r\n  set value(value) {\r\n    this._value.update(value);\r\n    this.position.value = this._value.normalized;\r\n    this.emit('change',{\r\n      value: this.value,\r\n      L: Math.pow( math.scale(this.value,-1,1,1,0), 2),\r\n      R: Math.pow( math.scale(this.value,-1,1,0,1), 2)\r\n    });\r\n    this.render();\r\n  }\r\n\r\n  get normalized() {\r\n    return this._value.normalized;\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport math from '../util/math.js';\r\nimport svg from '../util/svg.js';\r\nimport Interface from '../core/interface.js';\r\n\r\n\r\nlet Point = function(point,envelope) {\r\n\r\n  this.x = point.x;\r\n  this.y = point.y;\r\n\r\n  this.xMin = point.xMin || 0;\r\n  this.xMax = point.xMax || 1;\r\n  this.yMin = point.yMin || 0;\r\n  this.yMax = point.yMax || 1;\r\n\r\n  this.envelope = envelope;\r\n\r\n  this.element = svg.create('circle');\r\n  this.element.setAttribute('fill',this.envelope.colors.accent);\r\n\r\n  this.envelope.element.appendChild(this.element);\r\n\r\n  this.resize = function() {\r\n    let r = ~~(Math.min(this.envelope.width,this.envelope.height)/50)+2;\r\n    this.element.setAttribute('r',r);\r\n  };\r\n\r\n  this.move = function(x,y) {\r\n\r\n    this.x = (x || x===0) ? x : this.x;\r\n    this.y = (y || y===0) ? y : this.y;\r\n\r\n    if (this.envelope.nodes.indexOf(this)>=0) {\r\n\r\n      let prevIndex = this.envelope.nodes.indexOf(this)-1;\r\n      let nextIndex = this.envelope.nodes.indexOf(this)+1;\r\n\r\n      let prevNode = this.envelope.nodes[prevIndex];\r\n      let nextNode = this.envelope.nodes[nextIndex];\r\n\r\n      let lowX = prevIndex >= 0 ? prevNode.x : 0;\r\n\t    lowX = lowX<this.xMin?this.xMin:lowX;\r\n\r\n      let highX = nextIndex < this.envelope.nodes.length ? nextNode.x : 1;\r\n\t    highX = highX>this.xMax?this.xMax:highX;\r\n\r\n  \t  if (this.x < lowX) { this.x = lowX; }\r\n      if (this.x > highX) { this.x = highX; }\r\n\r\n      if (this.y < this.yMin) { this.y = this.yMin; }\r\n      if (this.y > this.yMax) { this.y = this.yMax; }\r\n\r\n    }\r\n\r\n    this.location = this.getCoordinates();\r\n    this.element.setAttribute('cx', this.location.x);\r\n    this.element.setAttribute('cy', this.location.y);\r\n  };\r\n\r\n  this.getCoordinates = function() {\r\n    return {\r\n      x: this.x * this.envelope.width,\r\n      y: (1-this.y) * this.envelope.height\r\n    };\r\n  };\r\n\r\n  this.move(this.x,this.y,true);\r\n  this.resize();\r\n\r\n  this.destroy = function() {\r\n    this.envelope.element.removeChild(this.element);\r\n    this.envelope.nodes.splice(this.envelope.nodes.indexOf(this),1);\r\n  };\r\n\r\n\r\n};\r\n\r\n\r\n/**\r\n* Envelope\r\n*\r\n* @description Interactive linear ramp visualization.\r\n*\r\n* @demo <span nexus-ui=\"envelope\"></span>\r\n*\r\n* @example\r\n* var envelope = new Nexus.Envelope('#target')\r\n*\r\n* @example\r\n* var envelope = new Nexus.Envelope('#target',{\r\n*   'size': [300,150],\r\n*   'noNewPoints': false,\r\n*   'points': [\r\n*     {\r\n*       x: 0.1,\r\n*       y: 0.4\r\n*     },\r\n*     {\r\n*       x: 0.35,\r\n*       y: 0.6\r\n*     },\r\n*     {\r\n*       x: 0.65,\r\n*       y: 0.2\r\n*     },\r\n*     {\r\n*       x: 0.9,\r\n*       y: 0.4\r\n*     },\r\n*   ]\r\n* })\r\n*\r\n* @output\r\n* change\r\n* Fires any time a node is moved. <br>\r\n* The event data is an array of point locations. Each item in the array is an object containing <i>x</i> and <i>y</i> properties describing the location of a point on the envelope.\r\n*\r\n* @outputexample\r\n* envelope.on('change',function(v) {\r\n*   console.log(v);\r\n* })\r\n*\r\n*/\r\n\r\nexport default class Envelope extends Interface {\r\n\r\n  constructor() {\r\n\r\n    let options = ['value'];\r\n\r\n    let defaults = {\r\n      'size': [300,150],\r\n      'noNewPoints':false,\r\n      'points': [\r\n  \t\t\t{\r\n  \t\t\t\tx: 0.1,\r\n  \t\t\t\ty: 0.4\r\n  \t\t\t},\r\n  \t\t\t{\r\n  \t\t\t\tx: 0.35,\r\n  \t\t\t\ty: 0.6\r\n  \t\t\t},\r\n  \t\t\t{\r\n  \t\t\t\tx: 0.65,\r\n  \t\t\t\ty: 0.2\r\n  \t\t\t},\r\n  \t\t\t{\r\n  \t\t\t\tx: 0.9,\r\n  \t\t\t\ty: 0.4\r\n  \t\t\t}\r\n  \t\t]\r\n    };\r\n\r\n    super(arguments,options,defaults);\r\n\r\n    this.points = this.settings.points;\r\n\r\n    this.nodes = [];\r\n\r\n    this.selected = false;\r\n\r\n    this.init();\r\n\r\n\r\n  }\r\n\r\n  buildInterface() {\r\n\r\n\r\n    this.points.forEach((point) => {\r\n      let node = new Point(point,this);\r\n      this.nodes.push(node);\r\n    });\r\n\r\n    this.sortPoints();\r\n\r\n    this.line = svg.create('polyline');\r\n    this.line.setAttribute('stroke-width', 2);\r\n    this.line.setAttribute('fill', 'none');\r\n\r\n    this.element.appendChild(this.line);\r\n\r\n    this.fill = svg.create('polyline');\r\n    this.fill.setAttribute('fill-opacity', '0.2');\r\n\r\n    this.element.appendChild(this.fill);\r\n\r\n  }\r\n\r\n  sizeInterface() {\r\n\r\n    for (let i=0; i<this.nodes.length; i++) {\r\n      this.nodes[i].resize();\r\n      this.nodes[i].move();\r\n    }\r\n\r\n    this.render();\r\n\r\n  }\r\n\r\n  colorInterface() {\r\n\r\n    this.element.style.backgroundColor = this.colors.fill;\r\n    this.line.setAttribute('stroke', this.colors.accent);\r\n    this.fill.setAttribute('fill', this.colors.accent);\r\n    this.nodes.forEach((node) => {\r\n      node.element.setAttribute('fill',this.colors.accent);\r\n    });\r\n\r\n  }\r\n\r\n  render() {\r\n  //  this.nodes[this.selected].move( this.points )\r\n    this.calculatePath();\r\n  }\r\n\r\n  calculatePoints() {\r\n    this.points = [];\r\n    this.nodes.forEach((node) => {\r\n      this.points.push({ x: node.x, y: node.y });\r\n    });\r\n  }\r\n\r\n  calculatePath() {\r\n\r\n    //stroke data\r\n    let data = '0 '+ this.nodes[0].location.y+', ';\r\n\r\n    // data should be re-ordered based on x location.\r\n    // whatever function adds a node should add it at the right index\r\n\r\n    this.nodes.forEach((node) => {\r\n    //  let location = node.getCoordinates();\r\n      data += node.location.x + ' ' + node.location.y + ', ';\r\n    });\r\n\r\n\r\n  //  data += point.x*this.width+' '+ point.y*this.height+', ';\r\n    data += this.width + ' '+ this.nodes[this.nodes.length-1].location.y;\r\n\r\n    this.line.setAttribute('points', data);\r\n\r\n    // fill data\r\n    // add bottom corners\r\n\r\n    data += ', '+this.width +' '+this.height+', ';\r\n    data += '0 '+this.height;\r\n\r\n    this.fill.setAttribute('points', data);\r\n\r\n  }\r\n\r\n\r\n\r\n  click() {\r\n  \t// find nearest node and set this.selected (index)\r\n    this.hasMoved = false;\r\n  \tthis.selected = this.findNearestNode();\r\n\r\n    this.nodes[this.selected].move(this.mouse.x/this.width,1-this.mouse.y/this.height);\r\n    this.scaleNode(this.selected);\r\n\r\n    // must do this b/c new node may have been created\r\n    this.calculatePoints();\r\n    this.emit('change',this.points);\r\n  \tthis.render();\r\n  }\r\n\r\n  move() {\r\n  \tif (this.clicked) {\r\n      this.mouse.x = math.clip(this.mouse.x,0,this.width);\r\n      this.hasMoved = true;\r\n\r\n      this.nodes[this.selected].move(this.mouse.x/this.width,1-this.mouse.y/this.height);\r\n    \tthis.scaleNode(this.selected);\r\n\r\n      this.calculatePoints();\r\n  \t\tthis.emit('change',this.points);\r\n  \t\tthis.render();\r\n  \t}\r\n  }\r\n\r\n  release() {\r\n\r\n  \tif (!this.hasMoved) {\r\n      this.nodes[this.selected].destroy();\r\n  \t}\r\n\r\n    this.calculatePoints();\r\n    this.emit('change',this.points);\r\n  \tthis.render();\r\n\r\n  \t// reset this.selected\r\n  \tthis.selected = null;\r\n  }\r\n\r\n\r\n  findNearestNode() {\r\n  \tvar nearestIndex = null;\r\n    // set this unreasonably high so that every distance will be lower than it.\r\n  \tvar nearestDist = 10000;\r\n  \tvar before = false;\r\n    let x = this.mouse.x/this.width;\r\n    let y = 1-this.mouse.y/this.height;\r\n    let nodes = this.nodes;\r\n  \tfor (let i = 0; i<nodes.length; i++) {\r\n\r\n      // calculate the distance from mouse to this node using pythagorean theorem\r\n  \t\tvar distance = Math.sqrt(  Math.pow( (nodes[i].x - x), 2) + Math.pow((nodes[i].y - y), 2) );\r\n\r\n      // if this distance is less than the previous shortest distance, use this index\r\n  \t\tif (distance < nearestDist) {\r\n  \t\t\tnearestDist = distance;\r\n  \t\t\tnearestIndex = i;\r\n  \t\t\tbefore = x > nodes[i].x;\r\n  \t\t}\r\n\r\n  \t}\r\n\r\n    // if not very close to any node, create a node\r\n  \tif (!this.settings.noNewPoints && nearestDist>0.07) {\r\n\r\n      nearestIndex = this.getIndexFromX(this.mouse.x/this.width);\r\n\r\n  \t\tthis.nodes.splice(nearestIndex,0, new Point({\r\n  \t\t\tx: this.mouse.x/this.width,\r\n  \t\t\ty: 1-this.mouse.y/this.height\r\n  \t\t}, this));\r\n      this.hasMoved = true;\r\n\r\n  \t}\r\n\r\n  \treturn nearestIndex;\r\n  }\r\n\r\n  getIndexFromX(x) {\r\n    let index = 0;\r\n    this.nodes.forEach((node,i) => {\r\n      if (this.nodes[i].x <= x) {\r\n        index = i+1;\r\n      }\r\n    });\r\n    return index;\r\n  }\r\n\r\n  scaleNode(i) {\r\n\r\n  \tlet clippedX = math.clip(this.nodes[i].x, 0, 1);\r\n  \tlet clippedY = math.clip(this.nodes[i].y, 0, 1);\r\n\r\n    this.nodes[i].move( clippedX, clippedY );\r\n\r\n  }\r\n\r\n  /**\r\n  Sort the this.points array from left-most point to right-most point. You should not regularly need to use this, however it may be useful if the points get unordered.\r\n  */\r\n  sortPoints() {\r\n    this.nodes.sort(function(a, b){\r\n      return a.x > b.x;\r\n    });\r\n  }\r\n\r\n\r\n  /**\r\n  Add a breakpoint on the envelope.\r\n  @param x {number} x location of the point, normalized (0-1)\r\n  @param y {number} y location of the point, normalized (0-1)\r\n  */\r\n  addPoint(x,y) {\r\n    let index = this.nodes.length;\r\n\r\n    this.sortPoints();\r\n\r\n    for (let i = 0; i<this.nodes.length; i++) {\r\n      if (x < this.nodes[i].x) {\r\n        index = i;\r\n        break;\r\n      }\r\n  \t}\r\n\r\n    this.nodes.splice(index, 0, new Point({\r\n      x: x,\r\n      y: y\r\n    }, this));\r\n\r\n    this.scaleNode(index);\r\n\r\n    this.calculatePoints();\r\n    this.emit('change',this.points);\r\n\r\n    this.render();\r\n  }\r\n\r\n\r\n  /**\r\n  Find the level at a certain x location on the envelope.\r\n  @param x {number} The x location to find the level of, normalized 0-1\r\n  */\r\n  scan(x) {\r\n    // find surrounding points\r\n    let nextIndex = this.getIndexFromX(x);\r\n    let priorIndex = nextIndex-1;\r\n    if (priorIndex < 0) {\r\n      priorIndex = 0;\r\n    }\r\n    if (nextIndex >= this.nodes.length) {\r\n      nextIndex = this.nodes.length-1;\r\n    }\r\n    let priorPoint = this.nodes[priorIndex];\r\n    let nextPoint = this.nodes[nextIndex];\r\n    let loc = math.scale(x,priorPoint.x, nextPoint.x, 0, 1);\r\n    let value = math.interp(loc,priorPoint.y,nextPoint.y);\r\n    this.emit('scan',value);\r\n    return value;\r\n  }\r\n\r\n\r\n  /**\r\n  Move a breakpoint on the envelope.\r\n  @param index {number} The index of the breakpoint to move\r\n  @param x {number} New x location, normalized 0-1\r\n  @param y {number} New y location, normalized 0-1\r\n  */\r\n  movePoint(index,x,y) {\r\n    this.nodes[index].move(x,y);\r\n    this.scaleNode(index);\r\n    this.calculatePoints();\r\n    this.emit('change',this.points);\r\n    this.render();\r\n  }\r\n\r\n\r\n  /**\r\n  Move a breakpoint on the envelope by a certain amount.\r\n  @param index {number} The index of the breakpoint to move\r\n  @param xOffset {number} X displacement, normalized 0-1\r\n  @param yOffset {number} Y displacement, normalized 0-1\r\n  */\r\n  adjustPoint(index,xOffset,yOffset) {\r\n    this.nodes[index].move(this.nodes[index].x+xOffset,this.nodes[index].y+yOffset);\r\n    this.scaleNode(index);\r\n    this.calculatePoints();\r\n    this.emit('change',this.points);\r\n    this.render();\r\n  }\r\n\r\n\r\n  /**\r\n  Remove a breakpoint from the envelope.\r\n  @param index {number} Index of the breakpoint to remove\r\n  */\r\n  destroyPoint(index) {\r\n    this.nodes[index].destroy();\r\n    this.calculatePoints();\r\n    this.emit('change',this.points);\r\n    this.render();\r\n  }\r\n\r\n\r\n  /**\r\n  Remove all existing breakpoints and add an entirely new set of breakpoints.\r\n  @param allPoints {array} An array of objects with x/y properties (normalized 0-1). Each object in the array specifices the x/y location of a new breakpoint to be added.\r\n  */\r\n  setPoints(allPoints) {\r\n    while (this.nodes.length) {\r\n      this.nodes[0].destroy();\r\n    }\r\n    allPoints.forEach((point) => {\r\n      this.addPoint(point.x,point.y);\r\n    });\r\n    this.calculatePoints();\r\n    this.emit('change',this.points);\r\n    this.render();\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport dom from '../util/dom.js';\r\nimport Interface from '../core/interface.js';\r\n\r\n/**\r\n * Spectrogram\r\n *\r\n * @description Audio spectrum visualization\r\n *\r\n * @demo <span nexus-ui=\"spectrogram\"></span>\r\n *\r\n * @example\r\n * var spectrogram = new Nexus.Spectrogram('#target')\r\n * spectrogram.connect(myWebAudioNode)\r\n *\r\n * @example\r\n * var spectrogram = new Nexus.Spectrogram('#target',{\r\n *   size: [300,150],\r\n *   fps: 30\r\n * })\r\n * spectrogram.connect(myWebAudioNode)\r\n *\r\n * @output\r\n * &nbsp;\r\n * No events\r\n *\r\n */\r\n\r\nexport default class Spectrogram extends Interface {\r\n  constructor() {\r\n    let options = [];\r\n\r\n    let defaults = {\r\n      size: [300, 150],\r\n\t  fps: undefined\r\n    };\r\n\r\n    super(arguments, options, defaults);\r\n\r\n    this.analyser = null;\r\n    this.bufferLength = 0;\r\n    this.dataArray = null;\r\n    this.active = false;\r\n    this.source = null;\r\n\r\n    this.init();\r\n  }\r\n\r\n  buildFrame() {\r\n    this.canvas = new dom.SmartCanvas(this.parent);\r\n    this.element = this.canvas.element;\r\n  }\r\n\r\n  sizeInterface() {\r\n    this.canvas.resize(this.width, this.height);\r\n  }\r\n\r\n  colorInterface() {\r\n    this.canvas.element.style.backgroundColor = this.colors.fill;\r\n  }\r\n  \r\n  /**\r\n  Set the refreshes per second. Defaults to 0 = max permitted by browser, typically 60. Values < 60 can be used to decrease cpu/gpu usage.\r\n  * @param framesPerSecond {number} New framerate\r\n  */\r\n  setFramerate(newFramerate) {\r\n\t  this.settings.fps = newFramerate;\r\n\t  this.canvas.setFramerate(newFramerate);\r\n  }\r\n\r\n  render(nowTime=performance.now()) {\r\n    if (this.active) {\r\n      requestAnimationFrame(this.render.bind(this));\r\n\t  if (!this.canvas.refreshIntervalReached(nowTime)) return; //skip rendering until target framerate interval reached\r\n    }\r\n\r\n    if (this.analyser) {\r\n      this.analyser.getByteFrequencyData(this.dataArray);\r\n    }\r\n\t\r\n\t//cache some vals to microoptimize\r\n\tconst width = this.canvas.element.width;\r\n\tconst height = this.canvas.element.height;\r\n\tconst canvasContext = this.canvas.context;\r\n\r\n    canvasContext.fillStyle = this.colors.fill;\r\n    canvasContext.fillRect(\r\n      0,\r\n      0,\r\n      width,\r\n      height\r\n    );\r\n\r\n    if (this.source && this.dataArray) {\r\n      //console.log(this.dataArray);\r\n\t  \r\n\t  //cache more vals to microoptimize\r\n\t  const bufferLength = this.bufferLength;\r\n\t  const dataArray = this.dataArray;\r\n\t  const accentColor = this.colors.accent;\r\n\t\t\r\n      let barWidth = width / bufferLength;\r\n      let barHeight;\r\n      let x = 0;\r\n\r\n      let definition = width / 50;\r\n\r\n      for (let i = 0; i < bufferLength; i = i + definition) {\r\n        barHeight = Math.max.apply(\r\n          null,\r\n          dataArray.subarray(i, i + definition)\r\n        );\r\n        barHeight /= 255;\r\n        barHeight *= height;\r\n\r\n        canvasContext.fillStyle = accentColor;\r\n        canvasContext.fillRect(\r\n          x,\r\n          height - barHeight,\r\n          barWidth * definition,\r\n          barHeight\r\n        );\r\n\r\n        x += barWidth * definition;\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n  Equivalent to \"patching in\" an audio node to visualize.\r\n  @param node {AudioNode} The audio node to visualize\r\n  @example spectrogram.connect( Tone.Master );\r\n  */\r\n  connect(node) {\r\n    if (this.source) {\r\n      this.disconnect();\r\n    }\r\n\r\n    this.analyser = node.context.createAnalyser();\r\n    this.analyser.fftSize = 2048;\r\n    this.bufferLength = this.analyser.frequencyBinCount;\r\n    this.dataArray = new Uint8Array(this.bufferLength);\r\n\r\n    this.active = true;\r\n\r\n    this.source = node;\r\n    this.source.connect(this.analyser);\r\n\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  Stop visualizing the source node and disconnect it.\r\n  */\r\n  disconnect() {\r\n    if (this.source) {\r\n      this.source.disconnect(this.analyser);\r\n    }\r\n\r\n    this.analyser = null;\r\n    this.bufferLength = 0;\r\n    this.dataArray = null;\r\n    this.active = false;\r\n    this.source = null;\r\n  }\r\n\r\n  click() {\r\n    this.active = !this.active && this.source;\r\n    this.render();\r\n  }\r\n\r\n  customDestroy() {\r\n    this.active = false;\r\n  }\r\n}\r\n","'use strict';\r\n\r\nimport dom from '../util/dom.js';\r\nimport math from '../util/math.js';\r\nimport Interface from '../core/interface.js';\r\n\r\n/**\r\n * Meter\r\n *\r\n * @description Stereo decibel meter\r\n *\r\n * @demo <span nexus-ui=\"meter\"></span>\r\n *\r\n * @example\r\n * var meter = new Nexus.Meter('#target')\r\n * meter.connect(myWebAudioNode)\r\n *\r\n * @example\r\n * var meter = new Nexus.Meter('#target', {\r\n *   size: [75,75],\r\n *   fps: 30\r\n * })\r\n * meter.connect(myWebAudioNode)\r\n *\r\n * @output\r\n * &nbsp;\r\n * No events\r\n *\r\n */\r\n\r\nexport default class Meter extends Interface {\r\n  constructor() {\r\n    let options = [];\r\n\r\n    let defaults = {\r\n      size: [30, 100],\r\n\t  fps: undefined\r\n    };\r\n\r\n    super(arguments, options, defaults);\r\n\r\n    this.channels = 2;\r\n    this.splitter = null;\r\n    this.analysers = [];\r\n    this.bufferLength = 0;\r\n    this.dataArray = null;\r\n    this.active = false;\r\n    this.source = null;\r\n    this.db = -Infinity;\r\n\r\n    this.init();\r\n\r\n    this.meterWidth = this.canvas.element.width / this.channels;\r\n\r\n    this.render();\r\n  }\r\n\r\n  buildFrame() {\r\n    this.canvas = new dom.SmartCanvas(this.parent);\r\n    this.element = this.canvas.element;\r\n  }\r\n\r\n  sizeInterface() {\r\n    this.canvas.resize(this.width, this.height);\r\n  }\r\n\r\n  colorInterface() {\r\n    this.canvas.element.style.backgroundColor = this.colors.fill;\r\n  }\r\n  \r\n  /**\r\n  Set the refreshes per second. Defaults to 0 = max permitted by browser, typically 60. Values < 60 can be used to decrease cpu/gpu usage.\r\n  * @param framesPerSecond {number} New framerate\r\n  */\r\n  setFramerate(newFramerate) {\r\n\t  this.settings.fps = newFramerate;\r\n\t  this.canvas.setFramerate(newFramerate);\r\n  }\r\n\r\n  render(nowTime=performance.now()) {\r\n    if (this.active) {\r\n      requestAnimationFrame(this.render.bind(this));\r\n\t  if (!this.canvas.refreshIntervalReached(nowTime)) return; //skip rendering until target framerate interval reached\r\n    }\r\n\t\r\n\t//cache some vals to microoptimize\r\n\tconst width = this.canvas.element.width;\r\n\tconst height = this.canvas.element.height;\r\n\tconst canvasContext = this.canvas.context;\r\n\t\r\n    canvasContext.fillStyle = this.colors.fill;\r\n    canvasContext.fillRect(\r\n      0,\r\n      0,\r\n      width,\r\n      height\r\n    );\r\n\r\n    for (let i = 0; i < this.analysers.length; i++) {\r\n      if (this.source) {\r\n\t\t//cache more vals to microoptimize\r\n\t\tconst dataArray = this.dataArray;\r\n\t\tconst dataArrayLength = this.dataArray.length;\r\n\t\t\r\n\t\t\r\n        this.analysers[i].getFloatTimeDomainData(dataArray);\r\n\r\n        let rms = 0;\r\n\r\n        for (let i = 0; i < dataArrayLength; i++) {\r\n          rms += dataArray[i] * dataArray[i];\r\n        }\r\n\r\n        rms = Math.sqrt(rms / dataArrayLength);\r\n\r\n        this.db = 20 * Math.log10(rms);\r\n      } else if (this.db > -200 && this.db !== -Infinity) {\r\n        this.db -= 1;\r\n      } else {\r\n        this.db = -Infinity;\r\n      }\r\n\r\n      //console.log(db)\r\n\r\n      if (this.db > -70) {\r\n        let linear = math.normalize(this.db, -70, 5);\r\n        let exp = linear * linear;\r\n        let y = math.scale(exp, 0, 1, height, 0);\r\n\r\n        canvasContext.fillStyle = this.colors.accent;\r\n        canvasContext.fillRect(\r\n          this.meterWidth * i,\r\n          y,\r\n          width,\r\n          height - y\r\n        );\r\n\r\n        //console.log(\"rendering...\")\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n  Equivalent to \"patching in\" an audio node to visualize.\r\n  @param node {AudioNode} The audio node to visualize\r\n  @param channels {number} (optional) The number of channels in the source node to watch. If not specified, the interface will look for a .channelCount property on the input node. If it does not exist, the interface will default to 1 channel.\r\n  @example meter.connect( Tone.Master, 2 );\r\n  */\r\n  connect(node, channels) {\r\n    if (this.source) {\r\n      this.disconnect();\r\n    }\r\n\r\n    this.channels = channels || node.channelCount || 2;\r\n\r\n    this.splitter = node.context.createChannelSplitter(this.channels);\r\n\r\n    this.analysers = [];\r\n    for (let i = 0; i < this.channels; i++) {\r\n      const analyser = node.context.createAnalyser();\r\n      analyser.fftSize = 1024;\r\n      analyser.smoothingTimeConstant = 1;\r\n      this.splitter.connect(analyser, i);\r\n      this.analysers.push(analyser);\r\n    }\r\n    this.bufferLength = this.analysers[0].frequencyBinCount;\r\n    this.dataArray = new Float32Array(this.bufferLength);\r\n\r\n    this.active = true;\r\n\r\n    this.meterWidth = this.canvas.element.width / this.channels;\r\n\r\n    this.source = node;\r\n    this.source.connect(this.splitter);\r\n\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  Stop visualizing the source node and disconnect it.\r\n  */\r\n  disconnect() {\r\n    if (this.source) {\r\n      this.source.disconnect(this.splitter);\r\n    }\r\n\r\n    this.splitter = null;\r\n    this.analysers = [];\r\n    this.bufferLength = 0;\r\n    this.dataArray = null;\r\n    this.active = false;\r\n    this.source = null;\r\n  }\r\n\r\n  click() {\r\n    this.active = !this.active && this.source;\r\n    this.render();\r\n  }\r\n\r\n  customDestroy() {\r\n    this.active = false;\r\n  }\r\n}\r\n","'use strict';\r\n\r\nimport dom from '../util/dom.js';\r\nimport Interface from '../core/interface.js';\r\n\r\n/**\r\n * Oscilloscope\r\n *\r\n * @description Visualizes a waveform's stream of values.\r\n *\r\n * @demo <span nexus-ui=\"oscilloscope\"></span>\r\n *\r\n * @example\r\n * var oscilloscope = new Nexus.Oscilloscope('#target')\r\n * oscilloscope.connect(myWebAudioNode)\r\n *\r\n * @example\r\n * var oscilloscope = new Nexus.Oscilloscope('#target',{\r\n *   size: [300,150],\r\n *   fps: 30\r\n * })\r\n * oscilloscope.connect(myWebAudioNode)\r\n *\r\n * @output\r\n * &nbsp;\r\n * No events\r\n *\r\n */\r\n\r\nexport default class Oscilloscope extends Interface {\r\n  constructor() {\r\n    let options = [];\r\n\r\n    let defaults = {\r\n      size: [300, 150],\r\n\t  fps: undefined\r\n    };\r\n\r\n    super(arguments, options, defaults);\r\n\r\n    this.analyser = null;\r\n    this.bufferLength = 0;\r\n    this.dataArray = null;\r\n\r\n    this.active = false;\r\n\r\n    this.source = null;\r\n\r\n    this.init();\r\n\r\n    this.render();\r\n  }\r\n\r\n  buildFrame() {\r\n    this.canvas = new dom.SmartCanvas(this.parent, this.settings.fps);\r\n    this.element = this.canvas.element;\r\n  }\r\n\r\n  sizeInterface() {\r\n    this.canvas.resize(this.width, this.height);\r\n  }\r\n\r\n  colorInterface() {\r\n    this.canvas.element.style.backgroundColor = this.colors.fill;\r\n  }\r\n  \r\n  /**\r\n  Set the refreshes per second. Defaults to 0 = max permitted by browser, typically 60. Values < 60 can be used to decrease cpu/gpu usage.\r\n  * @param framesPerSecond {number} New framerate\r\n  */\r\n  setFramerate(newFramerate) {\r\n\t  this.settings.fps = newFramerate;\r\n\t  this.canvas.setFramerate(newFramerate);\r\n  }\r\n\r\n  render(nowTime=performance.now()) {\r\n    if (this.active) {\r\n      requestAnimationFrame(this.render.bind(this));\r\n\t  if (!this.canvas.refreshIntervalReached(nowTime)) return; //skip rendering until target framerate interval reached\r\n    }\r\n\r\n    if (this.analyser) {\r\n      this.analyser.getByteTimeDomainData(this.dataArray);\r\n    }\r\n\t\r\n\t//cache some vals to microoptimize\r\n\tconst width = this.canvas.element.width;\r\n\tconst height = this.canvas.element.height;\r\n\tconst canvasContext = this.canvas.context;\r\n\r\n    canvasContext.fillStyle = this.colors.fill;\r\n    canvasContext.fillRect(\r\n      0,\r\n      0,\r\n      width,\r\n      height\r\n    );\r\n\r\n    canvasContext.lineWidth = ~~(height / 100 + 2);\r\n    canvasContext.strokeStyle = this.colors.accent;\r\n\r\n    canvasContext.beginPath();\r\n\r\n    if (this.source) {\r\n\t  //cache more vals to microoptimize\r\n\t  const bufferLength = this.bufferLength;\r\n\t  const thisDataArray = this.dataArray;\r\n\t  const halfHeight = height/2;\r\n\t  \r\n      var sliceWidth = width/bufferLength;\r\n      var x = 0;\r\n\t  \r\n\r\n      for (var i = 0; i < bufferLength; i++) {\r\n        var v = thisDataArray[i] / 128.0;\r\n        var y = v * halfHeight;\r\n\r\n        if (i === 0) {\r\n          canvasContext.moveTo(x, y);\r\n        } else {\r\n          canvasContext.lineTo(x, y);\r\n        }\r\n\r\n        x += sliceWidth;\r\n      }\r\n    } else {\r\n      canvasContext.moveTo(0, height / 2);\r\n      canvasContext.lineTo(\r\n        width,\r\n        height / 2\r\n      );\r\n    }\r\n\r\n    canvasContext.stroke();\r\n  }\r\n\r\n  /**\r\n  Equivalent to \"patching in\" an audio node to visualize.\r\n  @param node {AudioNode} The audio node to visualize\r\n  @example oscilloscope.connect( Tone.Master );\r\n  */\r\n\r\n  connect(node) {\r\n    if (this.source) {\r\n      this.disconnect();\r\n    }\r\n\r\n    this.analyser = node.context.createAnalyser();\r\n    this.analyser.fftSize = 2048;\r\n    this.bufferLength = this.analyser.frequencyBinCount;\r\n    this.dataArray = new Uint8Array(this.bufferLength);\r\n    this.analyser.getByteTimeDomainData(this.dataArray);\r\n\r\n    this.active = true;\r\n\r\n    this.source = node;\r\n    this.source.connect(this.analyser);\r\n\r\n    this.render();\r\n  }\r\n\r\n  /**\r\n  Stop visualizing the source node and disconnect it.\r\n  */\r\n  disconnect() {\r\n    if (this.source) {\r\n      this.source.disconnect(this.analyser);\r\n    }\r\n\r\n    this.analyser = null;\r\n    this.bufferLength = 0;\r\n    this.dataArray = null;\r\n    this.active = false;\r\n    this.source = null;\r\n  }\r\n\r\n  click() {\r\n    this.active = !this.active && this.source;\r\n    this.render();\r\n  }\r\n\r\n  customDestroy() {\r\n    this.active = false;\r\n  }\r\n}\r\n","import Position from './position.js';\r\nimport Slider from './slider.js';\r\nimport Toggle from './toggle.js';\r\nimport Button from './button.js';\r\nimport TextButton from './textbutton.js';\r\nimport RadioButton from './radiobutton.js';\r\nimport Number from './number.js';\r\nimport Select from './select.js';\r\nimport Dial from './dial.js';\r\nimport Piano from './piano.js';\r\nimport Sequencer from './sequencer.js';\r\nimport Pan2D from './pan2d.js';\r\nimport Tilt from './tilt.js';\r\nimport Multislider from './multislider.js';\r\nimport Pan from './pan.js';\r\nimport Envelope from './envelope.js';\r\nimport Spectrogram from './spectrogram.js';\r\nimport Meter from './meter.js';\r\nimport Oscilloscope from './oscilloscope.js';\r\n\r\nexport default {\r\n  Position,\r\n  Slider,\r\n  Toggle,\r\n  Button,\r\n  TextButton,\r\n  RadioButton,\r\n  Number,\r\n  Select,\r\n  Dial,\r\n  Piano,\r\n  Sequencer,\r\n  Pan2D,\r\n  Tilt,\r\n  Multislider,\r\n  Pan,\r\n  Envelope,\r\n  Spectrogram,\r\n  Meter,\r\n  Oscilloscope\r\n};\r\n","'use strict';\r\n\r\nimport dom from '../util/dom';\r\nimport Interfaces from '../interfaces/';\r\n\r\nlet createInterfaceID = (widget,interfaceIDs) => {\r\n  let type = widget.type;\r\n  if (interfaceIDs[type]) {\r\n    interfaceIDs[type]++;\r\n  } else {\r\n    interfaceIDs[type] = 1;\r\n  }\r\n  return ( type + interfaceIDs[type] );\r\n};\r\n\r\nlet element = (element,type,options) => {\r\n  options = options || {};\r\n  for (let i = 0; i < element.attributes.length; i++){\r\n    let att = element.attributes[i];\r\n  //  try {\r\n  //    options[att.nodeName] = eval(att.nodeValue);\r\n  //  } catch(e) {\r\n      options[att.nodeName] = att.nodeValue;\r\n  //  }\r\n  }\r\n  type = type[0].toUpperCase() + type.slice(1);\r\n  let widget = new Interfaces[type](element,options);\r\n  widget.id = element.id;\r\n  return widget;\r\n};\r\n\r\n\r\nlet section = (parent,keyword) => {\r\n\r\n  keyword = keyword || 'nexus-ui';\r\n\r\n  let interfaceIDs = {};\r\n\r\n  let container = dom.parseElement(parent);\r\n\r\n  let ui = {};\r\n\r\n  let htmlElements = container.getElementsByTagName('*');\r\n  let elements = [];\r\n  for (let i=0; i<htmlElements.length; i++) {\r\n    elements.push(htmlElements[i]);\r\n  }\r\n  for (let i=0;i<elements.length;i++) {\r\n    let type = elements[i].getAttribute(keyword);\r\n    if (type) {\r\n      let formattedType = false;\r\n      for (let key in Interfaces) {\r\n        if (type.toLowerCase()===key.toLowerCase()) {\r\n          formattedType = key;\r\n        }\r\n      }\r\n      console.log(formattedType);\r\n      let widget = element(elements[i],formattedType);\r\n      if (widget.id) {\r\n        ui[widget.id] = widget;\r\n      } else {\r\n        let id = createInterfaceID(widget,interfaceIDs);\r\n        ui[id] = widget;\r\n      }\r\n    }\r\n  }\r\n\r\n  return ui;\r\n\r\n};\r\n\r\nlet add = (type,parent,options) => {\r\n  let target = document.createElement('div');\r\n  options = options || {};\r\n  if (parent) {\r\n    parent = dom.parseElement(parent);\r\n  } else {\r\n    parent = document.body;\r\n  }\r\n  parent.appendChild(target);\r\n  options.target = target;\r\n  if (options.size) {\r\n    target.style.width = options.size[0] + 'px';\r\n    target.style.height = options.size[1] + 'px';\r\n  }\r\n  return element(target,type,options);\r\n};\r\n\r\nexport { element };\r\nexport { section };\r\nexport { add };\r\n","/*\r\nMain concept:\r\nsynth = new Nexus.Rack('elementID');\r\n\r\nTransform all elements inside the div\r\nsynth.elementID will hold the first slider interface\r\n\r\n2) In future, potentially writing a rack that is re-usable?\r\nCould also take JSON\r\n\r\nnew Nexus.Rack('#target',{\r\n  pre: () => {\r\n    create some divs here, or some audio code\r\n  },\r\n  interface: {\r\n    slider1: Nexus.add.slider({\r\n      top:10,\r\n      left:10,\r\n      width:50,\r\n      height:100,\r\n      min: 0,\r\n      max: 100,\r\n      step: 1\r\n    }),\r\n    wave1: Nexus.add.waveform({\r\n      file: './path/to/file.mp3',\r\n      width:500,\r\n      height:100,\r\n      mode: 'range'\r\n    })\r\n  },\r\n  init: () => {\r\n    // some audio init code goes here...\r\n  }\r\n});\r\n\r\n*/\r\n\r\nimport * as transform from '../util/transform';\r\nimport dom from '../util/dom';\r\n\r\nimport { colors } from '../main';\r\n\r\nexport default class Rack {\r\n\r\n  constructor(target, settings) {\r\n\r\n    this.meta = {};\r\n    this.meta.target = target;\r\n    this.meta.parent = dom.parseElement(target); // should be a generic function for parsing a 'target' argument that checks for string/DOM/jQUERY\r\n    this.meta.colors = {};\r\n\r\n    if (settings) {\r\n      this.meta.attribute = settings.attribute || 'nexus-ui';\r\n      this.meta.title = settings.name || false;\r\n      this.meta.open = settings.open || false;\r\n    } else {\r\n      this.meta.attribute = 'nexus-ui';\r\n      this.meta.title = false;\r\n      this.meta.open = false;\r\n    }\r\n\r\n    let defaultColors = colors(); // jshint ignore:line\r\n    this.meta.colors.accent = defaultColors.accent;\r\n    this.meta.colors.fill = defaultColors.fill;\r\n    this.meta.colors.light = defaultColors.light;\r\n    this.meta.colors.dark = defaultColors.dark;\r\n    this.meta.colors.mediumLight = defaultColors.mediumLight;\r\n    this.meta.colors.mediumDark = defaultColors.mediumDark;\r\n    this.buildInterface();\r\n    this.colorInterface();\r\n  }\r\n\r\n  buildInterface() {\r\n    this.meta.parent.style.boxSizing = 'border-box';\r\n    this.meta.parent.style.userSelect = 'none';\r\n    this.meta.parent.style.mozUserSelect = 'none';\r\n    this.meta.parent.style.webkitUserSelect = 'none';\r\n\r\n    this.meta.contents = document.createElement('div');\r\n\r\n    while (this.meta.parent.childNodes.length > 0) {\r\n        this.meta.contents.appendChild(this.meta.parent.childNodes[0]);\r\n    }\r\n\r\n    this.meta.contents.style.padding = '0px';\r\n    this.meta.contents.style.boxSizing = 'border-box';\r\n\r\n    if (this.meta.title) {\r\n      this.meta.titleBar = document.createElement('div');\r\n      this.meta.titleBar.innerHTML = this.meta.title;\r\n      this.meta.titleBar.style.fontFamily = 'arial';\r\n      this.meta.titleBar.style.position = 'relative';\r\n      this.meta.titleBar.style.color = '#888';\r\n      this.meta.titleBar.style.padding = '7px';\r\n      this.meta.titleBar.style.fontSize = '12px';\r\n\r\n      this.meta.button = document.createElement('div');\r\n      this.meta.button.style.position = 'absolute';\r\n      this.meta.button.style.top = '5px' ;\r\n      this.meta.button.style.right = '5px' ;\r\n      this.meta.button.innerHTML = '-';\r\n      this.meta.button.style.padding = '0px 5px 2px';\r\n      this.meta.button.style.lineHeight = '12px';\r\n      this.meta.button.style.fontSize = '15px';\r\n\r\n      this.meta.button.style.cursor = 'pointer';\r\n\r\n      this.meta.button.addEventListener('mouseover', () => {\r\n        this.meta.button.style.backgroundColor = this.meta.colors.mediumDark;\r\n      });\r\n      this.meta.button.addEventListener('mouseleave', () => {\r\n        this.meta.button.style.backgroundColor = this.meta.colors.mediumLight;\r\n      });\r\n      this.meta.button.addEventListener('click', () => {\r\n        if (this.meta.open) {\r\n          this.hide();\r\n        } else {\r\n          this.show();\r\n        }\r\n      });\r\n\r\n\r\n      this.meta.titleBar.appendChild(this.meta.button);\r\n\r\n      this.meta.parent.appendChild(this.meta.titleBar);\r\n    }\r\n    this.meta.parent.appendChild(this.meta.contents);\r\n\r\n  //  var width = this.meta.parent.style.width = getComputedStyle(this.meta.parent).getPropertyValue('width');\r\n//    this.meta.parent.style.width = width;\r\n\r\n    let ui = transform.section(this.meta.target, this.meta.attribute);\r\n    for (var key in ui) {\r\n      this[key] = ui[key];\r\n    }\r\n  }\r\n\r\n  colorInterface() {\r\n    if (this.meta.title) {\r\n      this.meta.button.style.backgroundColor = this.meta.colors.mediumLight;\r\n      this.meta.button.style.border = 'solid 0px '+this.meta.colors.fill;\r\n      this.meta.parent.style.border = 'solid 1px '+this.meta.colors.mediumLight;\r\n      this.meta.parent.style.backgroundColor = this.meta.colors.light;\r\n      this.meta.titleBar.style.backgroundColor = this.meta.colors.fill;\r\n    }\r\n  }\r\n\r\n  show() {\r\n    this.meta.contents.style.display = 'block';\r\n    this.meta.open = true;\r\n  }\r\n\r\n  hide() {\r\n    this.meta.contents.style.display = 'none';\r\n    this.meta.open = false;\r\n  }\r\n\r\n  colorize(type,color) {\r\n    for (var key in this) {\r\n      if (this[key].colorize) {\r\n        this[key].colorize(type,color);\r\n      }\r\n    }\r\n    this.meta.colors[type] = color;\r\n    this.colorInterface();\r\n  }\r\n\r\n  empty() {\r\n    for (var key in this) {\r\n      if (this[key].destroy) {\r\n        this[key].destroy();\r\n      }\r\n    }\r\n  }\r\n\r\n}\r\n","'use strict';\r\n\r\nimport math from '../util/math';\r\n\r\nexport default class Tune {\r\n  constructor() {\r\n    // the scale as ratios\r\n    this.scale = [];\r\n\r\n    // i/o modes\r\n    this.mode = {\r\n      output: 'frequency',\r\n      input: 'step'\r\n    };\r\n\r\n    // ET major\r\n    this.etmajor = [\r\n      261.62558,\r\n      293.664764,\r\n      329.627563,\r\n      349.228241,\r\n      391.995422,\r\n      440,\r\n      493.883301,\r\n      523.25116\r\n    ];\r\n\r\n    // Root frequency.\r\n    this.root = math.mtof(60); // * Math.pow(2,(60-69)/12);\r\n\r\n    // default is a major scale\r\n    this.createScale(0, 2, 4, 5, 7, 9, 11);\r\n  }\r\n\r\n  /* Return data in the mode you are in (freq, ratio, or midi) */\r\n  note(input, octave) {\r\n    let newvalue;\r\n\r\n    if (this.mode.output === 'frequency') {\r\n      newvalue = this.frequency(input, octave);\r\n    } else if (this.mode.output === 'ratio') {\r\n      newvalue = this.ratio(input, octave);\r\n    } else if (this.mode.output === 'MIDI') {\r\n      newvalue = this.MIDI(input, octave);\r\n    } else {\r\n      newvalue = this.frequency(input, octave);\r\n    }\r\n\r\n    return newvalue;\r\n  }\r\n\r\n  /* Return freq data */\r\n  frequency(stepIn, octaveIn) {\r\n    if (this.mode.input === 'midi' || this.mode.input === 'MIDI') {\r\n      this.stepIn += 60;\r\n    }\r\n\r\n    // what octave is our input\r\n    let octave = Math.floor(stepIn / this.scale.length);\r\n\r\n    if (octaveIn) {\r\n      octave += octaveIn;\r\n    }\r\n\r\n    // which scale degree (0 - scale length) is our input\r\n    let scaleDegree = stepIn % this.scale.length;\r\n\r\n    while (scaleDegree < 0) {\r\n      scaleDegree += this.scale.length;\r\n    }\r\n\r\n    let ratio = this.scale[scaleDegree];\r\n\r\n    let freq = this.root * ratio;\r\n\r\n    freq = freq * Math.pow(2, octave);\r\n\r\n    // truncate irrational numbers\r\n    freq = Math.floor(freq * 100000000000) / 100000000000;\r\n\r\n    return freq;\r\n  }\r\n\r\n  /* Force return ratio data */\r\n\r\n  ratio(stepIn, octaveIn) {\r\n    if (this.mode.input === 'midi' || this.mode.input === 'MIDI') {\r\n      this.stepIn += 60;\r\n    }\r\n\r\n    // what octave is our input\r\n    let octave = Math.floor(stepIn / this.scale.length);\r\n\r\n    if (octaveIn) {\r\n      octave += octaveIn;\r\n    }\r\n\r\n    // which scale degree (0 - scale length) is our input\r\n    let scaleDegree = stepIn % this.scale.length;\r\n\r\n    // what ratio is our input to our key\r\n    let ratio = Math.pow(2, octave) * this.scale[scaleDegree];\r\n\r\n    ratio = Math.floor(ratio * 100000000000) / 100000000000;\r\n\r\n    return ratio;\r\n  }\r\n\r\n  /* Force return adjusted MIDI data */\r\n\r\n  MIDI(stepIn, octaveIn) {\r\n    let newvalue = this.frequency(stepIn, octaveIn);\r\n\r\n    let n = 69 + (12 * Math.log(newvalue / 440)) / Math.log(2);\r\n\r\n    n = Math.floor(n * 1000000000) / 1000000000;\r\n\r\n    return n;\r\n  }\r\n\r\n  createScale() {\r\n    let newScale = [];\r\n    for (let i = 0; i < arguments.length; i++) {\r\n      newScale.push(math.mtof(60 + arguments[i]));\r\n    }\r\n    this.loadScaleFromFrequencies(newScale);\r\n  }\r\n\r\n  createJIScale() {\r\n    this.scale = [];\r\n    for (let i = 0; i < arguments.length; i++) {\r\n      this.scale.push(arguments[i]);\r\n    }\r\n  }\r\n\r\n  loadScaleFromFrequencies(freqs) {\r\n    this.scale = [];\r\n    for (let i = 0; i < freqs.length; i++) {\r\n      this.scale.push(freqs[i] / freqs[0]);\r\n    }\r\n  }\r\n\r\n  /* Load a new scale */\r\n\r\n  loadScale(name) {\r\n    /* load the scale */\r\n    let freqs = this.scales[name].frequencies;\r\n    this.loadScaleFromFrequencies(freqs);\r\n  }\r\n\r\n  /* Search the names of tunings\r\n  \t Returns an array of names of tunings */\r\n\r\n  search(letters) {\r\n    let possible = [];\r\n    for (let key in this.scales) {\r\n      if (key.toLowerCase().indexOf(letters.toLowerCase()) !== -1) {\r\n        possible.push(key);\r\n      }\r\n    }\r\n    return possible;\r\n  }\r\n\r\n  /* Return a collection of notes as an array */\r\n\r\n  chord(midis) {\r\n    let output = [];\r\n    for (let i = 0; i < midis.length; i++) {\r\n      output.push(this.note(midis[i]));\r\n    }\r\n    return output;\r\n  }\r\n}\r\n","'use strict';\r\n\r\n//Disable jshint warning concerning trailing regular params\r\n/*jshint -W138 */\r\n\r\nexport default class Radio {\r\n    //if non-existent buttons are switched, they are ignored\r\n\r\n    constructor(length = 3, ...onVals) {\r\n        //each optional 'onVals' argument switches on that value in the Radio if it exists\r\n        //In the example below, a 3-button radio is created, index 0 is switched on, index 1 is switched on then then attempted again producing an warning, and the final argument produces a warning because the index value does not exist.\r\n        //Example:\r\n        //`  radio = new Radio(3, 0, 1, 1, 3);\r\n        //…  [1,1,0]\r\n\r\n        if (length < 0) { length = 1; }\r\n\r\n        this.length = length;\r\n        this.onVals = onVals;\r\n        this.array = new Array(length).fill(0);\r\n\r\n        if (onVals.length > 0) {\r\n            this.on(...onVals);\r\n        }\r\n    }\r\n\r\n    select(value) {\r\n        this.array.fill(0);\r\n        this.array[value] = 1;\r\n        return this.array;\r\n    }\r\n\r\n    flip(...values) {\r\n        //flips the specified values. if no value is specified, flips all buttons\r\n        let a = this.array;\r\n        if (values.length > 0) {\r\n            values.forEach(function(v) {\r\n                if (v > a.length - 1) {\r\n                    console.warn('Warning: AnonRadio[' + v + '] does not exist');\r\n                } else {\r\n                    a[v] = (a[v] ? 0 : 1);\r\n                }\r\n            });\r\n        } else {\r\n            a.forEach(function(v, i, arr) {\r\n                arr[i] = (v ? 0 : 1);\r\n            });\r\n        }\r\n        return a;\r\n    }\r\n\r\n    on(...values) {\r\n        //switch on the specified values. if no value specified, flips on all buttons\r\n        let a = this.array;\r\n        if (values.length > 0) {\r\n            values.forEach(function(v) {\r\n                if (v > a.length - 1) {\r\n                    console.warn('Warning: AnonRadio[' + v + '] exceeds size of object');\r\n                } else {\r\n                    if (a[v] === 1) { console.warn('Warning: AnonRadio[' + v + '] was already on.'); }\r\n                    a[v] = 1;\r\n                }\r\n            });\r\n        } else {\r\n            a.fill(1);\r\n        }\r\n        return a;\r\n    }\r\n\r\n    off(...values) {\r\n        //switch off the specified values. if no value specified, flips off all buttons\r\n        let a = this.array;\r\n        if (values.length > 0) {\r\n            values.forEach(function(v) {\r\n                a[v] = 0;\r\n            });\r\n        } else {\r\n            a.fill(0);\r\n        }\r\n        return a;\r\n    }\r\n}\r\n","'use strict';\r\n\r\nimport Interfaces from './interfaces/';\r\nimport math from './util/math';\r\nimport Rack from './core/rack';\r\nimport Tune from './tuning/tuning';\r\nimport * as Transform from './util/transform';\r\n\r\nimport Counter from './models/counter.js';\r\nimport Radio from './models/radio.js';\r\nimport Drunk from './models/drunk.js';\r\nimport Sequence from './models/sequence.js';\r\nimport Matrix from './models/matrix.js';\r\n\r\nimport WAAClock from 'waaclock';\r\nimport Interval from './time/interval';\r\n\r\n\r\n/**\r\nNexusUI => created as Nexus\r\n*/\r\n\r\nclass NexusUI {\r\n\r\n    constructor(context) {\r\n\r\n        for (let key in Interfaces) {\r\n            this[key] = Interfaces[key];\r\n        }\r\n\r\n        for (let key in math) {\r\n            this[key] = math[key];\r\n        }\r\n\r\n        let Core = {\r\n          'Rack': Rack\r\n        };\r\n\r\n        let Models = {\r\n          'Counter': Counter,\r\n          'Radio': Radio,\r\n          'Drunk': Drunk,\r\n          'Sequence': Sequence,\r\n          'Matrix': Matrix\r\n        };\r\n\r\n        for (let key in Models) {\r\n          this[key] = Models[key];\r\n        }\r\n\r\n        for (let key in Core) {\r\n          this[key] = Core[key];\r\n        }\r\n\r\n        let DefaultContext = window.AudioContext || window.webkitAudioContext;\r\n        this._context = context || new DefaultContext();\r\n\r\n        this.tune = new Tune();\r\n        this.note = this.tune.note.bind(this.tune);\r\n\r\n        this.clock = new WAAClock(this._context);\r\n        this.clock.start();\r\n        this.Interval = Interval;\r\n\r\n        this.colors = {\r\n          accent: '#2bb',\r\n          fill: '#eee',\r\n          light: '#fff',\r\n          dark: '#333',\r\n          mediumLight: '#ccc',\r\n          mediumDark: '#666'\r\n        };\r\n\r\n        this.transform = Transform;\r\n        this.add = Transform.add;\r\n\r\n\r\n        this.Add = {};\r\n        for (let key in Interfaces) {\r\n          this.Add[key] = Transform.add.bind(this,key);\r\n        }\r\n\r\n        /* create default component size as 1st style element in document */\r\n        var defaultStyleNode = document.createElement('style');\r\n        defaultStyleNode.type = 'text/css';\r\n        defaultStyleNode.innerHTML = '[nexus-ui]{height:5000px;width:5000px}';\r\n        var h = document.head;\r\n        h.insertBefore(defaultStyleNode, h.firstElementChild);\r\n    }\r\n\r\n    get context() {\r\n      return this._context;\r\n    }\r\n\r\n    set context(ctx) {\r\n      this.clock.stop();\r\n      this._context = ctx;\r\n      this.clock = new WAAClock(this.context);\r\n      this.clock.start();\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\nlet Nexus = new NexusUI();\r\n\r\nexport function colors() {\r\n    return Nexus.colors;\r\n}\r\nexport function context() {\r\n    return Nexus.context;\r\n}\r\nexport function clock() {\r\n    return Nexus.clock;\r\n}\r\n\r\nexport default Nexus;\r\n"],"names":["clip","value","min","max","normalize","scale","inNum","inMin","inMax","outMin","outMax","toPolar","x","y","r","theta","toCartesian","radius","angle","cos","sin","prune","data","invert","mtof","midi","interp","loc","pick","octave","num","ri","bound1","bound2","low","high","rf","math","input","total","i","x1","y1","x2","y2","a","b","gain","odds","svg","type","startAngle","endAngle","start","end","largeArcFlag","d","defs","numberOfStops","id","stops","gradient","stop","dom","el","viewportOffset","top","left","parent","e","offset","fps","w","h","newFramerate","currentTime","util","obj","textbox","inputFilter","event","touch","MiniEmitter","listener","set","args","fn","Interface","options","defaults","defaultColors","colors","settings","key","setting","evt","width","height","color","Step","step","Toggle$1","state","Handle","mode","direction","xbound","ybound","mouse","rawIncrement","interpretedIncrement","current","position","Position","Interaction.Handle","v","Slider","barOffset","cornerRadius","Toggle","ToggleModel","ButtonTemplate","paintbrush","emitting","Button","TextButton","textsize","textsize2","textsize3","styles","text","RadioButton","container","button","orientation","buttonWidth","buttonHeight","index","buttons","Number","newvalue","destination","Select","Dial","center","diameter","handlePoints","handle2Points","handlePath","handle2Path","arcEndingA","arcEndingX","arcEndingY","realValue","PianoKey","Piano","scaleIndex","keyX","keyPositions","nextScaleIndex","keysWide","padding","note","on","allActiveTouches","keys","cloneTouch","updateKeyState","allActiveKeys","handleTouchStartAndMove","handleTouchEnd","Drunk","increment","loop","Sequence","sequence","Matrix","rows","columns","column","row","c","values","amount","cut","proxy","oddsSequence","cell","arr","f","f2","patternString","pattern","previous","Counter","Interval","rate","func","clock","newrate","ratio","MatrixCell","Sequencer","MatrixModel","CounterModel","location","cellWidth","cellHeight","ms","element","Pan2D","speakerElement","speaker","s","distance","level","Tilt","z","Multislider","vs","node","bar","cap","scaleAdjusted","lowValue","highValue","downCenter","upCenter","downLowerNeighbor","downUpperNeighbor","upLowerNeighbor","upUpperNeighbor","previousLength","newLength","Pan","Point","point","envelope","prevIndex","nextIndex","prevNode","nextNode","lowX","highX","Envelope","nearestIndex","nearestDist","nodes","clippedX","clippedY","priorIndex","priorPoint","nextPoint","xOffset","yOffset","allPoints","Spectrogram","nowTime","canvasContext","bufferLength","dataArray","accentColor","barWidth","barHeight","definition","Meter","dataArrayLength","rms","linear","exp","channels","analyser","Oscilloscope","thisDataArray","halfHeight","sliceWidth","Interfaces","createInterfaceID","widget","interfaceIDs","att","section","keyword","ui","htmlElements","elements","formattedType","add","target","Rack","transform.section","Tune","stepIn","octaveIn","scaleDegree","freq","n","newScale","freqs","name","letters","possible","midis","output","Radio","length","onVals","NexusUI","context","Core","Models","DefaultContext","WAAClock","Transform","Transform.add","defaultStyleNode","ctx","Nexus"],"mappings":"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"}